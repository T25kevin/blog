<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="https://kanoc.gitee.io/atom.xml" rel="self"/>
  
  <link href="https://kanoc.gitee.io/"/>
  <updated>2025-06-11T06:51:50.173Z</updated>
  <id>https://kanoc.gitee.io/</id>
  
  <author>
    <name>Kanoc Ge</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Go_å‘èµ·ç½‘ç»œè¯·æ±‚æ¨¡ç‰ˆ(åŸºäºå®˜æ–¹netåº“)</title>
    <link href="https://kanoc.gitee.io/2025/06/11/Go-%E5%8F%91%E8%B5%B7%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E6%A8%A1%E7%89%88(%E5%9F%BA%E4%BA%8E%E5%AE%98%E6%96%B9net%E5%BA%93)/"/>
    <id>https://kanoc.gitee.io/2025/06/11/Go-%E5%8F%91%E8%B5%B7%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E6%A8%A1%E7%89%88(%E5%9F%BA%E4%BA%8E%E5%AE%98%E6%96%B9net%E5%BA%93)/</id>
    <published>2025-06-11T06:28:01.000Z</published>
    <updated>2025-06-11T06:51:50.173Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Go_å‘èµ·ç½‘ç»œè¯·æ±‚æ¨¡ç‰ˆ(åŸºäºå®˜æ–¹netåº“)</strong></font></p><span id="more"></span><h2 id="Go-HTTPè¯·æ±‚æ¨¡æ¿å°è£…"><a href="#Go-HTTPè¯·æ±‚æ¨¡æ¿å°è£…" class="headerlink" title="Go HTTPè¯·æ±‚æ¨¡æ¿å°è£…"></a>Go HTTPè¯·æ±‚æ¨¡æ¿å°è£…</h2><h3 id="1ã€å¯¼å…¥åŒ…"><a href="#1ã€å¯¼å…¥åŒ…" class="headerlink" title="1ã€å¯¼å…¥åŒ…"></a>1ã€å¯¼å…¥åŒ…</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;bytes&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;io&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;mime/multipart&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;net/url&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="1-1ã€GetRequest-å‘é€GETè¯·æ±‚"><a href="#1-1ã€GetRequest-å‘é€GETè¯·æ±‚" class="headerlink" title="1.1ã€GetRequest å‘é€GETè¯·æ±‚"></a>1.1ã€<em>GetRequest å‘é€GETè¯·æ±‚</em></h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// GetRequest å‘é€GETè¯·æ±‚</span></span><br><span class="line"><span class="comment">// url: è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="comment">// params: æŸ¥è¯¢å‚æ•°(mapæ ¼å¼)</span></span><br><span class="line"><span class="comment">// è¿”å›: å“åº”ä½“å­—èŠ‚æ•°ç»„å’Œé”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetRequest</span><span class="params">(url <span class="type">string</span>, params <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">// 1. æ„å»ºå¸¦å‚æ•°çš„URL</span></span><br><span class="line">query := url.Values&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> params &#123;</span><br><span class="line">query.Add(k, v)</span><br><span class="line">&#125;</span><br><span class="line">fullURL := url</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(params) &gt; <span class="number">0</span> &#123;</span><br><span class="line">fullURL += <span class="string">&quot;?&quot;</span> + query.Encode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å‘é€GETè¯·æ±‚</span></span><br><span class="line">resp, err := http.Get(fullURL)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. è¯»å–å“åº”ä½“</span></span><br><span class="line"><span class="keyword">return</span> io.ReadAll(resp.Body)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><p><code>url</code>: è¯·æ±‚çš„ç›®æ ‡åœ°å€ï¼ˆä¸åŒ…å«æŸ¥è¯¢å‚æ•°ï¼‰ï¼Œä¾‹å¦‚ <code>&quot;https://api.example.com/data&quot;</code></p></li><li><p><code>params: </code>æŸ¥è¯¢å‚æ•°çš„é”®å€¼å¯¹æ˜ å°„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line">    <span class="string">&quot;page&quot;</span>:  <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;limit&quot;</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆ<code>?page=1&amp;limit=20</code>çš„æŸ¥è¯¢å­—ç¬¦ä¸²</p></li></ul><h3 id="1-2ã€PostJsonRequest-å‘é€JSONæ ¼å¼çš„POSTè¯·æ±‚"><a href="#1-2ã€PostJsonRequest-å‘é€JSONæ ¼å¼çš„POSTè¯·æ±‚" class="headerlink" title="1.2ã€PostJsonRequest å‘é€JSONæ ¼å¼çš„POSTè¯·æ±‚"></a>1.2ã€<em>PostJsonRequest å‘é€JSONæ ¼å¼çš„POSTè¯·æ±‚</em></h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// PostJsonRequest å‘é€JSONæ ¼å¼çš„POSTè¯·æ±‚</span></span><br><span class="line"><span class="comment">// url: è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="comment">// data: è¦å‘é€çš„JSONæ•°æ®(ä»»æ„ç»“æ„ä½“)</span></span><br><span class="line"><span class="comment">// è¿”å›: å“åº”ä½“å­—èŠ‚æ•°ç»„å’Œé”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PostJsonRequest</span><span class="params">(url <span class="type">string</span>, data <span class="keyword">interface</span>&#123;&#125;)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">// 1. åºåˆ—åŒ–JSONæ•°æ®</span></span><br><span class="line">jsonData, err := json.Marshal(data)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åˆ›å»ºè¯·æ±‚</span></span><br><span class="line">req, err := http.NewRequest(<span class="string">&quot;POST&quot;</span>, url, bytes.NewBuffer(jsonData))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">req.Header.Set(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å‘é€è¯·æ±‚å¹¶è·å–å“åº”</span></span><br><span class="line">client := &amp;http.Client&#123;&#125;</span><br><span class="line">resp, err := client.Do(req)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. è¯»å–å“åº”ä½“</span></span><br><span class="line"><span class="keyword">return</span> io.ReadAll(resp.Body)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°è¯´æ˜ï¼š"><a href="#å‚æ•°è¯´æ˜ï¼š" class="headerlink" title="å‚æ•°è¯´æ˜ï¼š"></a><strong>å‚æ•°è¯´æ˜ï¼š</strong></h4><ul><li><p><code>url</code>: è¯·æ±‚çš„ç›®æ ‡åœ°å€ï¼Œä¾‹å¦‚ <code>&quot;https://api.example.com/users&quot;</code></p></li><li><p><code>data</code>ï¼šä»»æ„å¯è¢«JSONåºåˆ—åŒ–çš„Goæ•°æ®ç»“æ„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> &#123;</span><br><span class="line">    Name  <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">    Email <span class="type">string</span> <span class="string">`json:&quot;email&quot;`</span></span><br><span class="line">&#125;&#123;</span><br><span class="line">    Name:  <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    Email: <span class="string">&quot;alice@example.com&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–ä½¿ç”¨map</span></span><br><span class="line"><span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:  <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    <span class="string">&quot;email&quot;</span>: <span class="string">&quot;alice@example.com&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="1-3ã€PostFormUrlEncodedRequest-å‘é€x-www-form-urlencodedæ ¼å¼çš„POSTè¯·æ±‚"><a href="#1-3ã€PostFormUrlEncodedRequest-å‘é€x-www-form-urlencodedæ ¼å¼çš„POSTè¯·æ±‚" class="headerlink" title="1.3ã€PostFormUrlEncodedRequest å‘é€x-www-form-urlencodedæ ¼å¼çš„POSTè¯·æ±‚"></a>1.3ã€<em>PostFormUrlEncodedRequest å‘é€x-www-form-urlencodedæ ¼å¼çš„POSTè¯·æ±‚</em></h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// PostFormUrlEncodedRequest å‘é€x-www-form-urlencodedæ ¼å¼çš„POSTè¯·æ±‚</span></span><br><span class="line"><span class="comment">// url: è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="comment">// formData: è¡¨å•æ•°æ®(mapæ ¼å¼)</span></span><br><span class="line"><span class="comment">// è¿”å›: å“åº”ä½“å­—èŠ‚æ•°ç»„å’Œé”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PostFormUrlEncodedRequest</span><span class="params">(url <span class="type">string</span>, formData <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">// 1. æ„å»ºè¡¨å•æ•°æ®</span></span><br><span class="line">data := url.Values&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> formData &#123;</span><br><span class="line">data.Set(k, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å‘é€è¯·æ±‚</span></span><br><span class="line">resp, err := http.Post(</span><br><span class="line">url,</span><br><span class="line"><span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">strings.NewReader(data.Encode()),</span><br><span class="line">)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. è¯»å–å“åº”ä½“</span></span><br><span class="line"><span class="keyword">return</span> io.ReadAll(resp.Body)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><p><code>url</code>: è¯·æ±‚çš„ç›®æ ‡åœ°å€ï¼Œä¾‹å¦‚ <code>&quot;https://api.example.com/login&quot;</code></p></li><li><p><code>formData</code>: è¡¨å•æ•°æ®çš„é”®å€¼å¯¹æ˜ å°„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;myp@ssw0rd&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="1-4ã€PostFormDataRequest-å‘é€multipart-form-dataæ ¼å¼çš„POSTè¯·æ±‚-æ”¯æŒæ–‡ä»¶å’Œæ–‡æœ¬æ··åˆ"><a href="#1-4ã€PostFormDataRequest-å‘é€multipart-form-dataæ ¼å¼çš„POSTè¯·æ±‚-æ”¯æŒæ–‡ä»¶å’Œæ–‡æœ¬æ··åˆ" class="headerlink" title="1.4ã€PostFormDataRequest å‘é€multipart&#x2F;form-dataæ ¼å¼çš„POSTè¯·æ±‚(æ”¯æŒæ–‡ä»¶å’Œæ–‡æœ¬æ··åˆ)"></a>1.4ã€<em>PostFormDataRequest å‘é€multipart&#x2F;form-dataæ ¼å¼çš„POSTè¯·æ±‚(æ”¯æŒæ–‡ä»¶å’Œæ–‡æœ¬æ··åˆ)</em></h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// PostFormDataRequest å‘é€multipart/form-dataæ ¼å¼çš„POSTè¯·æ±‚(æ”¯æŒæ–‡ä»¶å’Œæ–‡æœ¬æ··åˆ)</span></span><br><span class="line"><span class="comment">// url: è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="comment">// formData: æ–‡æœ¬è¡¨å•æ•°æ®(mapæ ¼å¼)</span></span><br><span class="line"><span class="comment">// fileField: æ–‡ä»¶å­—æ®µå</span></span><br><span class="line"><span class="comment">// filePath: æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment">// è¿”å›: å“åº”ä½“å­—èŠ‚æ•°ç»„å’Œé”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PostFormDataRequest</span><span class="params">(url <span class="type">string</span>, formData <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>, fileField, filePath <span class="type">string</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">// 1. åˆ›å»ºmultipartå†™å…¥å™¨</span></span><br><span class="line">body := &amp;bytes.Buffer&#123;&#125;</span><br><span class="line">writer := multipart.NewWriter(body)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ·»åŠ æ–‡æœ¬å­—æ®µ</span></span><br><span class="line"><span class="keyword">for</span> key, val := <span class="keyword">range</span> formData &#123;</span><br><span class="line">_ = writer.WriteField(key, val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ·»åŠ æ–‡ä»¶å­—æ®µ(å¦‚æœæä¾›äº†æ–‡ä»¶è·¯å¾„)</span></span><br><span class="line"><span class="keyword">if</span> filePath != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">file, err := os.Open(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">part, err := writer.CreateFormFile(fileField, file.Name())</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">_, err = io.Copy(part, file)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. å…³é—­å†™å…¥å™¨(å¿…é¡»)</span></span><br><span class="line">err := writer.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. åˆ›å»ºè¯·æ±‚</span></span><br><span class="line">req, err := http.NewRequest(<span class="string">&quot;POST&quot;</span>, url, body)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line">req.Header.Set(<span class="string">&quot;Content-Type&quot;</span>, writer.FormDataContentType())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. å‘é€è¯·æ±‚</span></span><br><span class="line">client := &amp;http.Client&#123;&#125;</span><br><span class="line">resp, err := client.Do(req)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. è¯»å–å“åº”</span></span><br><span class="line"><span class="keyword">return</span> io.ReadAll(resp.Body)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><p><code>url</code>: è¯·æ±‚çš„ç›®æ ‡åœ°å€ï¼Œä¾‹å¦‚ <code>&quot;https://api.example.com/upload&quot;</code></p></li><li><p><code>formData</code>: æ–‡æœ¬å­—æ®µçš„é”®å€¼å¯¹æ˜ å°„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;ç”¨æˆ·å¤´åƒ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;category&quot;</span>:    <span class="string">&quot;profile&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>fileField</code>: æœåŠ¡å™¨ç”¨äºæ¥æ”¶æ–‡ä»¶çš„å­—æ®µåç§°ï¼ˆè¡¨å•åŸŸåç§°ï¼‰ï¼Œä¾‹å¦‚ <code>&quot;avatar&quot;</code></p></li><li><p><code>filePath</code>: è¦ä¸Šä¼ çš„æ–‡ä»¶åœ¨æœ¬åœ°ç³»ç»Ÿçš„å®Œæ•´è·¯å¾„ï¼Œä¾‹å¦‚ <code>&quot;/tmp/photo.jpg&quot;</code></p></li></ul><blockquote><p><strong>ç‰¹æ®Šè¯´æ˜</strong>ï¼š<code>filePath</code> å‚æ•°ä¸ºç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code> æ—¶ï¼Œè¡¨ç¤ºä¸ä¸Šä¼ æ–‡ä»¶ï¼Œåªå‘é€æ–‡æœ¬è¡¨å•æ•°æ®</p></blockquote><h3 id="2ã€è¯·æ±‚ç¤ºä¾‹ï¼š"><a href="#2ã€è¯·æ±‚ç¤ºä¾‹ï¼š" class="headerlink" title="2ã€è¯·æ±‚ç¤ºä¾‹ï¼š"></a>2ã€è¯·æ±‚ç¤ºä¾‹ï¼š</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ============================</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="comment">// ============================</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// ç¤ºä¾‹1: GETè¯·æ±‚</span></span><br><span class="line">getResp, err := GetRequest(<span class="string">&quot;https://httpbin.org/get&quot;</span>, <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line"><span class="string">&quot;param1&quot;</span>: <span class="string">&quot;value1&quot;</span>,</span><br><span class="line"><span class="string">&quot;param2&quot;</span>: <span class="string">&quot;value2&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(<span class="string">&quot;GETè¯·æ±‚å¤±è´¥:&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;GETå“åº”:\n&quot;</span>, <span class="type">string</span>(getResp))</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹2: POST JSONè¯·æ±‚</span></span><br><span class="line">jsonResp, err := PostJsonRequest(<span class="string">&quot;https://httpbin.org/post&quot;</span>, <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line"><span class="string">&quot;name&quot;</span>:  <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line"><span class="string">&quot;email&quot;</span>: <span class="string">&quot;alice@example.com&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(<span class="string">&quot;JSON POSTå¤±è´¥:&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;JSON POSTå“åº”:\n&quot;</span>, <span class="type">string</span>(jsonResp))</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹3: Form-urlencodedè¯·æ±‚</span></span><br><span class="line">formResp, err := PostFormUrlEncodedRequest(<span class="string">&quot;https://httpbin.org/post&quot;</span>, <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line"><span class="string">&quot;username&quot;</span>: <span class="string">&quot;bob&quot;</span>,</span><br><span class="line"><span class="string">&quot;password&quot;</span>: <span class="string">&quot;secret&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(<span class="string">&quot;Form-urlencoded POSTå¤±è´¥:&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;Form-urlencodedå“åº”:\n&quot;</span>, <span class="type">string</span>(formResp))</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹4: Form-dataè¯·æ±‚(å«æ–‡ä»¶)</span></span><br><span class="line"><span class="comment">// formDataResp, err := PostFormDataRequest(</span></span><br><span class="line"><span class="comment">// &quot;https://httpbin.org/post&quot;,</span></span><br><span class="line"><span class="comment">// map[string]string&#123;&quot;textField&quot;: &quot;textValue&quot;&#125;,</span></span><br><span class="line"><span class="comment">// &quot;fileField&quot;,</span></span><br><span class="line"><span class="comment">// &quot;./test.txt&quot;, // å®é™…æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"><span class="comment">// if err != nil &#123;</span></span><br><span class="line"><span class="comment">// log.Fatal(&quot;Form-data POSTå¤±è´¥:&quot;, err)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fmt.Println(&quot;Form-dataå“åº”:\n&quot;, string(formDataResp))</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é€šç”¨è¿”å›è¯´æ˜"><a href="#é€šç”¨è¿”å›è¯´æ˜" class="headerlink" title="é€šç”¨è¿”å›è¯´æ˜"></a>é€šç”¨è¿”å›è¯´æ˜</h4><p>æ‰€æœ‰å‡½æ•°å‡è¿”å›ä¸¤ä¸ªå€¼ï¼š</p><ol><li><strong><code>[]byte</code></strong>: åŸå§‹å“åº”ä½“å†…å®¹ï¼Œéœ€è¦è°ƒç”¨æ–¹è‡ªè¡Œè§£æï¼ˆå¦‚ä½¿ç”¨ <code>json.Unmarshal()</code>ï¼‰</li><li><strong><code>error</code></strong>: é”™è¯¯å¯¹è±¡ï¼Œè¯·æ±‚æˆåŠŸæ—¶è¿”å› <code>nil</code>ï¼Œå¤±è´¥æ—¶åŒ…å«é”™è¯¯è¯¦æƒ…</li></ol><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…¸å‹ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line">respBytes, err := GetRequest(<span class="string">&quot;https://api.example.com/data&quot;</span>, params)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">// å¤„ç†é”™è¯¯</span></span><br><span class="line">    log.Fatal(<span class="string">&quot;è¯·æ±‚å¤±è´¥:&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æJSONå“åº”</span></span><br><span class="line"><span class="keyword">var</span> result ResponseStruct</span><br><span class="line"><span class="keyword">if</span> err := json.Unmarshal(respBytes, &amp;result); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">// å¤„ç†è§£æé”™è¯¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Go_å‘èµ·ç½‘ç»œè¯·æ±‚æ¨¡ç‰ˆ(åŸºäºå®˜æ–¹netåº“)&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/Golang/"/>
    
    <category term="ç½‘ç»œè¯·æ±‚" scheme="https://kanoc.gitee.io/categories/Golang/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/"/>
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/tags/Golang/"/>
    
    <category term="å®˜æ–¹http" scheme="https://kanoc.gitee.io/tags/%E5%AE%98%E6%96%B9http/"/>
    
    <category term="ç½‘ç»œè¯·æ±‚" scheme="https://kanoc.gitee.io/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/"/>
    
  </entry>
  
  <entry>
    <title>Go_ä¸­ä¼ é€’å‚æ•°ç±»å‹çš„åˆ¤å®šä¸å…¶ä»–ç”¨æ³•</title>
    <link href="https://kanoc.gitee.io/2025/06/11/Go-%E4%B8%AD%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%88%A4%E5%AE%9A%E4%B8%8E%E5%85%B6%E4%BB%96%E7%94%A8%E6%B3%95/"/>
    <id>https://kanoc.gitee.io/2025/06/11/Go-%E4%B8%AD%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%88%A4%E5%AE%9A%E4%B8%8E%E5%85%B6%E4%BB%96%E7%94%A8%E6%B3%95/</id>
    <published>2025-06-10T18:30:42.000Z</published>
    <updated>2025-06-10T18:46:37.056Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Go_ä¸­<code>ä¼ é€’å‚æ•°</code>ç±»å‹çš„åˆ¤å®šä¸å…¶ä»–ç”¨æ³•</strong></font></p><span id="more"></span><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SearchDB</span><span class="params">(DbModel *gorm.DB, Parms <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;, SqlKey <span class="type">string</span>, tableOrModel <span class="keyword">interface</span>&#123;&#125;)</span></span> <span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">  <span class="comment">// ç‰¹åˆ«æ³¨æ„ tableOrModel interface&#123;&#125;  è¡¨ç¤ºå¯ä»¥ä¼ é€’ä»»æ„å€¼</span></span><br><span class="line">    fmt.Println(tableOrModel)</span><br><span class="line">    <span class="comment">// éªŒè¯è¡¨å</span></span><br><span class="line">    TableName := <span class="string">&quot;&quot;</span>    <span class="comment">// åˆå§‹åŒ–å˜é‡ ä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">switch</span> v := tableOrModel.(<span class="keyword">type</span>) &#123;    <span class="comment">//è¿™é‡Œ  ç±»å‹å¼€å…³(type switch)</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">string</span>:  <span class="comment">//å¦‚æœ vçš„ç±»å‹æ˜¯ string  é‚£ä¹ˆ TableName=v</span></span><br><span class="line">       TableName = v</span><br><span class="line">    <span class="keyword">case</span> *<span class="type">string</span>:                               <span class="comment">// å¦‚æœ v çš„ç±»å‹æ˜¯æŒ‡é’ˆ</span></span><br><span class="line">       <span class="keyword">if</span> v == <span class="literal">nil</span> &#123;                            <span class="comment">// åˆ¤å®š v æ˜¯å¦ä¸ºç©ºå€¼</span></span><br><span class="line">          <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;è¡¨åæŒ‡é’ˆä¸èƒ½ä¸ºç©º&quot;</span>)    <span class="comment">// å¦‚æœ v çš„å€¼æ˜¯ç©ºçš„ï¼Œè¿”å›é”™è¯¯æç¤º è¡¨åä¸å¾—ä¸ºç©º</span></span><br><span class="line">       &#125;</span><br><span class="line">       TableName = *v                           <span class="comment">// å¦åˆ™ TableName = væŒ‡é’ˆæŒ‡å‘çš„å€¼</span></span><br><span class="line">    <span class="keyword">default</span>:             <span class="comment">// å¦‚æœä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Œé»˜è®¤èµ°çš„åˆ†æ”¯</span></span><br><span class="line">       <span class="comment">// å°è¯•ä»æ¨¡å‹è·å–è¡¨å</span></span><br><span class="line">       <span class="comment">// è¿™é‡Œæ‹†å¼€çœ‹ ä¼šæ¸…æ™°ä¸€ç‚¹</span></span><br><span class="line">       <span class="comment">// model, ok := v.(interface&#123; TableName() string &#125;)</span></span><br><span class="line">       <span class="comment">// è¿™é‡Œå®šä¹‰è¿”å›å€¼ï¼šv.(interface&#123; TableName() string &#125;) å…¶å®å°±æ˜¯ å¯¹ interface&#123; TableName() string &#125; è¿›è¡Œç±»å‹çš„åˆ¤æ–­</span></span><br><span class="line">       <span class="comment">// .()ï¼šç±»å‹æ–­è¨€æ“ä½œç¬¦</span></span><br><span class="line">       <span class="comment">// interface&#123; TableName() string &#125;ï¼šä¸€ä¸ªæ¥å£ç±»å‹ï¼Œè¦æ±‚å®ç° TableName() string æ–¹æ³•</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment">// if ok &#123;TableName = model.TableName()&#125;</span></span><br><span class="line">      </span><br><span class="line">       <span class="keyword">if</span> model, ok := v.(<span class="keyword">interface</span>&#123; TableName() <span class="type">string</span> &#125;); ok &#123; <span class="comment">//interface&#123; TableName() string &#125;ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ func TableName() string æ–¹æ³•</span></span><br><span class="line">          TableName = model.TableName()</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// ä½¿ç”¨åå°„è·å–ç±»å‹åç§° è¯¦è§£è§ä¸‹æ–¹æ€»ç»“</span></span><br><span class="line">          t := reflect.TypeOf(v) <span class="comment">// è·å–å¯¹è±¡çš„ç±»å‹</span></span><br><span class="line">          <span class="keyword">if</span> t.Kind() == reflect.Ptr &#123;</span><br><span class="line">             t = t.Elem()</span><br><span class="line">          &#125;</span><br><span class="line">          TableName = t.Name()</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> TableName == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;è¡¨åä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®æ“ä½œç±»å‹æ‰§è¡Œç›¸åº”æ“ä½œ</span></span><br><span class="line">    <span class="keyword">switch</span> strings.ToLower(SqlKey) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;insert&quot;</span>:</span><br><span class="line">       <span class="keyword">return</span> handleInsert(DbModel, Parms, TableName)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;find&quot;</span>:</span><br><span class="line">       <span class="keyword">return</span> handleFind(DbModel, Parms, TableName)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;update&quot;</span>:</span><br><span class="line">       <span class="keyword">return</span> handleUpdate(DbModel, Parms, TableName)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">       <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;æ— æ•ˆçš„æ“ä½œç±»å‹: %s (æ”¯æŒ: insert, find, update)&quot;</span>, SqlKey)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li><strong>è·å–ç±»å‹å¯¹è±¡</strong>ï¼š<code>reflect.TypeOf(v)</code> â†’ è·å–ç±»å‹ä¿¡æ¯</li><li><strong>æ£€æŸ¥æŒ‡é’ˆç±»å‹</strong>ï¼š<code>t.Kind() == reflect.Ptr</code> â†’ æ˜¯å¦ä¸ºæŒ‡é’ˆ</li><li><strong>è§£å¼•ç”¨æŒ‡é’ˆ</strong>ï¼š<code>t = t.Elem()</code> â†’ è·å–æŒ‡é’ˆæŒ‡å‘çš„å®é™…ç±»å‹</li><li><strong>è·å–ç±»å‹åç§°</strong>ï¼š<code>t.Name()</code> â†’ ç±»å‹çš„å­—ç¬¦ä¸²åç§°</li></ol><h3 id="å…³é”®ç‚¹ï¼š"><a href="#å…³é”®ç‚¹ï¼š" class="headerlink" title="å…³é”®ç‚¹ï¼š"></a>å…³é”®ç‚¹ï¼š</h3><ul><li><code>Elem()</code> ç”¨äºè§£å¼•ç”¨æŒ‡é’ˆï¼Œè·å–å…¶æŒ‡å‘çš„ç±»å‹</li><li><code>Name()</code> è¿”å›ç±»å‹çš„åç§°ï¼Œå¯¹äºå‘½åç±»å‹æœ‰æ•ˆ</li><li>å¯¹äºæŒ‡é’ˆç±»å‹ï¼Œéœ€è¦è§£å¼•ç”¨åæ‰èƒ½è·å–å®é™…ç±»å‹çš„åç§°</li><li>åŒ¿åç±»å‹å’ŒåŸºæœ¬ç±»å‹å¤„ç†éœ€è¦ç‰¹åˆ«æ³¨æ„</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Go_ä¸­&lt;code&gt;ä¼ é€’å‚æ•°&lt;/code&gt;ç±»å‹çš„åˆ¤å®šä¸å…¶ä»–ç”¨æ³•&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="main" scheme="https://kanoc.gitee.io/categories/main/"/>
    
    <category term="s" scheme="https://kanoc.gitee.io/categories/main/s/"/>
    
    
    <category term="docker" scheme="https://kanoc.gitee.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>Go_interfaceæ¥å£å¯å®¹çº³çš„å€¼</title>
    <link href="https://kanoc.gitee.io/2025/06/11/Go-interface%E6%8E%A5%E5%8F%A3%E5%8F%AF%E5%AE%B9%E7%BA%B3%E7%9A%84%E5%80%BC/"/>
    <id>https://kanoc.gitee.io/2025/06/11/Go-interface%E6%8E%A5%E5%8F%A3%E5%8F%AF%E5%AE%B9%E7%BA%B3%E7%9A%84%E5%80%BC/</id>
    <published>2025-06-10T17:07:33.000Z</published>
    <updated>2025-06-10T17:11:47.499Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong><code>Go</code> <code>[å¯å®¹çº³çš„å€¼]interface&#123;&#125;</code>æ¥å£å¯å®¹çº³çš„å€¼</strong></font></p><span id="more"></span><h1 id="map-string-interface-çš„å€¼ç±»å‹è¯¦è§£"><a href="#map-string-interface-çš„å€¼ç±»å‹è¯¦è§£" class="headerlink" title="map[string]interface{} çš„å€¼ç±»å‹è¯¦è§£"></a><code>map[string]interface&#123;&#125;</code> çš„å€¼ç±»å‹è¯¦è§£</h1><p>åœ¨ Go è¯­è¨€ä¸­ï¼Œ<code>map[string]interface&#123;&#125;</code> çš„å€¼ç±»å‹å¯ä»¥æ˜¯<strong>ä»»ä½•ç±»å‹</strong>ï¼Œå› ä¸º <code>interface&#123;&#125;</code> æ˜¯ç©ºæ¥å£ï¼Œå¯ä»¥å®¹çº³ä»»ä½•å€¼ã€‚ä¸‹é¢æ˜¯æ‰€æœ‰å¯èƒ½çš„ç±»å‹åˆ†ç±»ï¼š</p><h2 id="ğŸ“Š-æ‰€æœ‰å¯ç”¨ç±»å‹ä¸€è§ˆ"><a href="#ğŸ“Š-æ‰€æœ‰å¯ç”¨ç±»å‹ä¸€è§ˆ" class="headerlink" title="ğŸ“Š æ‰€æœ‰å¯ç”¨ç±»å‹ä¸€è§ˆ"></a>ğŸ“Š æ‰€æœ‰å¯ç”¨ç±»å‹ä¸€è§ˆ</h2><h3 id="1-åŸºç¡€ç±»å‹"><a href="#1-åŸºç¡€ç±»å‹" class="headerlink" title="1. åŸºç¡€ç±»å‹"></a>1. åŸºç¡€ç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>bool</code></td><td><code>true</code></td><td>å¸ƒå°”å€¼</td></tr><tr><td><code>string</code></td><td><code>&quot;hello&quot;</code></td><td>å­—ç¬¦ä¸²</td></tr><tr><td><code>int</code></td><td><code>42</code></td><td>æ•´æ•°</td></tr><tr><td><code>int8</code></td><td><code>int8(100)</code></td><td>8ä½æ•´æ•°</td></tr><tr><td><code>int16</code></td><td><code>int16(10000)</code></td><td>16ä½æ•´æ•°</td></tr><tr><td><code>int32</code></td><td><code>int32(1000000)</code></td><td>32ä½æ•´æ•°</td></tr><tr><td><code>int64</code></td><td><code>int64(10000000000)</code></td><td>64ä½æ•´æ•°</td></tr><tr><td><code>uint</code></td><td><code>uint(42)</code></td><td>æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>uint8</code></td><td><code>uint8(200)</code></td><td>8ä½æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>uint16</code></td><td><code>uint16(50000)</code></td><td>16ä½æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>uint32</code></td><td><code>uint32(4000000000)</code></td><td>32ä½æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>uint64</code></td><td><code>uint64(10000000000000000000)</code></td><td>64ä½æ— ç¬¦å·æ•´æ•°</td></tr><tr><td><code>byte</code></td><td><code>byte(&#39;A&#39;)</code></td><td><code>uint8</code> çš„åˆ«å</td></tr><tr><td><code>rune</code></td><td><code>rune(&#39;ä¸­&#39;)</code></td><td><code>int32</code> çš„åˆ«å</td></tr><tr><td><code>float32</code></td><td><code>float32(3.14)</code></td><td>32ä½æµ®ç‚¹æ•°</td></tr><tr><td><code>float64</code></td><td><code>3.1415926535</code></td><td>64ä½æµ®ç‚¹æ•°</td></tr><tr><td><code>complex64</code></td><td><code>complex64(1+2i)</code></td><td>64ä½å¤æ•°</td></tr><tr><td><code>complex128</code></td><td><code>2+3i</code></td><td>128ä½å¤æ•°</td></tr></tbody></table><h3 id="2-å¤åˆç±»å‹"><a href="#2-å¤åˆç±»å‹" class="headerlink" title="2. å¤åˆç±»å‹"></a>2. å¤åˆç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>map[string]interface&#123;&#125;</code></td><td><code>map[string]interface&#123;&#125;&#123;&quot;key&quot;: &quot;value&quot;&#125;</code></td><td>åµŒå¥—æ˜ å°„</td></tr><tr><td><code>[]interface&#123;&#125;</code></td><td><code>[]interface&#123;&#125;&#123;1, &quot;two&quot;, true&#125;</code></td><td>æ··åˆç±»å‹åˆ‡ç‰‡</td></tr><tr><td><code>[]string</code></td><td><code>[]string&#123;&quot;a&quot;, &quot;b&quot;, &quot;c&quot;&#125;</code></td><td>å­—ç¬¦ä¸²åˆ‡ç‰‡</td></tr><tr><td><code>[]int</code></td><td><code>[]int&#123;1, 2, 3&#125;</code></td><td>æ•´æ•°åˆ‡ç‰‡</td></tr><tr><td><code>[3]int</code></td><td><code>[3]int&#123;1, 2, 3&#125;</code></td><td>å›ºå®šé•¿åº¦æ•°ç»„</td></tr><tr><td><code>chan int</code></td><td><code>make(chan int)</code></td><td>æ•´æ•°é€šé“</td></tr><tr><td><code>func()</code></td><td><code>func() &#123; fmt.Println(&quot;hello&quot;) &#125;</code></td><td>å‡½æ•°ç±»å‹</td></tr></tbody></table><h3 id="3-æŒ‡é’ˆç±»å‹"><a href="#3-æŒ‡é’ˆç±»å‹" class="headerlink" title="3. æŒ‡é’ˆç±»å‹"></a>3. æŒ‡é’ˆç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>*int</code></td><td><code>new(int)</code></td><td>æ•´æ•°æŒ‡é’ˆ</td></tr><tr><td><code>*string</code></td><td><code>strPtr := new(string)</code></td><td>å­—ç¬¦ä¸²æŒ‡é’ˆ</td></tr><tr><td><code>*struct&#123;&#125;</code></td><td><code>&amp;MyStruct&#123;Field: &quot;val&quot;&#125;</code></td><td>ç»“æ„ä½“æŒ‡é’ˆ</td></tr><tr><td><code>unsafe.Pointer</code></td><td><code>unsafe.Pointer(&amp;x)</code></td><td>é€šç”¨æŒ‡é’ˆç±»å‹</td></tr></tbody></table><h3 id="4-æ¥å£ç±»å‹"><a href="#4-æ¥å£ç±»å‹" class="headerlink" title="4. æ¥å£ç±»å‹"></a>4. æ¥å£ç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>error</code></td><td><code>errors.New(&quot;error&quot;)</code></td><td>é”™è¯¯æ¥å£</td></tr><tr><td><code>io.Reader</code></td><td><code>os.Stdin</code></td><td>è¯»å–å™¨æ¥å£</td></tr><tr><td>è‡ªå®šä¹‰æ¥å£</td><td><code>MyInterfaceImpl&#123;&#125;</code></td><td>ä»»ä½•æ¥å£å®ç°</td></tr></tbody></table><h3 id="5-ç»“æ„ä½“ç±»å‹"><a href="#5-ç»“æ„ä½“ç±»å‹" class="headerlink" title="5. ç»“æ„ä½“ç±»å‹"></a>5. ç»“æ„ä½“ç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>time.Time</code></td><td><code>time.Now()</code></td><td>æ—¶é—´ç»“æ„ä½“</td></tr><tr><td><code>sync.Mutex</code></td><td><code>sync.Mutex&#123;&#125;</code></td><td>äº’æ–¥é”ç»“æ„ä½“</td></tr><tr><td>è‡ªå®šä¹‰ç»“æ„ä½“</td><td><code>MyStruct&#123;Field: &quot;value&quot;&#125;</code></td><td>ä»»ä½•è‡ªå®šä¹‰ç»“æ„ä½“</td></tr></tbody></table><h3 id="6-ç‰¹æ®Šç±»å‹"><a href="#6-ç‰¹æ®Šç±»å‹" class="headerlink" title="6. ç‰¹æ®Šç±»å‹"></a>6. ç‰¹æ®Šç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>nil</code></td><td><code>nil</code></td><td>ç©ºå€¼</td></tr><tr><td><code>reflect.Value</code></td><td><code>reflect.ValueOf(42)</code></td><td>åå°„å€¼</td></tr><tr><td><code>reflect.Type</code></td><td><code>reflect.TypeOf(&quot;&quot;)</code></td><td>åå°„ç±»å‹</td></tr><tr><td><code>big.Int</code></td><td><code>big.NewInt(1000)</code></td><td>å¤§æ•´æ•°</td></tr></tbody></table><h2 id="ğŸ§ª-ä½¿ç”¨ç¤ºä¾‹"><a href="#ğŸ§ª-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ğŸ§ª ä½¿ç”¨ç¤ºä¾‹"></a>ğŸ§ª ä½¿ç”¨ç¤ºä¾‹</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;math/big&quot;</span></span><br><span class="line"><span class="string">&quot;reflect&quot;</span></span><br><span class="line"><span class="string">&quot;sync&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line"><span class="string">&quot;unsafe&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> CustomStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyInterface <span class="keyword">interface</span> &#123;</span><br><span class="line">Method()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyInterfaceImpl <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m MyInterfaceImpl)</span></span> Method() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">data := <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line"><span class="comment">// åŸºç¡€ç±»å‹</span></span><br><span class="line"><span class="string">&quot;bool&quot;</span>:       <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;string&quot;</span>:     <span class="string">&quot;hello&quot;</span>,</span><br><span class="line"><span class="string">&quot;int&quot;</span>:        <span class="number">42</span>,</span><br><span class="line"><span class="string">&quot;float32&quot;</span>:    <span class="type">float32</span>(<span class="number">3.14</span>),</span><br><span class="line"><span class="string">&quot;complex128&quot;</span>: <span class="built_in">complex</span>(<span class="number">3</span>, <span class="number">4</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤åˆç±»å‹</span></span><br><span class="line"><span class="string">&quot;slice&quot;</span>:      []<span class="keyword">interface</span>&#123;&#125;&#123;<span class="number">1</span>, <span class="string">&quot;two&quot;</span>, <span class="literal">true</span>&#125;,</span><br><span class="line"><span class="string">&quot;map&quot;</span>:        <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>&#123;<span class="string">&quot;one&quot;</span>: <span class="number">1</span>, <span class="string">&quot;two&quot;</span>: <span class="number">2</span>&#125;,</span><br><span class="line"><span class="string">&quot;array&quot;</span>:      [<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;,</span><br><span class="line"><span class="string">&quot;func&quot;</span>:       <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123; fmt.Println(<span class="string">&quot;I&#x27;m a function&quot;</span>) &#125;,</span><br><span class="line"><span class="string">&quot;chan&quot;</span>:       <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡é’ˆç±»å‹</span></span><br><span class="line"><span class="string">&quot;int_ptr&quot;</span>:    <span class="built_in">new</span>(<span class="type">int</span>),</span><br><span class="line"><span class="string">&quot;struct_ptr&quot;</span>: &amp;CustomStruct&#123;Name: <span class="string">&quot;pointer&quot;</span>&#125;,</span><br><span class="line"><span class="string">&quot;unsafe_ptr&quot;</span>: unsafe.Pointer(&amp;data),</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥å£ç±»å‹</span></span><br><span class="line"><span class="string">&quot;error&quot;</span>:      fmt.Errorf(<span class="string">&quot;example error&quot;</span>),</span><br><span class="line"><span class="string">&quot;reader&quot;</span>:     os.Stdin, <span class="comment">// å‡è®¾ os å·²å¯¼å…¥</span></span><br><span class="line"><span class="string">&quot;interface&quot;</span>:  MyInterfaceImpl&#123;&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æ„ä½“ç±»å‹</span></span><br><span class="line"><span class="string">&quot;time&quot;</span>:       time.Now(),</span><br><span class="line"><span class="string">&quot;mutex&quot;</span>:      sync.Mutex&#123;&#125;,</span><br><span class="line"><span class="string">&quot;custom&quot;</span>:     CustomStruct&#123;Name: <span class="string">&quot;value&quot;</span>&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‰¹æ®Šç±»å‹</span></span><br><span class="line"><span class="string">&quot;nil&quot;</span>:        <span class="literal">nil</span>,</span><br><span class="line"><span class="string">&quot;reflect_value&quot;</span>: reflect.ValueOf(<span class="number">42</span>),</span><br><span class="line"><span class="string">&quot;big_int&quot;</span>:    big.NewInt(<span class="number">1000000000000000000</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—®ä¸åŒç±»å‹çš„å€¼</span></span><br><span class="line"><span class="keyword">if</span> f, ok := data[<span class="string">&quot;float32&quot;</span>].(<span class="type">float32</span>); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Float32 value: %.2f\n&quot;</span>, f)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> m, ok := data[<span class="string">&quot;map&quot;</span>].(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>); ok &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Map value:&quot;</span>, m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨æ€ç±»å‹å¤„ç†</span></span><br><span class="line"><span class="keyword">for</span> key, value := <span class="keyword">range</span> data &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;\nKey: %-15s | Type: %-20T | Value: %v&quot;</span>, key, value, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// JSON åºåˆ—åŒ–ï¼ˆæ³¨æ„ï¼šéƒ¨åˆ†ç±»å‹ä¸èƒ½åºåˆ—åŒ–ï¼‰</span></span><br><span class="line">jsonData, _ := json.MarshalIndent(data, <span class="string">&quot;&quot;</span>, <span class="string">&quot;  &quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;\n\nJSON representation:&quot;</span>)</span><br><span class="line">fmt.Println(<span class="type">string</span>(jsonData))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="âš ï¸-é‡è¦æ³¨æ„äº‹é¡¹"><a href="#âš ï¸-é‡è¦æ³¨æ„äº‹é¡¹" class="headerlink" title="âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹"></a>âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹</h2><ol><li><p><strong>ç±»å‹æ–­è¨€</strong>ï¼šä» <code>interface&#123;&#125;</code> è·å–å€¼æ—¶å¿…é¡»è¿›è¡Œç±»å‹æ–­è¨€</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> str, ok := myMap[<span class="string">&quot;key&quot;</span>].(<span class="type">string</span>); ok &#123;</span><br><span class="line">    <span class="comment">// æ­£ç¡®ä½¿ç”¨å­—ç¬¦ä¸²å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>JSON åºåˆ—åŒ–é™åˆ¶</strong>ï¼š</p><ul><li>é€šé“ã€å‡½æ•°ã€å¾ªç¯å¼•ç”¨çš„ç»“æ„ä½“ä¸èƒ½åºåˆ—åŒ–ä¸º JSON</li><li>æŒ‡é’ˆç±»å‹ä¼šåºåˆ—åŒ–ä¸ºå…¶æŒ‡å‘çš„å€¼</li><li><code>time.Time</code> ä¼šåºåˆ—åŒ–ä¸º RFC3339 æ ¼å¼å­—ç¬¦ä¸²</li></ul></li><li><p><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼š</p><ul><li>ä½¿ç”¨å…·ä½“ç±»å‹æ¯” <code>interface&#123;&#125;</code> æ›´é«˜æ•ˆ</li><li>é¢‘ç¹æ“ä½œæ—¶è€ƒè™‘å…·ä½“ç±»å‹æˆ–ä»£ç ç”Ÿæˆæ–¹æ¡ˆ</li></ul></li><li><p><strong>ç±»å‹å®‰å…¨</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å±é™©ï¼šè¿è¡Œæ—¶å¯èƒ½ panic</span></span><br><span class="line">str := myMap[<span class="string">&quot;key&quot;</span>].(<span class="type">string</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®‰å…¨ï¼šå¸¦æ£€æŸ¥çš„ç±»å‹æ–­è¨€</span></span><br><span class="line"><span class="keyword">if</span> str, ok := myMap[<span class="string">&quot;key&quot;</span>].(<span class="type">string</span>); ok &#123;</span><br><span class="line">    <span class="comment">// å®‰å…¨ä½¿ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><p>é€šç”¨ç»“æ„ä½“æ–¹æ¡ˆï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> GenericValue <span class="keyword">struct</span> &#123;</span><br><span class="line">    Type  <span class="type">string</span></span><br><span class="line">    Value <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä»£ç ç”Ÿæˆæ–¹æ¡ˆï¼ˆå¦‚ä½¿ç”¨ <code>stringer</code> å·¥å…·ï¼‰</p></li><li><p>Protobuf çš„ <code>Any</code> ç±»å‹</p></li></ul></li></ol><h2 id="ğŸ’¡-æœ€ä½³å®è·µ"><a href="#ğŸ’¡-æœ€ä½³å®è·µ" class="headerlink" title="ğŸ’¡ æœ€ä½³å®è·µ"></a>ğŸ’¡ æœ€ä½³å®è·µ</h2><ol><li><p><strong>ä¼˜å…ˆä½¿ç”¨å…·ä½“ç±»å‹</strong>ï¼šå°½å¯èƒ½ä½¿ç”¨å…·ä½“ç±»å‹è€Œé <code>interface&#123;&#125;</code></p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¼˜äº map[string]interface&#123;&#125;</span></span><br><span class="line"><span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span></span><br><span class="line"><span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span></span><br></pre></td></tr></table></figure></li><li><p><strong>å®šä¹‰è¾¹ç•Œæ¸…æ™°çš„æ¥å£</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Storage <span class="keyword">interface</span> &#123;</span><br><span class="line">    Get(key <span class="type">string</span>) (<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>)</span><br><span class="line">    Set(key <span class="type">string</span>, value <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ç±»å‹å¼€å…³å¤„ç†å¤šç§ç±»å‹</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">processValue</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> val := v.(<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">string</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;String:&quot;</span>, val)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">int</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;Int:&quot;</span>, val)</span><br><span class="line">    <span class="keyword">case</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>:</span><br><span class="line">        val()</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        fmt.Printf(<span class="string">&quot;Unhandled type: %T\n&quot;</span>, val)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>é™åˆ¶å¯æ¥å—ç±»å‹</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> allowedTypes = <span class="keyword">map</span>[reflect.Kind]<span class="type">bool</span>&#123;</span><br><span class="line">    reflect.String:  <span class="literal">true</span>,</span><br><span class="line">    reflect.Int:     <span class="literal">true</span>,</span><br><span class="line">    reflect.Float64: <span class="literal">true</span>,</span><br><span class="line">    reflect.Bool:    <span class="literal">true</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ValidateValue</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">    kind := reflect.TypeOf(v).Kind()</span><br><span class="line">    <span class="keyword">return</span> allowedTypes[kind]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ–‡æ¡£åŒ–é¢„æœŸç±»å‹</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Config holds application configuration</span></span><br><span class="line"><span class="comment">// Possible types per key:</span></span><br><span class="line"><span class="comment">//   &quot;timeout&quot;: int (seconds)</span></span><br><span class="line"><span class="comment">//   &quot;debug&quot;: bool</span></span><br><span class="line"><span class="comment">//   &quot;servers&quot;: []string</span></span><br><span class="line"><span class="keyword">type</span> Config <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="ğŸŒŸ-æ€»ç»“"><a href="#ğŸŒŸ-æ€»ç»“" class="headerlink" title="ğŸŒŸ æ€»ç»“"></a>ğŸŒŸ æ€»ç»“</h2><p><code>map[string]interface&#123;&#125;</code> çš„å€¼å¯ä»¥æ˜¯ Go è¯­è¨€ä¸­çš„<strong>ä»»ä½•ç±»å‹</strong>ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li>æ‰€æœ‰åŸºç¡€ç±»å‹ï¼ˆbool, æ•°å€¼, å­—ç¬¦ä¸², å¤æ•°ï¼‰</li><li>å¤åˆç±»å‹ï¼ˆåˆ‡ç‰‡ã€æ˜ å°„ã€æ•°ç»„ã€é€šé“ã€å‡½æ•°ï¼‰</li><li>æŒ‡é’ˆç±»å‹ï¼ˆåŒ…æ‹¬ unsafe æŒ‡é’ˆï¼‰</li><li>æ¥å£ç±»å‹ï¼ˆåŒ…æ‹¬ error ç­‰å†…ç½®æ¥å£ï¼‰</li><li>ç»“æ„ä½“ç±»å‹ï¼ˆå†…ç½®å’Œè‡ªå®šä¹‰ï¼‰</li><li>ç‰¹æ®Šç±»å‹ï¼ˆnil, åå°„å¯¹è±¡, å¤§æ•´æ•°ç­‰ï¼‰</li></ol><p>è¿™ç§çµæ´»æ€§ä½¿å…¶æˆä¸ºå¤„ç†åŠ¨æ€æ•°æ®ã€JSON è§£æã€é…ç½®ç®¡ç†å’Œé€šç”¨å­˜å‚¨çš„ç†æƒ³é€‰æ‹©ã€‚ç„¶è€Œï¼Œä½¿ç”¨æ—¶éœ€è¦è°¨æ…å¤„ç†ç±»å‹å®‰å…¨å’Œæ€§èƒ½é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ç¨‹åºã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;&lt;code&gt;Go&lt;/code&gt; &lt;code&gt;[å¯å®¹çº³çš„å€¼]interface&amp;#123;&amp;#125;&lt;/code&gt;æ¥å£å¯å®¹çº³çš„å€¼&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/Golang/"/>
    
    <category term="æ–‡æ¡£" scheme="https://kanoc.gitee.io/categories/Golang/%E6%96%87%E6%A1%A3/"/>
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/tags/Golang/"/>
    
    <category term="æ¥å£" scheme="https://kanoc.gitee.io/tags/%E6%8E%A5%E5%8F%A3/"/>
    
  </entry>
  
  <entry>
    <title>Go_ORM_mysqlæ•°æ®åº“æ¨¡ç‰ˆ</title>
    <link href="https://kanoc.gitee.io/2025/06/10/Go-ORM-mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E7%89%88/"/>
    <id>https://kanoc.gitee.io/2025/06/10/Go-ORM-mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E7%89%88/</id>
    <published>2025-06-10T11:31:46.000Z</published>
    <updated>2025-06-10T12:04:20.236Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Go ORM mysqlæ•°æ®åº“æ¨¡ç‰ˆ</strong></font></p><span id="more"></span><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> mysql</span><br><span class="line"></span><br><span class="line"><span class="comment">// go get -u gorm.io/driver/mysql  // å®‰è£…mysql é©±åŠ¨</span></span><br><span class="line"><span class="comment">// go get -u gorm.io/gorm</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">    <span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">    <span class="string">&quot;gorm.io/gorm/logger&quot;</span></span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">    <span class="string">&quot;testing&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> v1Table <span class="keyword">struct</span> &#123; <span class="comment">// éœ€è¦ä¿®æ”¹çš„å­—æ®µæ˜ å°„</span></span><br><span class="line">    Id           <span class="type">uint32</span> <span class="string">`gorm:&quot;column:id;AUTO_INCREMENT&quot;`</span></span><br><span class="line">    Md5Id        <span class="type">string</span> <span class="string">`gorm:&quot;column:Md5Id&quot;`</span></span><br><span class="line">    Title        <span class="type">string</span> <span class="string">`gorm:&quot;column:title&quot;`</span></span><br><span class="line">  <span class="comment">// åˆ›å»ºæ—¶é—´ - åªåœ¨ç¬¬ä¸€æ¬¡æ’å…¥æ—¶è®¾ç½®</span></span><br><span class="line">    InsertTime time.Time <span class="string">`gorm:&quot;column:InsertTime;autoCreateTime&quot;`</span></span><br><span class="line">    <span class="comment">// æ›´æ–°æ—¶é—´ - æ¯æ¬¡æ›´æ–°æ—¶è‡ªåŠ¨æ›´æ–°</span></span><br><span class="line">    UpTime       time.Time <span class="string">`gorm:&quot;column:UpTime;autoUpdateTime&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> v2Table <span class="keyword">struct</span> &#123; <span class="comment">// éœ€è¦ä¿®æ”¹çš„å­—æ®µæ˜ å°„</span></span><br><span class="line">    Id    <span class="type">uint32</span> <span class="string">`gorm:&quot;column:id;AUTO_INCREMENT&quot;`</span></span><br><span class="line">    Md5Id <span class="type">string</span> <span class="string">`gorm:&quot;column:Md5Id&quot;`</span></span><br><span class="line">    Title        <span class="type">string</span> <span class="string">`gorm:&quot;column:Title&quot;`</span>        <span class="comment">// å…¨åç§°</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºæ—¶é—´ - åªåœ¨ç¬¬ä¸€æ¬¡æ’å…¥æ—¶è®¾ç½®</span></span><br><span class="line">    InsertTime time.Time <span class="string">`gorm:&quot;column:InsertTime;autoCreateTime&quot;`</span></span><br><span class="line">    <span class="comment">// æ›´æ–°æ—¶é—´ - æ¯æ¬¡æ›´æ–°æ—¶è‡ªåŠ¨æ›´æ–°</span></span><br><span class="line">    UpTime       time.Time <span class="string">`gorm:&quot;column:UpTime;autoUpdateTime&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v1Table)</span></span> TableName() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;v1Table&quot;</span> <span class="comment">// æ•°æ®åº“è¡¨çš„åç§°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v2Table)</span></span> TableName() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;v2Table&quot;</span> <span class="comment">// æ•°æ®åº“è¡¨çš„åç§°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®æ•°æ®åº“ å‚æ•°</span></span><br><span class="line"><span class="keyword">type</span> config <span class="keyword">struct</span> &#123;</span><br><span class="line">    user   <span class="type">string</span></span><br><span class="line">    pass   <span class="type">string</span></span><br><span class="line">    adrr   <span class="type">string</span></span><br><span class="line">    port   <span class="type">string</span></span><br><span class="line">    dbname <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    db     *gorm.DB</span><br><span class="line">    dbOnce sync.Once <span class="comment">// ç¡®ä¿è¿æ¥åªåˆå§‹åŒ–ä¸€æ¬¡</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetDB è·å–æ•°æ®åº“è¿æ¥å®ä¾‹ (çº¿ç¨‹å®‰å…¨)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetDB</span><span class="params">()</span></span> *gorm.DB &#123;</span><br><span class="line">    <span class="keyword">if</span> db == <span class="literal">nil</span> &#123;</span><br><span class="line">       dbOnce.Do(<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">          initDB()</span><br><span class="line">       &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> db</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// initDB åˆå§‹åŒ–æ•°æ®åº“è¿æ¥ (åªæ‰§è¡Œä¸€æ¬¡)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initDB</span><span class="params">()</span></span> &#123;</span><br><span class="line">    conf := &amp;config&#123;</span><br><span class="line">       user:   <span class="string">&quot;TestDBSql&quot;</span>,        <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">       pass:   <span class="string">&quot;msEs3IlksfJi&quot;</span>, <span class="comment">// å¯†ç </span></span><br><span class="line">       adrr:   <span class="string">&quot;127.0.0.1&quot;</span>,        <span class="comment">// åœ°å€</span></span><br><span class="line">       port:   <span class="string">&quot;3306&quot;</span>,             <span class="comment">// ç«¯å£</span></span><br><span class="line">       dbname: <span class="string">&quot;TestDBSql&quot;</span>,        <span class="comment">// æ•°æ®åº“åç§°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dsn := fmt.Sprintf(<span class="string">&quot;%s:%s@tcp(%s:%s)/%s?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;</span>,</span><br><span class="line">       conf.user, conf.pass, conf.adrr, conf.port, conf.dbname)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line">    db, err = gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;</span><br><span class="line">       Logger: logger.Default.LogMode(logger.Info),</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">       <span class="built_in">panic</span>(<span class="string">&quot;failed to connect database: &quot;</span> + err.Error())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ================= æ–°å¢è‡ªåŠ¨è¿ç§»é€»è¾‘ =================</span></span><br><span class="line">    <span class="comment">// è‡ªåŠ¨åˆ›å»º/æ›´æ–°è¡¨ç»“æ„ï¼ˆæ³¨æ„ï¼šGORMçš„AutoMigrateåªä¼šæ–°å¢å­—æ®µï¼Œä¸ä¼šåˆ é™¤/ä¿®æ”¹å·²æœ‰å­—æ®µï¼‰</span></span><br><span class="line">    err = db.AutoMigrate(</span><br><span class="line">       &amp;VideoTable&#123;&#125;,</span><br><span class="line">       &amp;MhTable&#123;&#125;,</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">       <span class="built_in">panic</span>(<span class="string">&quot;auto migrate failed: &quot;</span> + err.Error())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®è¿æ¥æ± </span></span><br><span class="line">    sqlDB, err := db.DB()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">       <span class="built_in">panic</span>(<span class="string">&quot;failed to get underlying sql.DB: &quot;</span> + err.Error())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿æ¥æ± é…ç½®</span></span><br><span class="line">    sqlDB.SetMaxIdleConns(<span class="number">10</span>)                  <span class="comment">// ç©ºé—²è¿æ¥æ•°</span></span><br><span class="line">    sqlDB.SetMaxOpenConns(<span class="number">100</span>)                 <span class="comment">// æœ€å¤§æ‰“å¼€è¿æ¥æ•°</span></span><br><span class="line">    sqlDB.SetConnMaxLifetime(<span class="number">30</span> * time.Minute) <span class="comment">// è¿æ¥æœ€å¤§å­˜æ´»æ—¶é—´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢å†…å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestClientDb</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    db := GetDB()</span><br><span class="line">    <span class="keyword">var</span> V1 v1Table</span><br><span class="line">    db.Where(<span class="string">&quot;id = ?&quot;</span>, <span class="number">1</span>).First(&amp;video)</span><br><span class="line">    ub := &amp;V1&#123;&#125;</span><br><span class="line">    err := db.Where(<span class="string">&quot;Title = ?&quot;</span>, <span class="string">&quot;æµ‹è¯•&quot;</span>).Find(&amp;ub).Error</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">       <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;userBase:%+v&quot;</span>, ub)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‰¹åˆ«è¯´æ˜ï¼š"><a href="#ç‰¹åˆ«è¯´æ˜ï¼š" class="headerlink" title="ç‰¹åˆ«è¯´æ˜ï¼š"></a>ç‰¹åˆ«è¯´æ˜ï¼š</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">InsertTime time.Time <span class="string">`gorm:&quot;column:InsertTime;autoCreateTime&quot;`</span> </span><br><span class="line"><span class="comment">// autoCreateTime: åªåœ¨è®°å½•åˆ›å»ºæ—¶è‡ªåŠ¨è®¾ç½®å½“å‰æ—¶é—´</span></span><br><span class="line"></span><br><span class="line">UpTime     time.Time <span class="string">`gorm:&quot;column:UpTime;autoUpdateTime&quot;`</span></span><br><span class="line"><span class="comment">// autoUpdateTime: åœ¨åˆ›å»ºå’Œæ›´æ–°æ—¶éƒ½è‡ªåŠ¨è®¾ç½®å½“å‰æ—¶é—´</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Go ORM mysqlæ•°æ®åº“æ¨¡ç‰ˆ&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/Golang/"/>
    
    <category term="æ•°æ®åº“" scheme="https://kanoc.gitee.io/categories/Golang/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/tags/Golang/"/>
    
    <category term="ORM" scheme="https://kanoc.gitee.io/tags/ORM/"/>
    
    <category term="mysql" scheme="https://kanoc.gitee.io/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>Go_Gormæ”¯æŒçš„æ•°æ®ç±»å‹</title>
    <link href="https://kanoc.gitee.io/2025/06/10/Go-Gorm%E6%94%AF%E6%8C%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <id>https://kanoc.gitee.io/2025/06/10/Go-Gorm%E6%94%AF%E6%8C%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</id>
    <published>2025-06-10T11:04:42.000Z</published>
    <updated>2025-06-10T11:08:16.820Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Go_Gormæ”¯æŒçš„æ•°æ®ç±»å‹</strong></font></p><span id="more"></span><p>GORM æ”¯æŒå¹¿æ³›çš„ Go æ•°æ®ç±»å‹ï¼Œå¹¶èƒ½è‡ªåŠ¨å°†å®ƒä»¬æ˜ å°„åˆ°å¯¹åº”çš„æ•°æ®åº“ç±»å‹ã€‚ä»¥ä¸‹æ˜¯ GORM æ”¯æŒçš„ä¸»è¦æ•°æ®ç±»å‹åŠå…¶åœ¨å¸¸è§æ•°æ®åº“ï¼ˆå¦‚ MySQLï¼‰ä¸­çš„æ˜ å°„å…³ç³»ï¼š</p><hr><h3 id="åŸºç¡€æ•°æ®ç±»å‹"><a href="#åŸºç¡€æ•°æ®ç±»å‹" class="headerlink" title="åŸºç¡€æ•°æ®ç±»å‹"></a><strong>åŸºç¡€æ•°æ®ç±»å‹</strong></h3><table><thead><tr><th align="left">Go ç±»å‹</th><th align="left">MySQL ç±»å‹</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><code>bool</code></td><td align="left"><code>TINYINT(1)</code></td><td align="left">å¸ƒå°”å€¼ï¼Œtrue&#x3D;1, false&#x3D;0</td></tr><tr><td align="left"><code>int</code></td><td align="left"><code>INT</code></td><td align="left">32ä½æ•´æ•°</td></tr><tr><td align="left"><code>int8</code></td><td align="left"><code>TINYINT</code></td><td align="left">8ä½æ•´æ•°</td></tr><tr><td align="left"><code>int16</code></td><td align="left"><code>SMALLINT</code></td><td align="left">16ä½æ•´æ•°</td></tr><tr><td align="left"><code>int32</code></td><td align="left"><code>INT</code></td><td align="left">32ä½æ•´æ•°</td></tr><tr><td align="left"><code>int64</code></td><td align="left"><code>BIGINT</code></td><td align="left">64ä½æ•´æ•°</td></tr><tr><td align="left"><code>uint</code></td><td align="left"><code>INT UNSIGNED</code></td><td align="left">æ— ç¬¦å·32ä½æ•´æ•°</td></tr><tr><td align="left"><code>uint8</code></td><td align="left"><code>TINYINT UNSIGNED</code></td><td align="left">æ— ç¬¦å·8ä½æ•´æ•°</td></tr><tr><td align="left"><code>uint16</code></td><td align="left"><code>SMALLINT UNSIGNED</code></td><td align="left">æ— ç¬¦å·16ä½æ•´æ•°</td></tr><tr><td align="left"><code>uint32</code></td><td align="left"><code>INT UNSIGNED</code></td><td align="left">æ— ç¬¦å·32ä½æ•´æ•°</td></tr><tr><td align="left"><code>uint64</code></td><td align="left"><code>BIGINT UNSIGNED</code></td><td align="left">æ— ç¬¦å·64ä½æ•´æ•°</td></tr><tr><td align="left"><code>float32</code></td><td align="left"><code>FLOAT</code></td><td align="left">å•ç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td align="left"><code>float64</code></td><td align="left"><code>DOUBLE</code></td><td align="left">åŒç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td align="left"><code>string</code></td><td align="left"><code>VARCHAR(255)</code></td><td align="left">å­—ç¬¦ä¸²ï¼ˆé»˜è®¤é•¿åº¦255ï¼‰ï¼Œå¯é€šè¿‡æ ‡ç­¾æŒ‡å®šé•¿åº¦</td></tr><tr><td align="left"><code>[]byte</code></td><td align="left"><code>BLOB</code>&#x2F;<code>LONGBLOB</code></td><td align="left">äºŒè¿›åˆ¶æ•°æ®</td></tr><tr><td align="left"><code>time.Time</code></td><td align="left"><code>DATETIME</code>&#x2F;<code>TIMESTAMP</code></td><td align="left">æ—¶é—´ç±»å‹ï¼Œé»˜è®¤ç²¾åº¦åˆ°ç§’</td></tr></tbody></table><hr><h3 id="é«˜çº§-ç‰¹æ®Šç±»å‹"><a href="#é«˜çº§-ç‰¹æ®Šç±»å‹" class="headerlink" title="é«˜çº§&#x2F;ç‰¹æ®Šç±»å‹"></a><strong>é«˜çº§&#x2F;ç‰¹æ®Šç±»å‹</strong></h3><table><thead><tr><th align="left">Go ç±»å‹&#x2F;ç”¨æ³•</th><th align="left">MySQL ç±»å‹</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><code>*int</code> &#x2F; <code>sql.NullInt64</code></td><td align="left"><code>INT NULL</code></td><td align="left">å¯ç©ºæ•´æ•°</td></tr><tr><td align="left"><code>*bool</code> &#x2F; <code>sql.NullBool</code></td><td align="left"><code>TINYINT(1) NULL</code></td><td align="left">å¯ç©ºå¸ƒå°”å€¼</td></tr><tr><td align="left"><code>*string</code> &#x2F; <code>sql.NullString</code></td><td align="left"><code>VARCHAR(255) NULL</code></td><td align="left">å¯ç©ºå­—ç¬¦ä¸²</td></tr><tr><td align="left"><code>*float64</code> &#x2F; <code>sql.NullFloat64</code></td><td align="left"><code>DOUBLE NULL</code></td><td align="left">å¯ç©ºæµ®ç‚¹æ•°</td></tr><tr><td align="left"><code>*time.Time</code> &#x2F; <code>sql.NullTime</code></td><td align="left"><code>DATETIME NULL</code></td><td align="left">å¯ç©ºæ—¶é—´</td></tr><tr><td align="left"><code>gorm.DeletedAt</code></td><td align="left"><code>DATETIME NULL</code></td><td align="left">è½¯åˆ é™¤å­—æ®µ</td></tr><tr><td align="left"><code>json.RawMessage</code></td><td align="left"><code>JSON</code> (MySQL 5.7+)</td><td align="left">JSON æ•°æ®ï¼ˆéœ€è¦æ•°æ®åº“æ”¯æŒï¼‰</td></tr><tr><td align="left"><code>map[string]interface&#123;&#125;</code></td><td align="left"><code>JSON</code></td><td align="left">JSON å¯¹è±¡</td></tr><tr><td align="left"><code>[]string</code> &#x2F; <code>[]int</code></td><td align="left"><code>JSON</code></td><td align="left">æ•°ç»„ï¼ˆåºåˆ—åŒ–ä¸º JSONï¼‰</td></tr><tr><td align="left"><code>uuid.UUID</code> (github.com&#x2F;google&#x2F;uuid)</td><td align="left"><code>CHAR(36)</code></td><td align="left">UUID ç±»å‹</td></tr><tr><td align="left"><code>decimal.Decimal</code> (github.com&#x2F;shopspring&#x2F;decimal)</td><td align="left"><code>DECIMAL(65,30)</code></td><td align="left">é«˜ç²¾åº¦åè¿›åˆ¶æ•°</td></tr></tbody></table><hr><h3 id="è‡ªå®šä¹‰ç±»å‹å¤„ç†"><a href="#è‡ªå®šä¹‰ç±»å‹å¤„ç†" class="headerlink" title="è‡ªå®šä¹‰ç±»å‹å¤„ç†"></a><strong>è‡ªå®šä¹‰ç±»å‹å¤„ç†</strong></h3><p>GORM æ”¯æŒé€šè¿‡æ¥å£å®ç°è‡ªå®šä¹‰ç±»å‹ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> MyCustomType <span class="type">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç° Valuer æ¥å£ - å®šä¹‰å¦‚ä½•å­˜å‚¨åˆ°æ•°æ®åº“</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m MyCustomType)</span></span> Value() (driver.Value, <span class="type">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> strings.ToUpper(<span class="type">string</span>(m)), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç° Scanner æ¥å£ - å®šä¹‰å¦‚ä½•ä»æ•°æ®åº“è¯»å–</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *MyCustomType)</span></span> Scan(value <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> value == <span class="literal">nil</span> &#123;</span><br><span class="line">        *m = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> v, ok := value.([]<span class="type">byte</span>); ok &#123;</span><br><span class="line">        *m = MyCustomType(strings.ToLower(<span class="type">string</span>(v)))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;cannot convert %T to MyCustomType&quot;</span>, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID   <span class="type">uint</span></span><br><span class="line">    Role MyCustomType <span class="string">`gorm:&quot;type:VARCHAR(10)&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="ç±»å‹æ˜ å°„æ§åˆ¶"><a href="#ç±»å‹æ˜ å°„æ§åˆ¶" class="headerlink" title="ç±»å‹æ˜ å°„æ§åˆ¶"></a><strong>ç±»å‹æ˜ å°„æ§åˆ¶</strong></h3><p>å¯ä»¥é€šè¿‡ GORM æ ‡ç­¾ç²¾ç¡®æ§åˆ¶æ•°æ®åº“ç±»å‹ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Product <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID          <span class="type">uint</span>      <span class="string">`gorm:&quot;primaryKey&quot;`</span></span><br><span class="line">    Name        <span class="type">string</span>    <span class="string">`gorm:&quot;type:VARCHAR(100);not null&quot;`</span></span><br><span class="line">    Price       <span class="type">float64</span>   <span class="string">`gorm:&quot;type:DECIMAL(10,2)&quot;`</span></span><br><span class="line">    Description <span class="type">string</span>    <span class="string">`gorm:&quot;type:TEXT&quot;`</span></span><br><span class="line">    IsActive    <span class="type">bool</span>      <span class="string">`gorm:&quot;default:true&quot;`</span></span><br><span class="line">    CreatedAt   time.Time <span class="string">`gorm:&quot;type:TIMESTAMP;default:CURRENT_TIMESTAMP&quot;`</span></span><br><span class="line">    Metadata    JSON      <span class="string">`gorm:&quot;type:JSON&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰ JSON ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> JSON <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(j JSON)</span></span> Value() (driver.Value, <span class="type">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> json.Marshal(j)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(j *JSON)</span></span> Scan(value <span class="keyword">interface</span>&#123;&#125;) <span class="type">error</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> value == <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    b, ok := value.([]<span class="type">byte</span>)</span><br><span class="line">    <span class="keyword">if</span> !ok &#123;</span><br><span class="line">        <span class="keyword">return</span> errors.New(<span class="string">&quot;type assertion to []byte failed&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> json.Unmarshal(b, &amp;j)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="æšä¸¾ç±»å‹å¤„ç†"><a href="#æšä¸¾ç±»å‹å¤„ç†" class="headerlink" title="æšä¸¾ç±»å‹å¤„ç†"></a><strong>æšä¸¾ç±»å‹å¤„ç†</strong></h3><p>è™½ç„¶ Go æ²¡æœ‰åŸç”Ÿæšä¸¾ï¼Œä½†å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²+æ£€æŸ¥å®ç°ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID     <span class="type">uint</span></span><br><span class="line">    Status <span class="type">string</span> <span class="string">`gorm:&quot;type:ENUM(&#x27;active&#x27;, &#x27;inactive&#x27;, &#x27;pending&#x27;);default:&#x27;pending&#x27;&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æ£€æŸ¥çº¦æŸ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span></span> BeforeSave(tx *gorm.DB) (err <span class="type">error</span>) &#123;</span><br><span class="line">    validStatus := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span>&#123;<span class="string">&quot;active&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;inactive&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;pending&quot;</span>: <span class="literal">true</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> !validStatus[u.Status] &#123;</span><br><span class="line">        <span class="keyword">return</span> errors.New(<span class="string">&quot;invalid status value&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="è‡ªåŠ¨ç±»å‹æ¨æ–­"><a href="#è‡ªåŠ¨ç±»å‹æ¨æ–­" class="headerlink" title="è‡ªåŠ¨ç±»å‹æ¨æ–­"></a><strong>è‡ªåŠ¨ç±»å‹æ¨æ–­</strong></h3><p>å½“ä½¿ç”¨ <code>AutoMigrate</code> æ—¶ï¼ŒGORM ä¼šæ ¹æ® Go ç±»å‹è‡ªåŠ¨åˆ›å»ºåˆé€‚çš„æ•°æ®åº“åˆ—ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">db.AutoMigrate(&amp;Product&#123;&#125;)</span><br><span class="line"><span class="comment">// ä¼šè‡ªåŠ¨åˆ›å»ºï¼š</span></span><br><span class="line"><span class="comment">// - VARCHAR(255) for string</span></span><br><span class="line"><span class="comment">// - BIGINT for int64</span></span><br><span class="line"><span class="comment">// - FLOAT for float32</span></span><br><span class="line"><span class="comment">// - DOUBLE for float64</span></span><br><span class="line"><span class="comment">// - TINYINT(1) for bool</span></span><br><span class="line"><span class="comment">// - DATETIME for time.Time</span></span><br></pre></td></tr></table></figure><hr><h3 id="ç‰¹æ®Šæ³¨æ„äº‹é¡¹"><a href="#ç‰¹æ®Šæ³¨æ„äº‹é¡¹" class="headerlink" title="ç‰¹æ®Šæ³¨æ„äº‹é¡¹"></a><strong>ç‰¹æ®Šæ³¨æ„äº‹é¡¹</strong></h3><ol><li><p><strong>æ—¶é—´ç±»å‹</strong>ï¼š</p><ul><li><code>time.Time</code> é»˜è®¤æ˜ å°„ä¸º <code>DATETIME</code></li><li>ä½¿ç”¨ <code>gorm:&quot;type:TIMESTAMP&quot;</code> å¯æŒ‡å®šä¸ºæ—¶é—´æˆ³</li><li>ä½¿ç”¨ <code>gorm:&quot;autoCreateTime&quot;</code> &#x2F; <code>gorm:&quot;autoUpdateTime&quot;</code> è‡ªåŠ¨ç®¡ç†æ—¶é—´</li></ul></li><li><p><strong>JSON æ”¯æŒ</strong>ï¼š</p><ul><li>MySQL 5.7+ åŸç”Ÿæ”¯æŒ JSON ç±»å‹</li><li>æ—§ç‰ˆæœ¬å¯åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²å­˜å‚¨</li></ul></li><li><p><strong>é»˜è®¤å€¼</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">Active <span class="type">bool</span> <span class="string">`gorm:&quot;default:true&quot;`</span></span><br></pre></td></tr></table></figure></li><li><p><strong>å¤§å°é™åˆ¶</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">Description <span class="type">string</span> <span class="string">`gorm:&quot;size:5000&quot;`</span> <span class="comment">// TEXT ç±»å‹</span></span><br></pre></td></tr></table></figure></li><li><p><strong>è‡ªå®šä¹‰ç±»å‹æ˜ å°„</strong>ï¼š</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">gorm:<span class="string">&quot;type:MEDIUMTEXT&quot;</span> <span class="comment">// æŒ‡å®šä¸º MEDIUMTEXT</span></span><br></pre></td></tr></table></figure></li></ol><hr><h3 id="æ•°æ®åº“å·®å¼‚"><a href="#æ•°æ®åº“å·®å¼‚" class="headerlink" title="æ•°æ®åº“å·®å¼‚"></a><strong>æ•°æ®åº“å·®å¼‚</strong></h3><table><thead><tr><th align="left">ç±»å‹</th><th align="left">MySQL</th><th align="left">PostgreSQL</th><th align="left">SQLite</th></tr></thead><tbody><tr><td align="left">å¸ƒå°”å€¼</td><td align="left">TINYINT(1)</td><td align="left">BOOLEAN</td><td align="left">BOOLEAN</td></tr><tr><td align="left">å¤§æ–‡æœ¬</td><td align="left">LONGTEXT</td><td align="left">TEXT</td><td align="left">TEXT</td></tr><tr><td align="left">æ•°ç»„</td><td align="left">JSON</td><td align="left">ARRAY</td><td align="left">JSON</td></tr><tr><td align="left">JSON</td><td align="left">JSON (5.7+)</td><td align="left">JSONB</td><td align="left">JSON</td></tr><tr><td align="left">æ—¶é—´</td><td align="left">DATETIME</td><td align="left">TIMESTAMP</td><td align="left">DATETIME</td></tr><tr><td align="left">è‡ªå¢ID</td><td align="left">AUTO_INCREMENT</td><td align="left">SERIAL</td><td align="left">AUTOINCREMENT</td></tr></tbody></table><p>å»ºè®®åœ¨æ¨¡å‹å®šä¹‰ä¸­æ˜¾å¼æŒ‡å®šç±»å‹ä»¥ç¡®ä¿è·¨æ•°æ®åº“å…¼å®¹æ€§ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Go_Gormæ”¯æŒçš„æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/Golang/"/>
    
    <category term="æ•°æ®åº“" scheme="https://kanoc.gitee.io/categories/Golang/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://kanoc.gitee.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="Golang" scheme="https://kanoc.gitee.io/tags/Golang/"/>
    
    <category term="ORM" scheme="https://kanoc.gitee.io/tags/ORM/"/>
    
    <category term="mysql" scheme="https://kanoc.gitee.io/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>GoLangçš„websocketç¼–ç¨‹</title>
    <link href="https://kanoc.gitee.io/2025/06/08/GoLang%E7%9A%84websocket%E7%BC%96%E7%A8%8B/"/>
    <id>https://kanoc.gitee.io/2025/06/08/GoLang%E7%9A%84websocket%E7%BC%96%E7%A8%8B/</id>
    <published>2025-06-08T05:03:35.000Z</published>
    <updated>2025-06-09T10:44:59.626Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>GoLangçš„websocketç¼–ç¨‹</strong></font></p><span id="more"></span><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gorilla/websocket&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> upgrader = websocket.Upgrader&#123;</span><br><span class="line">CheckOrigin: <span class="function"><span class="keyword">func</span><span class="params">(r *http.Request)</span></span> <span class="type">bool</span> &#123; <span class="keyword">return</span> <span class="literal">true</span> &#125;, <span class="comment">// è§£å†³è·¨åŸŸ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleWebSocket</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">conn, err := upgrader.Upgrade(w, r, <span class="literal">nil</span>) <span class="comment">// HTTP å‡çº§ä¸º WebSocket</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">&quot;å‡çº§å¤±è´¥:&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> conn.Close()</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">msgType, msg, err := conn.ReadMessage() <span class="comment">// è¯»å–æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">&quot;è¯»å–é”™è¯¯:&quot;</span>, err)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(msg)</span><br><span class="line">fmt.Println(reflect.TypeOf(msg))</span><br><span class="line">fmt.Println(reflect.TypeOf(msgType))</span><br><span class="line">log.Printf(<span class="string">&quot;æ”¶åˆ°: %s&quot;</span>, msg)</span><br><span class="line"><span class="comment">// åŸæ ·è¿”å›æ¶ˆæ¯ï¼ˆå®ç° Echo æœåŠ¡ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> err := conn.WriteMessage(msgType, msg); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">&quot;å‘é€é”™è¯¯:&quot;</span>, err)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">http.HandleFunc(<span class="string">&quot;/ws&quot;</span>, handleWebSocket)</span><br><span class="line">log.Fatal(http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1ã€æ ¸å¿ƒä»£ç å®ç°"><a href="#1ã€æ ¸å¿ƒä»£ç å®ç°" class="headerlink" title="1ã€æ ¸å¿ƒä»£ç å®ç°"></a>1ã€æ ¸å¿ƒä»£ç å®ç°</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åˆ‡ç‰‡ï¼Œæ˜ç¡®æŒ‡å®šä¸ºæ–‡æœ¬æ¶ˆæ¯ç±»å‹</span></span><br><span class="line"><span class="keyword">if</span> err := conn.WriteMessage(websocket.TextMessage, []<span class="type">byte</span>(msg)); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    log.Printf(<span class="string">&quot;æ¶ˆæ¯æ¨é€å¤±è´¥: %v&quot;</span>, err)</span><br><span class="line">    <span class="comment">// å¯é€‰ï¼šè¿”å›é”™è¯¯ä¿¡æ¯ç»™è°ƒç”¨æ–¹</span></span><br><span class="line">    <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;æ¨é€å¤±è´¥: %w&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// websocket.TextMessageï¼šé€‚ç”¨äº UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ JSON/XMLï¼‰</span></span><br><span class="line"><span class="comment">// websocket.BinaryMessageï¼šé€‚ç”¨äºäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡/éŸ³è§†é¢‘ï¼‰</span></span><br><span class="line"><span class="comment">// å­—ç¬¦ä¸²æ¶ˆæ¯å¿…é¡»ä½¿ç”¨ TextMessage ç±»å‹</span></span><br></pre></td></tr></table></figure><h3 id="2ã€é”™è¯¯å¤„ç†ä¼˜åŒ–ï¼š"><a href="#2ã€é”™è¯¯å¤„ç†ä¼˜åŒ–ï¼š" class="headerlink" title="2ã€é”™è¯¯å¤„ç†ä¼˜åŒ–ï¼š"></a>2ã€é”™è¯¯å¤„ç†ä¼˜åŒ–ï¼š</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> err := conn.WriteMessage(websocket.TextMessage, []<span class="type">byte</span>(msg)); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">// è¯†åˆ«ç‰¹å®šé”™è¯¯ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span> websocket.IsCloseError(err, websocket.CloseNormalClosure) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;è¿æ¥å·²æ­£å¸¸å…³é—­&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®°å½•åŸå§‹é”™è¯¯æ—¥å¿—</span></span><br><span class="line">    log.Printf(<span class="string">&quot;WS_ERR: %v | æ¶ˆæ¯: %s&quot;</span>, err, msg) </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;æœåŠ¡ç¹å¿™ï¼Œè¯·é‡è¯•&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒºåˆ†è¿æ¥å…³é—­å’Œå‘é€å¤±è´¥åœºæ™¯</span></span><br><span class="line"><span class="comment">// ç”Ÿäº§ç¯å¢ƒå»ºè®®ç”¨ç»“æ„åŒ–æ—¥å¿—ï¼ˆå¦‚ JSON æ ¼å¼ï¼‰</span></span><br></pre></td></tr></table></figure><h2 id="æ¶ˆæ¯æ¨é€ï¼š"><a href="#æ¶ˆæ¯æ¨é€ï¼š" class="headerlink" title="æ¶ˆæ¯æ¨é€ï¼š"></a>æ¶ˆæ¯æ¨é€ï¼š</h2><h3 id="1ã€è®¾ç½®å­—ç¬¦ä¸²è¿”å›ç±»å‹"><a href="#1ã€è®¾ç½®å­—ç¬¦ä¸²è¿”å›ç±»å‹" class="headerlink" title="1ã€è®¾ç½®å­—ç¬¦ä¸²è¿”å›ç±»å‹"></a>1ã€è®¾ç½®å­—ç¬¦ä¸²è¿”å›ç±»å‹</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾msgæ˜¯å­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line">message := <span class="string">&quot;è¿™æ˜¯è¦è¿”å›çš„å­—ç¬¦ä¸²æ¶ˆæ¯&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åˆ‡ç‰‡</span></span><br><span class="line">msgBytes := []<span class="type">byte</span>(message)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€æ–‡æœ¬æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">if</span> err := conn.WriteMessage(websocket.TextMessage, msgBytes); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">    log.Println(<span class="string">&quot;å‘é€æ¶ˆæ¯å¤±è´¥:&quot;</span>, err)</span><br><span class="line">    <span class="comment">// å¯ä»¥é€‰æ‹©æ–­å¼€è¿æ¥æˆ–è¿›è¡Œå…¶ä»–å¤„ç†</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€è®¾ç½®JSONè¿”å›ç±»å‹"><a href="#2ã€è®¾ç½®JSONè¿”å›ç±»å‹" class="headerlink" title="2ã€è®¾ç½®JSONè¿”å›ç±»å‹"></a>2ã€è®¾ç½®<code>JSON</code>è¿”å›ç±»å‹</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Response <span class="keyword">struct</span> &#123;</span><br><span class="line">    Code <span class="type">int</span>    <span class="string">`json:&quot;code&quot;`</span></span><br><span class="line">    Data <span class="type">string</span> <span class="string">`json:&quot;data&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sendJSON</span><span class="params">(conn *websocket.Conn, msg <span class="type">string</span>)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">    resp := Response&#123;Code: <span class="number">200</span>, Data: msg&#125;</span><br><span class="line">    jsonData, _ := json.Marshal(resp)  <span class="comment">// åºåˆ—åŒ–ä¸º JSON</span></span><br><span class="line">    <span class="keyword">return</span> conn.WriteMessage(websocket.TextMessage, jsonData)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€-å¹¿æ’­æ¶ˆæ¯å®ç°"><a href="#3ã€-å¹¿æ’­æ¶ˆæ¯å®ç°" class="headerlink" title="3ã€ å¹¿æ’­æ¶ˆæ¯å®ç°"></a>3ã€ å¹¿æ’­æ¶ˆæ¯å®ç°</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> clients = <span class="built_in">make</span>(<span class="keyword">map</span>[*websocket.Conn]<span class="type">bool</span>) <span class="comment">// å…¨å±€è¿æ¥æ± </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">broadcast</span><span class="params">(msg <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> client := <span class="keyword">range</span> clients &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(c *websocket.Conn)</span></span> &#123; <span class="comment">// å¹¶å‘å‘é€é¿å…é˜»å¡</span></span><br><span class="line">            <span class="keyword">if</span> err := c.WriteMessage(websocket.TextMessage, []<span class="type">byte</span>(msg)); err != <span class="literal">nil</span> &#123;</span><br><span class="line">                <span class="built_in">delete</span>(clients, c) <span class="comment">// ç§»é™¤å¤±æ•ˆè¿æ¥</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;(client)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="âš ï¸-å…³é”®æ³¨æ„äº‹é¡¹"><a href="#âš ï¸-å…³é”®æ³¨æ„äº‹é¡¹" class="headerlink" title="âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹"></a>âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹</h3><ol><li><p><strong>å¹¶å‘å®‰å…¨</strong></p><ul><li>ä½¿ç”¨ <code>sync.Mutex</code> ä¿æŠ¤å…±äº«èµ„æºï¼ˆå¦‚ <code>clients</code> è¿æ¥æ± ï¼‰</li><li>é€šé“ä¼ é€’æ¶ˆæ¯é¿å…ç«æ€æ¡ä»¶ï¼š</li></ul><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Message <span class="keyword">struct</span> &#123;</span><br><span class="line">    Conn *websocket.Conn</span><br><span class="line">    Text <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line">msgChan := <span class="built_in">make</span>(<span class="keyword">chan</span> Message, <span class="number">100</span>) <span class="comment">// ç¼“å†²é˜Ÿåˆ—</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p><ul><li>å¤§æ¶ˆæ¯ï¼ˆ&gt; 64KBï¼‰å¯ç”¨åˆ†ç‰‡ä¼ è¾“ï¼š</li></ul><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">conn.SetWriteDeadline(time.Now().Add(<span class="number">10</span> * time.Second)) <span class="comment">// è®¾ç½®è¶…æ—¶</span></span><br><span class="line">writer, _ := conn.NextWriter(websocket.TextMessage)</span><br><span class="line">io.Copy(writer, bytes.NewReader(largeData)) <span class="comment">// æµå¼å†™å…¥</span></span><br><span class="line">writer.Close()</span><br></pre></td></tr></table></figure><ul><li>å¯ç”¨å‹ç¼©å‡å°‘å¸¦å®½ï¼š</li></ul><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">upgrader := websocket.Upgrader&#123;</span><br><span class="line">    EnableCompression: <span class="literal">true</span>, <span class="comment">// å¼€å¯å‹ç¼©</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>è¿æ¥ç”Ÿå‘½å‘¨æœŸ</strong></p><ul><li>å¿ƒè·³æœºåˆ¶ç»´æŒé•¿è¿æ¥ï¼š</li></ul><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">range</span> time.Tick(<span class="number">30</span> * time.Second) &#123;</span><br><span class="line">        <span class="keyword">if</span> err := conn.WriteMessage(websocket.PingMessage, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="comment">// å¿ƒè·³å¤±è´¥ç»ˆæ­¢è¿æ¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;GoLangçš„websocketç¼–ç¨‹&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/Golang/"/>
    
    <category term="websocket" scheme="https://kanoc.gitee.io/categories/Golang/websocket/"/>
    
    
    <category term="websocket" scheme="https://kanoc.gitee.io/tags/websocket/"/>
    
    <category term="Go" scheme="https://kanoc.gitee.io/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu-aptå®‰è£…ffmpegæœ€æ–°ç‰ˆ-ffmpeg6-or-ffmpeg7</title>
    <link href="https://kanoc.gitee.io/2025/06/04/Ubuntu-apt%E5%AE%89%E8%A3%85ffmpeg%E6%9C%80%E6%96%B0%E7%89%88-ffmpeg6-or-ffmpeg7/"/>
    <id>https://kanoc.gitee.io/2025/06/04/Ubuntu-apt%E5%AE%89%E8%A3%85ffmpeg%E6%9C%80%E6%96%B0%E7%89%88-ffmpeg6-or-ffmpeg7/</id>
    <published>2025-06-04T12:37:25.000Z</published>
    <updated>2025-06-10T01:06:07.985Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Ubuntuä½¿ç”¨<code>apt</code>å®‰è£…æœ€æ–°ç‰ˆæœ¬<code>FFmpeg</code></strong></font></p><span id="more"></span><h3 id="ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ppaæº"><a href="#ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ppaæº" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ppaæº"></a>ç¬¬ä¸€æ­¥ï¼šæ·»åŠ <code>ppa</code>æº</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># äºŒé€‰ä¸€ï¼Œé‡å¤ä½¿ç”¨ä¼šå‡ºç°è¦†ç›–</span></span><br><span class="line"><span class="built_in">sudo</span> add-apt-repository ppa:ubuntuhandbook1/ffmpeg7   <span class="comment"># ffmpeg7ç‰ˆæœ¬æº</span></span><br><span class="line"><span class="comment"># sudo add-apt-repository ppa:ubuntuhandbook1/ffmpeg6   # ffmpeg6ç‰ˆæœ¬æº</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒæ­¥ï¼šæ›´æ–°aptç¼“å­˜"><a href="#ç¬¬äºŒæ­¥ï¼šæ›´æ–°aptç¼“å­˜" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šæ›´æ–°aptç¼“å­˜"></a>ç¬¬äºŒæ­¥ï¼šæ›´æ–°<code>apt</code>ç¼“å­˜</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰æ­¥ï¼šå®‰è£…ffmpeg"><a href="#ç¬¬ä¸‰æ­¥ï¼šå®‰è£…ffmpeg" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šå®‰è£…ffmpeg"></a>ç¬¬ä¸‰æ­¥ï¼šå®‰è£…<code>ffmpeg</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install ffmpeg</span><br><span class="line"></span><br><span class="line"><span class="comment"># # å¦‚æœä¹‹å‰å®‰è£…è¿‡ ï¼šæ›´æ–°ffmpeg</span></span><br><span class="line"><span class="comment"># sudo apt upgrade ffmpeg    # æ›´æ–°å‘½ä»¤</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/06/04/kLrnaDMZRFsJQ75.jpg" alt="img"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Ubuntuä½¿ç”¨&lt;code&gt;apt&lt;/code&gt;å®‰è£…æœ€æ–°ç‰ˆæœ¬&lt;code&gt;FFmpeg&lt;/code&gt;&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="ubuntu" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/ubuntu/"/>
    
    
    <category term="docker" scheme="https://kanoc.gitee.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>curl_cffiè¯·æ±‚æŒ‡å—</title>
    <link href="https://kanoc.gitee.io/2025/05/27/curl-cffi%E8%AF%B7%E6%B1%82%E6%8C%87%E5%8D%97/"/>
    <id>https://kanoc.gitee.io/2025/05/27/curl-cffi%E8%AF%B7%E6%B1%82%E6%8C%87%E5%8D%97/</id>
    <published>2025-05-26T20:36:41.000Z</published>
    <updated>2025-06-10T01:11:53.358Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>curl_cffiè¯·æ±‚æŒ‡å—</strong></font></p><span id="more"></span><h3 id="Postæ–¹å¼ï¼šmultipart-form-data"><a href="#Postæ–¹å¼ï¼šmultipart-form-data" class="headerlink" title="Postæ–¹å¼ï¼šmultipart/form-data"></a>Postæ–¹å¼ï¼š<code>multipart/form-data</code></h3><p><code>&quot;Content-Type&quot;:&quot;multipart/form-data&quot;</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> curl_cffi <span class="keyword">import</span> requests, CurlMime</span><br><span class="line">mp = CurlMime()  <span class="comment"># è¯¥ç±»æ˜¯ curl_cffiçš„ä¸Šä¼ æ–‡ä»¶ç±»</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.2.3:8080/upload&quot;</span>  <span class="comment"># è¯·æ±‚åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡æœ¬å†…å®¹ json</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&#x27;save_path&#x27;</span>: <span class="string">&#x27;/data/mp4_file/test3&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;md5&#x27;</span>: <span class="string">&#x27;4b9975069087e0f0f9e13bf4111b7a03&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/Users/kama/æ°´3.mp4&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ–‡ä»¶åˆ° multiple</span></span><br><span class="line">mp.addpart(</span><br><span class="line">    name=<span class="string">&quot;file&quot;</span>,</span><br><span class="line">    content_type=<span class="string">&quot;application/octet-stream&quot;</span>,</span><br><span class="line">    filename=<span class="string">&quot;æ°´3.mp4&quot;</span>,</span><br><span class="line">    data=data,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å§‹å‘é€è¯·æ±‚</span></span><br><span class="line">response = requests.post(url, data=payload, multipart=mp, impersonate=<span class="string">&quot;chrome120&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;curl_cffiè¯·æ±‚æŒ‡å—&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Python" scheme="https://kanoc.gitee.io/categories/Python/"/>
    
    <category term="çˆ¬è™«" scheme="https://kanoc.gitee.io/categories/Python/%E7%88%AC%E8%99%AB/"/>
    
    <category term="Postè¯·æ±‚" scheme="https://kanoc.gitee.io/categories/Python/%E7%88%AC%E8%99%AB/Post%E8%AF%B7%E6%B1%82/"/>
    
    
    <category term="request" scheme="https://kanoc.gitee.io/tags/request/"/>
    
    <category term="è¯·æ±‚ç¤ºä¾‹" scheme="https://kanoc.gitee.io/tags/%E8%AF%B7%E6%B1%82%E7%A4%BA%E4%BE%8B/"/>
    
    <category term="æŒ‡å—" scheme="https://kanoc.gitee.io/tags/%E6%8C%87%E5%8D%97/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntué…ç½®å®‰è£…GPUè½¬ç </title>
    <link href="https://kanoc.gitee.io/2025/05/26/Ubuntu%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85GPU%E8%BD%AC%E7%A0%81/"/>
    <id>https://kanoc.gitee.io/2025/05/26/Ubuntu%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85GPU%E8%BD%AC%E7%A0%81/</id>
    <published>2025-05-26T14:07:58.000Z</published>
    <updated>2025-06-10T01:07:50.100Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Ubuntué…ç½®å®‰è£…GPUè½¬ç </strong></font></p><span id="more"></span><h2 id="ubuntu-æµ‹è¯•ä½¿ç”¨-GPU-ffmpeg-è½¬ç è§†é¢‘"><a href="#ubuntu-æµ‹è¯•ä½¿ç”¨-GPU-ffmpeg-è½¬ç è§†é¢‘" class="headerlink" title="ubuntu æµ‹è¯•ä½¿ç”¨ GPU-ffmpeg è½¬ç è§†é¢‘"></a>ubuntu æµ‹è¯•ä½¿ç”¨ GPU-ffmpeg è½¬ç è§†é¢‘</h2><h3 id="é¢å¤–å‘½ä»¤ï¼š"><a href="#é¢å¤–å‘½ä»¤ï¼š" class="headerlink" title="é¢å¤–å‘½ä»¤ï¼š"></a>é¢å¤–å‘½ä»¤ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lsb_release -a   <span class="comment"># æŸ¥çœ‹å‘è¡Œç‰ˆæœ¬åŠä»£å·</span></span><br><span class="line">lspci | grep -i vga   <span class="comment"># æŸ¥çœ‹æ˜¯å¦å­˜åœ¨gpu</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸€æ­¥ï¼šå®‰è£…ffmpeg"><a href="#ç¬¬ä¸€æ­¥ï¼šå®‰è£…ffmpeg" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå®‰è£…ffmpeg"></a>ç¬¬ä¸€æ­¥ï¼šå®‰è£…ffmpeg</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt install ffmpeg</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒæ­¥ï¼š1-å®‰è£…-NVIDIA-é©±åŠ¨"><a href="#ç¬¬äºŒæ­¥ï¼š1-å®‰è£…-NVIDIA-é©±åŠ¨" class="headerlink" title="ç¬¬äºŒæ­¥ï¼š1. å®‰è£… NVIDIA é©±åŠ¨"></a>ç¬¬äºŒæ­¥ï¼š<strong>1. å®‰è£… NVIDIA é©±åŠ¨</strong></h3><h4 id="1-æ·»åŠ å®˜æ–¹é©±åŠ¨ä»“åº“å¹¶æ›´æ–°"><a href="#1-æ·»åŠ å®˜æ–¹é©±åŠ¨ä»“åº“å¹¶æ›´æ–°" class="headerlink" title="(1) æ·»åŠ å®˜æ–¹é©±åŠ¨ä»“åº“å¹¶æ›´æ–°"></a>(1) æ·»åŠ å®˜æ–¹é©±åŠ¨ä»“åº“å¹¶æ›´æ–°</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> add-apt-repository ppa:graphics-drivers/ppa</span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br></pre></td></tr></table></figure><h4 id="2-æŸ¥çœ‹æ¨èé©±åŠ¨ç‰ˆæœ¬"><a href="#2-æŸ¥çœ‹æ¨èé©±åŠ¨ç‰ˆæœ¬" class="headerlink" title="(2) æŸ¥çœ‹æ¨èé©±åŠ¨ç‰ˆæœ¬"></a>(2) æŸ¥çœ‹æ¨èé©±åŠ¨ç‰ˆæœ¬</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ubuntu-drivers devices</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">== /sys/devices/pci0000:00/0000:00:02.0/0000:03:00.0 ==</span><br><span class="line">modalias : pci:v000010DEd00001C82sv000010DEsd00001C82bc03sc00i00</span><br><span class="line">vendor   : NVIDIA Corporation</span><br><span class="line">model    : GP107 [GeForce GTX 1050 Ti]</span><br><span class="line">driver   : nvidia-driver-570-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-550 - distro non-free</span><br><span class="line">driver   : nvidia-driver-418-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-570 - distro non-free recommended</span><br><span class="line">driver   : nvidia-driver-545 - distro non-free</span><br><span class="line">driver   : nvidia-driver-535-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-535 - distro non-free</span><br><span class="line">driver   : nvidia-driver-450-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-390 - distro non-free</span><br><span class="line">driver   : nvidia-driver-470 - distro non-free</span><br><span class="line">driver   : nvidia-driver-470-server - distro non-free</span><br><span class="line">driver   : xserver-xorg-video-nouveau - distro free <span class="built_in">builtin</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3-å®‰è£…æ¨èçš„é©±åŠ¨ï¼ˆå¦‚-570-ç‰ˆæœ¬ï¼‰"><a href="#3-å®‰è£…æ¨èçš„é©±åŠ¨ï¼ˆå¦‚-570-ç‰ˆæœ¬ï¼‰" class="headerlink" title="(3) å®‰è£…æ¨èçš„é©±åŠ¨ï¼ˆå¦‚ 570 ç‰ˆæœ¬ï¼‰"></a>(3) å®‰è£…æ¨èçš„é©±åŠ¨ï¼ˆå¦‚ 570 ç‰ˆæœ¬ï¼‰</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install nvidia-driver-570</span><br></pre></td></tr></table></figure><h4 id="4-é‡å¯ç³»ç»Ÿ"><a href="#4-é‡å¯ç³»ç»Ÿ" class="headerlink" title="(4) é‡å¯ç³»ç»Ÿ"></a>(4) é‡å¯ç³»ç»Ÿ</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> reboot</span><br></pre></td></tr></table></figure><h4 id="5-éªŒè¯é©±åŠ¨"><a href="#5-éªŒè¯é©±åŠ¨" class="headerlink" title="(5) éªŒè¯é©±åŠ¨"></a>(5) éªŒè¯é©±åŠ¨</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure><p>æ­£å¸¸è¾“å‡ºåº”æ˜¾ç¤º GPU çŠ¶æ€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+---------------------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 535.161.07   Driver Version: 535.161.07   CUDA Version: 12.2     |</span><br><span class="line">|-----------------------------------------+----------------------+----------------------+</span><br><span class="line">| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|=========================================+======================+======================|</span><br><span class="line">|   0  NVIDIA GeForce GTX 1050 Ti    Off  | 00000000:03:00.0 Off |                  N/A |</span><br><span class="line">| 30%   35C    P8              N/A /  75W |      0MiB /  4096MiB |      0%      Default |</span><br><span class="line">+-----------------------------------------+----------------------+----------------------+</span><br></pre></td></tr></table></figure><hr><h3 id="ç¬¬ä¸‰æ­¥ï¼š-å®‰è£…-CUDA-å·¥å…·åŒ…ï¼ˆå¯é€‰ï¼‰"><a href="#ç¬¬ä¸‰æ­¥ï¼š-å®‰è£…-CUDA-å·¥å…·åŒ…ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼š å®‰è£… CUDA å·¥å…·åŒ…ï¼ˆå¯é€‰ï¼‰"></a><strong>ç¬¬ä¸‰æ­¥ï¼š å®‰è£… CUDA å·¥å…·åŒ…ï¼ˆå¯é€‰ï¼‰</strong></h3><p>å¦‚æœéœ€å¼€å‘ GPU è®¡ç®—åº”ç”¨ï¼ˆå¦‚ AIã€æ·±åº¦å­¦ä¹ ï¼‰ï¼Œå®‰è£… CUDAï¼š</p><h4 id="1-è®¿é—®-CUDA-Toolkit-Archive-é€‰æ‹©ç‰ˆæœ¬ï¼ˆæ¨è-CUDA-11-8-æˆ–-12-xï¼‰"><a href="#1-è®¿é—®-CUDA-Toolkit-Archive-é€‰æ‹©ç‰ˆæœ¬ï¼ˆæ¨è-CUDA-11-8-æˆ–-12-xï¼‰" class="headerlink" title="(1) è®¿é—® CUDA Toolkit Archive é€‰æ‹©ç‰ˆæœ¬ï¼ˆæ¨è CUDA 11.8 æˆ– 12.xï¼‰"></a>(1) è®¿é—® <a href="https://developer.nvidia.com/cuda-toolkit-archive">CUDA Toolkit Archive</a> é€‰æ‹©ç‰ˆæœ¬ï¼ˆæ¨è CUDA 11.8 æˆ– 12.xï¼‰</h4><h4 id="2-é€šè¿‡å‘½ä»¤è¡Œå®‰è£…ï¼ˆä»¥-CUDA-12-2-ä¸ºä¾‹ï¼‰"><a href="#2-é€šè¿‡å‘½ä»¤è¡Œå®‰è£…ï¼ˆä»¥-CUDA-12-2-ä¸ºä¾‹ï¼‰" class="headerlink" title="(2) é€šè¿‡å‘½ä»¤è¡Œå®‰è£…ï¼ˆä»¥ CUDA 12.2 ä¸ºä¾‹ï¼‰"></a>(2) é€šè¿‡å‘½ä»¤è¡Œå®‰è£…ï¼ˆä»¥ CUDA 12.2 ä¸ºä¾‹ï¼‰</h4><ul><li>è¯¥å‘½ä»¤éœ€è¦å»è‹±ä¼Ÿè¾¾å®˜ç½‘å®æ—¶ç”Ÿæˆï¼š<a href="https://developer.nvidia.com/cuda-downloads?target_os=Linux&target_arch=x86_64&Distribution=Ubuntu&target_version=22.04&target_type=deb_local">CUDA Toolkit 12.9 Downloads | NVIDIA Developer</a></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-ubuntu2204.pin</span><br><span class="line">sudo mv cuda-ubuntu2204.pin /etc/apt/preferences.d/cuda-repository-pin-600</span><br><span class="line">wget https://developer.download.nvidia.com/compute/cuda/12.9.0/local_installers/cuda-repo-ubuntu2204-12-9-local_12.9.0-575.51.03-1_amd64.deb</span><br><span class="line">sudo dpkg -i cuda-repo-ubuntu2204-12-9-local_12.9.0-575.51.03-1_amd64.deb</span><br><span class="line">sudo cp /var/cuda-repo-ubuntu2204-12-9-local/cuda-*-keyring.gpg /usr/share/keyrings/</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get -y install cuda-toolkit-12-9</span><br></pre></td></tr></table></figure><h4 id="3-æ·»åŠ å˜é‡"><a href="#3-æ·»åŠ å˜é‡" class="headerlink" title="(3) æ·»åŠ å˜é‡"></a>(3) æ·»åŠ å˜é‡</h4><p>è™½ç„¶ç³»ç»Ÿæ˜¾ç¤º <code>cuda-toolkit-12-9</code> å·²å®‰è£…ï¼Œä½† <code>nvcc</code> çš„è·¯å¾„æœªæ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ã€‚æ­¤æ—¶éœ€è¦æ‰‹åŠ¨å°† CUDA çš„äºŒè¿›åˆ¶ç›®å½•åŠ å…¥ <code>PATH</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/local/cuda/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><h4 id="4-éªŒè¯-CUDA"><a href="#4-éªŒè¯-CUDA" class="headerlink" title="(4) éªŒè¯ CUDA"></a>(4) éªŒè¯ CUDA</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvcc --version</span><br></pre></td></tr></table></figure><p>æ­£å¸¸è¾“å‡ºåº”æ˜¾ç¤º CUDA ç‰ˆæœ¬ã€‚</p><h3 id="ç¬¬å››æ­¥ï¼š-éªŒè¯-GPU-åŠ é€Ÿæ˜¯å¦ç”Ÿæ•ˆ"><a href="#ç¬¬å››æ­¥ï¼š-éªŒè¯-GPU-åŠ é€Ÿæ˜¯å¦ç”Ÿæ•ˆ" class="headerlink" title="ç¬¬å››æ­¥ï¼š éªŒè¯ GPU åŠ é€Ÿæ˜¯å¦ç”Ÿæ•ˆ"></a><strong>ç¬¬å››æ­¥ï¼š éªŒè¯ GPU åŠ é€Ÿæ˜¯å¦ç”Ÿæ•ˆ</strong></h3><h4 id="1ã€æ£€æŸ¥ç¼–ç å™¨"><a href="#1ã€æ£€æŸ¥ç¼–ç å™¨" class="headerlink" title="1ã€æ£€æŸ¥ç¼–ç å™¨"></a>1ã€æ£€æŸ¥ç¼–ç å™¨</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -encoders | grep nvenc</span><br><span class="line"><span class="comment"># åº”è¾“å‡ºåŒ…å« h264_nvenc çš„è¡Œ</span></span><br></pre></td></tr></table></figure><p>æ­£å¸¸è¾“å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@R7-13:~# ffmpeg -encoders | grep nvenc</span><br><span class="line">ffmpeg version 4.4.2-0ubuntu0.22.04.1 Copyright (c) 2000-2021 the FFmpeg developers</span><br><span class="line">  built with gcc 11 (Ubuntu 11.2.0-19ubuntu1)</span><br><span class="line">  configuration: --prefix=/usr --extra-version=0ubuntu0.22.04.1 --toolchain=hardened --libdir=/usr/lib/x86_64-linux-gnu --incdir=/usr/include/x86_64-linux-gnu --<span class="built_in">arch</span>=amd64 --enable-gpl --disable-stripping --enable-gnutls --enable-ladspa --enable-libaom --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libcodec2 --enable-libdav1d --enable-libflite --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-libgme --enable-libgsm --enable-libjack --enable-libmp3lame --enable-libmysofa --enable-libopenjpeg --enable-libopenmpt --enable-libopus --enable-libpulse --enable-librabbitmq --enable-librubberband --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libspeex --enable-libsrt --enable-libssh --enable-libtheora --enable-libtwolame --enable-libvidstab --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx265 --enable-libxml2 --enable-libxvid --enable-libzimg --enable-libzmq --enable-libzvbi --enable-lv2 --enable-omx --enable-openal --enable-opencl --enable-opengl --enable-sdl2 --enable-pocketsphinx --enable-librsvg --enable-libmfx --enable-libdc1394 --enable-libdrm --enable-libiec61883 --enable-chromaprint --enable-frei0r --enable-libx264 --enable-shared</span><br><span class="line">  libavutil      56. 70.100 / 56. 70.100</span><br><span class="line">  libavcodec     58.134.100 / 58.134.100</span><br><span class="line">  libavformat    58. 76.100 / 58. 76.100</span><br><span class="line">  libavdevice    58. 13.100 / 58. 13.100</span><br><span class="line">  libavfilter     7.110.100 /  7.110.100</span><br><span class="line">  libswscale      5.  9.100 /  5.  9.100</span><br><span class="line">  libswresample   3.  9.100 /  3.  9.100</span><br><span class="line">  libpostproc    55.  9.100 / 55.  9.100</span><br><span class="line"> V....D h264_nvenc           NVIDIA NVENC H.264 encoder (codec h264)</span><br><span class="line"> V..... nvenc                NVIDIA NVENC H.264 encoder (codec h264)</span><br><span class="line"> V..... nvenc_h264           NVIDIA NVENC H.264 encoder (codec h264)</span><br><span class="line"> V..... nvenc_hevc           NVIDIA NVENC hevc encoder (codec hevc)</span><br><span class="line"> V....D hevc_nvenc           NVIDIA NVENC hevc encoder (codec hevc)</span><br></pre></td></tr></table></figure><h4 id="2ã€ç›‘æ§-GPU-ä½¿ç”¨æƒ…å†µ"><a href="#2ã€ç›‘æ§-GPU-ä½¿ç”¨æƒ…å†µ" class="headerlink" title="2ã€ç›‘æ§ GPU ä½¿ç”¨æƒ…å†µ"></a>2ã€ç›‘æ§ GPU ä½¿ç”¨æƒ…å†µ</h4><h5 id="2-1ã€nvidia-smi-watch-ç»„åˆå‘½ä»¤"><a href="#2-1ã€nvidia-smi-watch-ç»„åˆå‘½ä»¤" class="headerlink" title="2.1ã€nvidia-smi + watch ç»„åˆå‘½ä»¤*"></a>2.1ã€<code>nvidia-smi</code> + <code>watch</code> ç»„åˆå‘½ä»¤*</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¯ç§’åˆ·æ–°ä¸€æ¬¡ GPU çŠ¶æ€ï¼Œé€‚åˆå¿«é€ŸæŸ¥çœ‹æ ¸å¿ƒåˆ©ç”¨ç‡ã€æ˜¾å­˜å ç”¨å’Œæ¸©åº¦</span></span><br><span class="line">watch -n 1 nvidia-smi  <span class="comment"># Linux/macOS</span></span><br></pre></td></tr></table></figure><p>windows æ–¹æ¡ˆï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="variable">$true</span>) &#123; nvidia-smi; Start-Sleep -Milliseconds 500 &#125;</span><br></pre></td></tr></table></figure><h5 id="2-2ã€nvtopï¼ˆç±»-htop-å·¥å…·ï¼‰"><a href="#2-2ã€nvtopï¼ˆç±»-htop-å·¥å…·ï¼‰" class="headerlink" title="2.2ã€nvtopï¼ˆç±» htop å·¥å…·ï¼‰"></a>2.2ã€<strong><code>nvtop</code>ï¼ˆç±» htop å·¥å…·ï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”¯æŒäº¤äº’å¼æ“ä½œå’ŒåŠ¨æ€æ’åºï¼Œé€‚åˆå¤š GPU æœåŠ¡å™¨</span></span><br><span class="line"><span class="built_in">sudo</span> apt install nvtop  <span class="comment"># Ubuntu/Debian</span></span><br><span class="line">nvtop</span><br></pre></td></tr></table></figure><h2 id="ç¬¬å››æ­¥ï¼šä½¿ç”¨GPUè½¬ç "><a href="#ç¬¬å››æ­¥ï¼šä½¿ç”¨GPUè½¬ç " class="headerlink" title="ç¬¬å››æ­¥ï¼šä½¿ç”¨GPUè½¬ç "></a>ç¬¬å››æ­¥ï¼šä½¿ç”¨GPUè½¬ç </h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœ¬åœ°æ–‡ä»¶è½¬ç </span></span><br><span class="line">ffmpeg -nostats -loglevel warning -hwaccel cuda -i ace.mp4 -vf <span class="string">&quot;scale=720:1270,setsar=1/1&quot;</span> -c:v h264_nvenc -preset p3 -rc vbr -b:v 0 -cq 23 -multipass fullres -tune hq -c:a aac -r 30 -y 3.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¦è¯·æ±‚å¤´</span></span><br><span class="line">ffmpeg -nostats -loglevel warning -hwaccel cuda -headers <span class="string">&quot;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36\r\nReferer: https://exx.tv/\r\n&quot;</span> -i <span class="string">&quot;https://xxx.m3u8&quot;</span> -vf <span class="string">&quot;scale=720:1270,setsar=1/1&quot;</span> -c:v h264_nvenc -preset p3 -rc vbr -b:v 0 -cq 23 -multipass fullres -tune hq -c:a aac -r 30 -y 3.mp4</span><br></pre></td></tr></table></figure><h4 id="å‘½ä»¤è¯¦è§£ï¼š"><a href="#å‘½ä»¤è¯¦è§£ï¼š" class="headerlink" title="å‘½ä»¤è¯¦è§£ï¼š"></a>å‘½ä»¤è¯¦è§£ï¼š</h4><h5 id="åŸºç¡€å‚æ•°"><a href="#åŸºç¡€å‚æ•°" class="headerlink" title="åŸºç¡€å‚æ•°"></a><strong>åŸºç¡€å‚æ•°</strong></h5><ol><li><strong><code>-nostats</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šç¦ç”¨ç¼–ç ç»Ÿè®¡ä¿¡æ¯çš„è¾“å‡ºã€‚</li><li><strong>è¯´æ˜</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒFFmpeg ä¼šå®æ—¶æ˜¾ç¤ºæ¯”ç‰¹ç‡ã€å¸§æ•°ç­‰ç»Ÿè®¡ä¿¡æ¯ï¼Œæ­¤å‚æ•°å¯å‡å°‘è¾“å‡ºå¹²æ‰°ã€‚</li></ul></li><li><strong><code>-loglevel warning</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šè®¾ç½®æ—¥å¿—çº§åˆ«ä¸º <code>warning</code>ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šä»…æ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ï¼ŒæŠ‘åˆ¶å†—ä½™æ—¥å¿—ï¼Œä½¿è¾“å‡ºæ›´ç®€æ´ã€‚</li></ul></li><li><strong><code>-hwaccel cuda</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šå¯ç”¨ NVIDIA CUDA ç¡¬ä»¶åŠ é€Ÿè§£ç ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šåˆ©ç”¨ GPU åŠ é€Ÿè§†é¢‘è§£ç æµç¨‹ï¼Œæå‡å¤„ç†é€Ÿåº¦ã€‚</li></ul></li><li><strong><code>-i ace.mp4</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šæŒ‡å®šè¾“å…¥æ–‡ä»¶ä¸º <code>ace.mp4</code>ã€‚</li></ul></li></ol><hr><h5 id="è§†é¢‘å¤„ç†å‚æ•°"><a href="#è§†é¢‘å¤„ç†å‚æ•°" class="headerlink" title="è§†é¢‘å¤„ç†å‚æ•°"></a><strong>è§†é¢‘å¤„ç†å‚æ•°</strong></h5><ol><li><strong><code>-vf &quot;scale=720:1270,setsar=1/1&quot;</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šåº”ç”¨è§†é¢‘æ»¤é•œé“¾ã€‚<ul><li><strong><code>scale=720:1270</code></strong>ï¼šå°†è§†é¢‘ç¼©æ”¾è‡³ <code>720x1270</code> åˆ†è¾¨ç‡ï¼ˆæ³¨æ„å®½é«˜æ¯”å¯èƒ½è¢«æ”¹å˜ï¼‰ã€‚</li><li><strong><code>setsar=1/1</code></strong>ï¼šè®¾ç½®åƒç´ å®½é«˜æ¯”ï¼ˆSample Aspect Ratioï¼‰ä¸º 1:1ï¼Œç¡®ä¿æ–¹å½¢åƒç´ æ˜¾ç¤ºã€‚</li></ul></li><li><strong>è¯´æ˜</strong>ï¼šè°ƒæ•´åˆ†è¾¨ç‡åéœ€ä¿®æ­£å®½é«˜æ¯”ï¼Œé¿å…æ’­æ”¾æ—¶å˜å½¢ã€‚</li></ul></li></ol><hr><h5 id="è§†é¢‘ç¼–ç å‚æ•°"><a href="#è§†é¢‘ç¼–ç å‚æ•°" class="headerlink" title="è§†é¢‘ç¼–ç å‚æ•°"></a><strong>è§†é¢‘ç¼–ç å‚æ•°</strong></h5><ol><li><strong><code>-c:v h264_nvenc</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šä½¿ç”¨ NVIDIA NVENC ç¡¬ä»¶ç¼–ç å™¨ç”Ÿæˆ H.264 è§†é¢‘æµã€‚</li><li><strong>è¯´æ˜</strong>ï¼šç›¸æ¯” CPU ç¼–ç ï¼ˆå¦‚ <code>libx264</code>ï¼‰ï¼Œç¡¬ä»¶ç¼–ç é€Ÿåº¦æ›´å¿«ï¼Œä½†å‹ç¼©æ•ˆç‡ç•¥ä½ã€‚</li></ul></li><li><strong><code>-preset p3</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šè®¾ç½®ç¼–ç å™¨é¢„è®¾ä¸º <code>p3</code>ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šNVENC é¢„è®¾èŒƒå›´ <code>p1</code>ï¼ˆæœ€å¿«ï¼‰åˆ° <code>p7</code>ï¼ˆæœ€æ…¢ä½†è´¨é‡æ›´å¥½ï¼‰ï¼Œ<code>p3</code> å¹³è¡¡é€Ÿåº¦ä¸è´¨é‡ã€‚</li></ul></li><li><strong><code>-rc vbr</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šä½¿ç”¨å¯å˜æ¯”ç‰¹ç‡ï¼ˆVariable Bitrateï¼‰æ§åˆ¶æ¨¡å¼ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šVBR æ ¹æ®å†…å®¹å¤æ‚åº¦åŠ¨æ€åˆ†é…ç ç‡ï¼Œç›¸æ¯” CBRï¼ˆæ’å®šç ç‡ï¼‰æ›´èŠ‚çœå­˜å‚¨ã€‚</li></ul></li><li><strong><code>-b:v 0</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šå°†è§†é¢‘ç›®æ ‡æ¯”ç‰¹ç‡è®¾ä¸º <code>0</code>ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šåœ¨ <code>-rc vbr</code> + <code>-cq</code> æ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°è¡¨ç¤ºç”±è´¨é‡å‚æ•°ï¼ˆ<code>-cq</code>ï¼‰ä¸»å¯¼ç ç‡åˆ†é…ã€‚</li></ul></li><li><strong><code>-cq 23</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šè®¾ç½®æ’å®šè´¨é‡æ¨¡å¼çš„è´¨é‡å€¼ä¸º <code>23</code>ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šNVENC çš„ <code>cq</code> èŒƒå›´é€šå¸¸ä¸º <code>0</code>ï¼ˆæ— æŸï¼‰åˆ° <code>51</code>ï¼ˆæœ€å·®ï¼‰ï¼Œ<code>23</code> æ˜¯å¸¸è§é«˜è´¨é‡é€‰æ‹©ã€‚</li></ul></li><li><strong><code>-multipass fullres</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šå¯ç”¨ä¸¤è¶Ÿç¼–ç ï¼ˆTwo-Pass Encodingï¼‰ï¼Œä½¿ç”¨å…¨åˆ†è¾¨ç‡åˆ†æã€‚</li><li><strong>è¯´æ˜</strong>ï¼šé¦–è¶Ÿåˆ†æè§†é¢‘å†…å®¹ï¼Œæ¬¡è¶Ÿä¼˜åŒ–ç ç‡åˆ†é…ï¼Œæå‡å‹ç¼©æ•ˆç‡ï¼ˆéœ€æ›´é«˜è®¡ç®—èµ„æºï¼‰ã€‚</li></ul></li><li><strong><code>-tune hq</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šä¼˜åŒ–ç¼–ç å‚æ•°ä»¥è¿½æ±‚é«˜è´¨é‡ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šé€‚ç”¨äºå¯¹ç”»è´¨è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œå¯èƒ½ç‰ºç‰²éƒ¨åˆ†ç¼–ç é€Ÿåº¦ã€‚</li></ul></li></ol><hr><h5 id="éŸ³é¢‘ä¸å¸§ç‡å‚æ•°"><a href="#éŸ³é¢‘ä¸å¸§ç‡å‚æ•°" class="headerlink" title="éŸ³é¢‘ä¸å¸§ç‡å‚æ•°"></a><strong>éŸ³é¢‘ä¸å¸§ç‡å‚æ•°</strong></h5><ol><li><strong><code>-c:a aac</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šä½¿ç”¨ AAC ç¼–ç å™¨å‹ç¼©éŸ³é¢‘æµã€‚</li><li><strong>è¯´æ˜</strong>ï¼šAAC æ˜¯é€šç”¨éŸ³é¢‘æ ¼å¼ï¼Œå¹³è¡¡éŸ³è´¨ä¸æ–‡ä»¶å¤§å°ã€‚</li></ul></li><li><strong><code>-r 30</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šå¼ºåˆ¶è¾“å‡ºè§†é¢‘å¸§ç‡ä¸º <code>30 FPS</code>ã€‚</li><li><strong>è¯´æ˜</strong>ï¼šè‹¥è¾“å…¥å¸§ç‡ä¸ä¸€è‡´ï¼ŒFFmpeg ä¼šé€šè¿‡ä¸¢å¸§æˆ–æ’å¸§é€‚é…ã€‚</li></ul></li></ol><hr><h5 id="å…¶ä»–å‚æ•°"><a href="#å…¶ä»–å‚æ•°" class="headerlink" title="å…¶ä»–å‚æ•°"></a><strong>å…¶ä»–å‚æ•°</strong></h5><ol><li><strong><code>-y</code></strong><ul><li><strong>åŠŸèƒ½</strong>ï¼šè‡ªåŠ¨è¦†ç›–è¾“å‡ºæ–‡ä»¶ï¼ˆ<code>3.mp4</code>ï¼‰ï¼Œæ— éœ€ç”¨æˆ·ç¡®è®¤ã€‚</li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Ubuntué…ç½®å®‰è£…GPUè½¬ç &lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="ubuntu" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/ubuntu/"/>
    
    
    <category term="è½¬ç " scheme="https://kanoc.gitee.io/tags/%E8%BD%AC%E7%A0%81/"/>
    
    <category term="gpu" scheme="https://kanoc.gitee.io/tags/gpu/"/>
    
    <category term="NVIDIA" scheme="https://kanoc.gitee.io/tags/NVIDIA/"/>
    
  </entry>
  
  <entry>
    <title>goäº¤å‰ç¼–è¯‘é”™è¯¯:sqliteæ•°æ®åº“</title>
    <link href="https://kanoc.gitee.io/2025/05/26/go%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E9%94%99%E8%AF%AF-sqlite%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <id>https://kanoc.gitee.io/2025/05/26/go%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E9%94%99%E8%AF%AF-sqlite%E6%95%B0%E6%8D%AE%E5%BA%93/</id>
    <published>2025-05-26T01:18:39.000Z</published>
    <updated>2025-06-09T10:40:26.730Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>goäº¤å‰ç¼–è¯‘é”™è¯¯:sqliteæ•°æ®åº“ï¼š</strong></font></p><span id="more"></span><p><font color=#f26522 size=4 face=å®‹ä½“><strong>é”™è¯¯å†…å®¹ï¼š</strong></font></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; CGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build -o SaveVideo</span><br><span class="line"># runtime/cgo</span><br><span class="line">linux_syscall.c:67:13: error: call to undeclared function &#x27;setresgid&#x27;; ISO C99 and later do not support implicit function declarations [-Wimplicit-function-declaration]</span><br><span class="line">linux_syscall.c:67:13: note: did you mean &#x27;setregid&#x27;?</span><br><span class="line">/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/unistd.h:593:6: note: &#x27;setregid&#x27; declared here</span><br><span class="line">linux_syscall.c:73:13: error: call to undeclared function &#x27;setresuid&#x27;; ISO C99 and later do not support implicit function declarations [-Wimplicit-function-declaration]</span><br><span class="line">linux_syscall.c:73:13: note: did you mean &#x27;setreuid&#x27;?</span><br><span class="line">/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/unistd.h:595:6: note: &#x27;setreuid&#x27; declared here</span><br></pre></td></tr></table></figure><p><font color=#f26522 size=5 face=å®‹ä½“><strong>é”™è¯¯è¯´æ˜ï¼š</strong></font></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å—¯ï¼Œç”¨æˆ·é‡åˆ°äº†åœ¨MacOSä¸Šäº¤å‰ç¼–è¯‘åˆ°Linuxæ—¶å‡ºç°çš„CGOé”™è¯¯ã€‚é”™è¯¯ä¿¡æ¯æŒ‡å‡º`setresgid`å’Œ`setresuid`å‡½æ•°æœªå£°æ˜ï¼Œè€Œç³»ç»Ÿå¤´æ–‡ä»¶é‡Œåªæœ‰`setregid`å’Œ`setreuid`ã€‚æˆ‘éœ€è¦ä»”ç»†åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œæ‰¾åˆ°æ ¹æœ¬åŸå› ï¼Œå¹¶æä¾›æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</span><br><span class="line"></span><br><span class="line">é¦–å…ˆï¼Œç”¨æˆ·ä½¿ç”¨çš„å‘½ä»¤æ˜¯`CGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build -o SaveVideo`ã€‚ä»–ä»¬å¯ç”¨äº†CGOï¼Œå¹¶ä¸”å°è¯•äº¤å‰ç¼–è¯‘åˆ°Linuxçš„amd64æ¶æ„ã€‚é”™è¯¯æ¥è‡ªCä»£ç ä¸­çš„å‡½æ•°è°ƒç”¨ï¼Œè¯´æ˜åœ¨äº¤å‰ç¼–è¯‘æ—¶ï¼ŒMacOSçš„æœ¬åœ°Cç¼–è¯‘å™¨ï¼ˆå¯èƒ½æ˜¯clangï¼‰åœ¨å°è¯•ç¼–è¯‘é’ˆå¯¹Linuxçš„Cä»£ç æ—¶æ‰¾ä¸åˆ°è¿™äº›å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦ç¡®è®¤`setresgid`å’Œ`setresuid`åœ¨Linuxä¸­çš„æƒ…å†µã€‚è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯Linuxç‰¹æœ‰çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºè®¾ç½®çœŸå®ã€æœ‰æ•ˆå’Œä¿å­˜çš„ç»„IDå’Œç”¨æˆ·IDã€‚åœ¨MacOSçš„æ ‡å‡†åº“ä¸­ï¼Œå¹¶æ²¡æœ‰è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯`setregid`å’Œ`setreuid`ï¼Œè¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆç¼–è¯‘å™¨ä¼šæç¤ºå‡½æ•°æœªå£°æ˜ã€‚</span><br><span class="line"></span><br><span class="line">å¯èƒ½çš„åŸå› æ˜¯ï¼Œäº¤å‰ç¼–è¯‘æ—¶ä½¿ç”¨çš„Cç¼–è¯‘å™¨ï¼ˆæ¯”å¦‚MacOSè‡ªå¸¦çš„clangï¼‰é»˜è®¤é“¾æ¥äº†MacOSçš„ç³»ç»Ÿå¤´æ–‡ä»¶ï¼Œè€Œè¿™äº›å¤´æ–‡ä»¶é‡Œæ²¡æœ‰Linuxç‰¹å®šçš„å‡½æ•°å£°æ˜ã€‚å› æ­¤ï¼Œå½“äº¤å‰ç¼–è¯‘åˆ°Linuxæ—¶ï¼Œéœ€è¦ç¡®ä¿ä½¿ç”¨é€‚åˆç›®æ ‡å¹³å°çš„Cåº“å’Œå¤´æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆæ–¹é¢ï¼Œç”¨æˆ·éœ€è¦å®‰è£…ä¸€ä¸ªé’ˆå¯¹Linuxçš„Cäº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼Œæ¯”å¦‚muslå·¥å…·é“¾ï¼Œè¿™æ ·åœ¨ç¼–è¯‘æ—¶å¯ä»¥ä½¿ç”¨Linuxå…¼å®¹çš„å¤´æ–‡ä»¶å’Œåº“ã€‚åŒæ—¶ï¼Œå¯èƒ½éœ€è¦æŒ‡å®šä½¿ç”¨musl-gccä½œä¸ºç¼–è¯‘å™¨ï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„å‡½æ•°å£°æ˜å’Œé“¾æ¥ã€‚</span><br><span class="line"></span><br><span class="line">å¦å¤–ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦æœ‰ç›´æ¥æˆ–é—´æ¥ä½¿ç”¨è¿™äº›ç³»ç»Ÿè°ƒç”¨çš„æƒ…å†µã€‚å¦‚æœæ˜¯æŸä¸ªä¾èµ–åº“ï¼ˆå¦‚go-sqlite3ï¼‰ä½¿ç”¨äº†è¿™äº›å‡½æ•°ï¼Œå¯èƒ½éœ€è¦æŸ¥çœ‹è¯¥åº“çš„æ–‡æ¡£æˆ–é—®é¢˜åˆ—è¡¨ï¼Œç¡®è®¤æ˜¯å¦æœ‰å·²çŸ¥çš„è·¨å¹³å°ç¼–è¯‘é—®é¢˜ï¼Œæˆ–è€…æ˜¯å¦éœ€è¦ç‰¹å®šçš„ç¼–è¯‘æ ‡ç­¾ã€‚</span><br><span class="line"></span><br><span class="line">æ€»ç»“æ­¥éª¤åº”è¯¥æ˜¯ï¼šå®‰è£…musläº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼Œé…ç½®ç¯å¢ƒå˜é‡ä½¿ç”¨æ­£ç¡®çš„ç¼–è¯‘å™¨ï¼Œç¡®ä¿ä¾èµ–åº“çš„å®‰è£…ï¼Œç„¶åé‡æ–°ç¼–è¯‘ã€‚å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå¯èƒ½éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ä»£ç æˆ–ä¾èµ–åº“çš„å…¼å®¹æ€§ï¼Œæˆ–è€…è€ƒè™‘åœ¨Linuxç¯å¢ƒä¸­è¿›è¡Œç¼–è¯‘ä»¥é¿å…è·¨å¹³å°é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>æ­¤é”™è¯¯æ˜¯ç”±äºåœ¨ <strong>MacOS ä¸Šäº¤å‰ç¼–è¯‘ Linux å¯æ‰§è¡Œæ–‡ä»¶</strong>æ—¶ï¼ŒC ç¼–è¯‘å™¨ä½¿ç”¨äº† MacOS çš„ç³»ç»Ÿå¤´æ–‡ä»¶ï¼Œè€Œ Linux ç‰¹æœ‰çš„ç³»ç»Ÿè°ƒç”¨ <code>setresgid</code> å’Œ <code>setresuid</code> æœªåœ¨ MacOS å¤´æ–‡ä»¶ä¸­å£°æ˜ã€‚ä»¥ä¸‹æ˜¯åˆ†æ­¥ä¿®å¤æ–¹æ³•ï¼š</p><hr><h4 id="1-å®‰è£…-Linux-äº¤å‰ç¼–è¯‘å·¥å…·é“¾"><a href="#1-å®‰è£…-Linux-äº¤å‰ç¼–è¯‘å·¥å…·é“¾" class="headerlink" title="1. å®‰è£… Linux äº¤å‰ç¼–è¯‘å·¥å…·é“¾"></a>1. <strong>å®‰è£… Linux äº¤å‰ç¼–è¯‘å·¥å…·é“¾</strong></h4><p>éœ€è¦å®‰è£…é’ˆå¯¹ Linux çš„ C ç¼–è¯‘å™¨ï¼ˆå¦‚ <code>musl-gcc</code>ï¼‰ï¼Œä»¥æ­£ç¡®è¯†åˆ« Linux ç³»ç»Ÿè°ƒç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… musl äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼ˆMacOSï¼‰</span></span><br><span class="line">brew install FiloSottile/musl-cross/musl-cross</span><br></pre></td></tr></table></figure><hr><h4 id="2-é…ç½®ç¼–è¯‘å‘½ä»¤"><a href="#2-é…ç½®ç¼–è¯‘å‘½ä»¤" class="headerlink" title="2. é…ç½®ç¼–è¯‘å‘½ä»¤"></a>2. <strong>é…ç½®ç¼–è¯‘å‘½ä»¤</strong></h4><p>æŒ‡å®šä½¿ç”¨ <code>musl-gcc</code> ä½œä¸º C ç¼–è¯‘å™¨ï¼Œå¹¶å¯ç”¨é™æ€é“¾æ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">CGO_ENABLED=1 \</span><br><span class="line">GOOS=linux \</span><br><span class="line">GOARCH=amd64 \</span><br><span class="line">CC=x86_64-linux-musl-gcc \</span><br><span class="line">CXX=x86_64-linux-musl-g++ \</span><br><span class="line">go build -ldflags <span class="string">&#x27;-extldflags &quot;-static&quot;&#x27;</span> -o SaveVideo</span><br></pre></td></tr></table></figure><hr><h4 id="3-éªŒè¯é™æ€ç¼–è¯‘"><a href="#3-éªŒè¯é™æ€ç¼–è¯‘" class="headerlink" title="3. éªŒè¯é™æ€ç¼–è¯‘"></a>3. <strong>éªŒè¯é™æ€ç¼–è¯‘</strong></h4><p>æ£€æŸ¥ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ä¸ºé™æ€é“¾æ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥æ–‡ä»¶ç±»å‹</span></span><br><span class="line">file SaveVideo</span><br><span class="line"><span class="comment"># æœŸæœ›è¾“å‡ºï¼šELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥åŠ¨æ€åº“ä¾èµ–ï¼ˆåº”æ— è¾“å‡ºï¼‰</span></span><br><span class="line">ldd SaveVideo</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;goäº¤å‰ç¼–è¯‘é”™è¯¯:sqliteæ•°æ®åº“ï¼š&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A9-é”™è¯¯è§£å†³" scheme="https://kanoc.gitee.io/categories/A9-%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3/"/>
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/A9-%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3/Golang/"/>
    
    
    <category term="é”™è¯¯" scheme="https://kanoc.gitee.io/tags/%E9%94%99%E8%AF%AF/"/>
    
    <category term="ç¼–è¯‘" scheme="https://kanoc.gitee.io/tags/%E7%BC%96%E8%AF%91/"/>
    
    <category term="äº¤å‰ç¼–è¯‘" scheme="https://kanoc.gitee.io/tags/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>Goç‰ˆæœ¬ç®¡ç†å·¥å…·goenv-å®‰è£…æ•™ç¨‹</title>
    <link href="https://kanoc.gitee.io/2025/05/26/Go%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7goenv-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    <id>https://kanoc.gitee.io/2025/05/26/Go%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7goenv-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</id>
    <published>2025-05-25T22:55:33.000Z</published>
    <updated>2025-06-09T10:39:42.160Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Goç‰ˆæœ¬ç®¡ç†å·¥å…·goenv-å®‰è£…æ•™ç¨‹</strong></font></p><span id="more"></span><h2 id="goenv"><a href="#goenv" class="headerlink" title="goenv"></a><strong>goenv</strong></h2><p><font color=#f26522 size=4 face=å®‹ä½“><strong><strong>ç‰¹ç‚¹</strong>: è½»é‡çº§ï¼Œç±»ä¼¼ <code>pyenv</code> æˆ– <code>rbenv</code>ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ç‰ˆæœ¬ã€‚</strong></font></p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/syndbg/goenv.git ~/.goenv</span><br><span class="line"><span class="comment"># åœ¨ shell é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼ˆå¦‚ ~/.bashrc/zshrcï¼‰:</span></span><br><span class="line"><span class="built_in">export</span> GOENV_ROOT=<span class="string">&quot;<span class="variable">$HOME</span>/.goenv&quot;</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;<span class="variable">$GOENV_ROOT</span>/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(goenv init -)</span>&quot;</span></span><br></pre></td></tr></table></figure><h3 id="rootç”¨æˆ·å®‰è£…ç¯å¢ƒ"><a href="#rootç”¨æˆ·å®‰è£…ç¯å¢ƒ" class="headerlink" title="rootç”¨æˆ·å®‰è£…ç¯å¢ƒ"></a>rootç”¨æˆ·å®‰è£…ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/syndbg/goenv.git ~/.goenv</span><br><span class="line"><span class="comment"># ç¼–è¾‘å…¨å±€ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆå½±å“æ‰€æœ‰ç”¨æˆ·ï¼‰</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export GOENV_ROOT=&quot;/root/.goenv&quot;&#x27;</span> &gt;&gt; /etc/profile.d/goenv.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$GOENV_ROOT/bin:$PATH&quot;&#x27;</span> &gt;&gt; /etc/profile.d/goenv.sh</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&#x27;if command -v goenv 1&gt;/dev/null 2&gt;&amp;1; then\n eval &quot;$(goenv init -)&quot;\nfi&#x27;</span> &gt;&gt; /etc/profile.d/goenv.sh</span><br></pre></td></tr></table></figure><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤:"></a><strong>å¸¸ç”¨å‘½ä»¤</strong>:</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">goenv install 1.21.0     <span class="comment"># å®‰è£…1.21.0ç‰ˆæœ¬</span></span><br><span class="line">goenv global 1.21.0      <span class="comment"># è®¾ç½®å…¨å±€ç‰ˆæœ¬</span></span><br><span class="line">goenv <span class="built_in">local</span> 1.20.5       <span class="comment"># è®¾ç½®å½“å‰ç›®å½•ç‰ˆæœ¬ï¼ˆç”Ÿæˆ .go-version æ–‡ä»¶ï¼‰</span></span><br><span class="line">goenv install --list     <span class="comment"># åˆ—å‡ºæ‰€æœ‰å¯å®‰è£…ç‰ˆæœ¬</span></span><br><span class="line">goenv global 1.21.5      <span class="comment"># æ‰€æœ‰é¡¹ç›®é»˜è®¤ä½¿ç”¨æ­¤ç‰ˆæœ¬</span></span><br><span class="line">goenv <span class="built_in">local</span> 1.21.5       <span class="comment"># è®¾ç½®å½“å‰ç›®å½•ç‰ˆæœ¬  ç”Ÿæˆ .go-version æ–‡ä»¶ï¼Œä»…å½“å‰ç›®å½•ç”Ÿæ•ˆ</span></span><br><span class="line">goenv shell 1.21.5       <span class="comment"># è®¾ç½® Shell ä¼šè¯ç‰ˆæœ¬</span></span><br><span class="line">goenv versions           <span class="comment"># æŸ¥çœ‹å·²å®‰è£…ç‰ˆæœ¬</span></span><br><span class="line">goenv uninstall 1.21.5   <span class="comment"># å¸è½½ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## æŸ¥çœ‹å½“å‰ç”Ÿæ•ˆçš„ Go ç‰ˆæœ¬åŠè·¯å¾„</span></span><br><span class="line">goenv version         <span class="comment"># æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬åŠæ¥æºï¼ˆå…¨å±€/æœ¬åœ°/Shellï¼‰</span></span><br><span class="line">goenv <span class="built_in">which</span> go        <span class="comment"># æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ Go å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">goenv <span class="built_in">rehash</span>          <span class="comment"># åˆ·æ–° Shims ç¼“å­˜</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Goç‰ˆæœ¬ç®¡ç†å·¥å…·goenv-å®‰è£…æ•™ç¨‹&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="Golang" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/Golang/"/>
    
    
    <category term="go" scheme="https://kanoc.gitee.io/tags/go/"/>
    
    <category term="goenv" scheme="https://kanoc.gitee.io/tags/goenv/"/>
    
    <category term="ç‰ˆæœ¬ç®¡ç†å·¥å…·" scheme="https://kanoc.gitee.io/tags/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>Djangoé…ç½®-channels-WSçš„ASGIæœåŠ¡å™¨</title>
    <link href="https://kanoc.gitee.io/2025/05/22/Django%E9%85%8D%E7%BD%AE-channels-WS%E7%9A%84ASGI%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>https://kanoc.gitee.io/2025/05/22/Django%E9%85%8D%E7%BD%AE-channels-WS%E7%9A%84ASGI%E6%9C%8D%E5%8A%A1%E5%99%A8/</id>
    <published>2025-05-22T01:06:19.000Z</published>
    <updated>2025-06-09T08:37:54.419Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Djangoé…ç½®-channels-WSçš„ASGIæœåŠ¡å™¨</strong></font></p><span id="more"></span><h1 id="ç¯å¢ƒè¯´æ˜ï¼š"><a href="#ç¯å¢ƒè¯´æ˜ï¼š" class="headerlink" title="ç¯å¢ƒè¯´æ˜ï¼š"></a>ç¯å¢ƒè¯´æ˜ï¼š</h1><p>è¯¥ç¯å¢ƒå‡ ä¹ç®—æ˜¯ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬çš„asgiæœåŠ¡å™¨äº†</p><ul><li><p>ç³»ç»Ÿç¯å¢ƒï¼šMacOSï¼ˆMç³»åˆ—ï¼‰</p></li><li><p>Pythonç‰ˆæœ¬ï¼š<code>3.12</code></p></li><li><p>Djangoç‰ˆæœ¬ï¼š<code>5.1.7</code></p></li><li><p>daphneç‰ˆæœ¬ï¼š<code>4.2.0</code></p></li><li><p>channelsç‰ˆæœ¬ï¼š<code>4.2.2</code></p></li><li><p>asgirefç‰ˆæœ¬ï¼š<code>3.8.1</code></p></li></ul><p><img src="https://s2.loli.net/2025/05/22/IktHlRLTXoCMpZq.png" alt="image-20250522090858536"></p><h2 id="é¡¹ç›®ç»“æ„ï¼š"><a href="#é¡¹ç›®ç»“æ„ï¼š" class="headerlink" title="é¡¹ç›®ç»“æ„ï¼š"></a>é¡¹ç›®ç»“æ„ï¼š</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">â”œâ”€â”€ MyPorject</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ asgi.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ routing.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ settings.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ urls.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ wsgi.py</span><br><span class="line">â”œâ”€â”€ apps</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __pycache__</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ consumers.cpython-312.pyc</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ consumers.pyï¼ˆä½äºä¸»appä¸‹ï¼‰</span><br><span class="line">â”‚Â Â  â””â”€â”€ **å…¶ä»–app**</span><br><span class="line">â”œâ”€â”€ manage.py</span><br></pre></td></tr></table></figure><h2 id="ç‰¹åˆ«è¯´æ˜ï¼š"><a href="#ç‰¹åˆ«è¯´æ˜ï¼š" class="headerlink" title="ç‰¹åˆ«è¯´æ˜ï¼š"></a>ç‰¹åˆ«è¯´æ˜ï¼š</h2><p><font color=red size=4 face=å®‹ä½“><strong><code>channels</code> å¤§äºÂ 3.0.5 å¿…é¡»é…ç½®<code>daphne</code>æˆ–è€…<code>uvicorn</code>ä½¿ç”¨</strong></font></p><h3 id="ç¬¬ä¸€æ­¥ï¼šå®‰è£…å¸¦è¾¾èŠ™å¦®çš„-channelsç‰ˆæœ¬ï¼Œä»¥åŠå…¶ä»–ç¯å¢ƒ"><a href="#ç¬¬ä¸€æ­¥ï¼šå®‰è£…å¸¦è¾¾èŠ™å¦®çš„-channelsç‰ˆæœ¬ï¼Œä»¥åŠå…¶ä»–ç¯å¢ƒ" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå®‰è£…å¸¦è¾¾èŠ™å¦®çš„ channelsç‰ˆæœ¬ï¼Œä»¥åŠå…¶ä»–ç¯å¢ƒ"></a>ç¬¬ä¸€æ­¥ï¼šå®‰è£…å¸¦<code>è¾¾èŠ™å¦®</code>çš„ <code>channels</code>ç‰ˆæœ¬ï¼Œä»¥åŠå…¶ä»–ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install channels[daphne]</span><br><span class="line"><span class="comment"># daphne==4.2.0  channels==4.2.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…Django</span></span><br><span class="line">pip install Django==5.1.7</span><br><span class="line"></span><br><span class="line"><span class="comment">## å®‰è£… asgiref</span></span><br><span class="line">pip install asgiref==3.8.1</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒæ­¥ï¼šé…ç½®-MyPorject-settings-py"><a href="#ç¬¬äºŒæ­¥ï¼šé…ç½®-MyPorject-settings-py" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé…ç½® MyPorject__settings.py"></a>ç¬¬äºŒæ­¥ï¼šé…ç½® <code>MyPorject__settings.py</code></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&quot;daphne&quot;</span>,</span><br><span class="line">    <span class="string">&quot;å…¶ä»–app&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">## å¼€å¯ ASGIè®¿é—®</span></span><br><span class="line">WSGI_APPLICATION = <span class="string">&#x27;MyPorject.wsgi.application&#x27;</span></span><br><span class="line"><span class="comment"># æ·»åŠ  Channels é…ç½®</span></span><br><span class="line">ASGI_APPLICATION = <span class="string">&#x27;MyPorject.asgi.application&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰æ­¥ï¼šé…ç½®-MyPorject-asgi-py"><a href="#ç¬¬ä¸‰æ­¥ï¼šé…ç½®-MyPorject-asgi-py" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šé…ç½® MyPorject__asgi.py"></a>ç¬¬ä¸‰æ­¥ï¼šé…ç½® <code>MyPorject__asgi.py</code></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> channels.routing <span class="keyword">import</span> ProtocolTypeRouter, URLRouter</span><br><span class="line"><span class="keyword">from</span> django.core.asgi <span class="keyword">import</span> get_asgi_application</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> routing</span><br><span class="line"></span><br><span class="line">os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;MyPorject.settings&#x27;</span>)</span><br><span class="line">django_asgi_app = get_asgi_application()</span><br><span class="line"></span><br><span class="line">application = ProtocolTypeRouter(&#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: django_asgi_app,</span><br><span class="line">    <span class="string">&quot;websocket&quot;</span>: URLRouter(routing.websocket_urlpatterns)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="ç¬¬å››æ­¥ï¼šæ–°å»º-MyPorject-routing-py"><a href="#ç¬¬å››æ­¥ï¼šæ–°å»º-MyPorject-routing-py" class="headerlink" title="ç¬¬å››æ­¥ï¼šæ–°å»º MyPorject__routing.py"></a>ç¬¬å››æ­¥ï¼šæ–°å»º <code>MyPorject__routing.py</code></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># yourapp/routing.py</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, re_path</span><br><span class="line"><span class="keyword">from</span> apps <span class="keyword">import</span> consumers</span><br><span class="line"></span><br><span class="line">websocket_urlpatterns = [</span><br><span class="line">    <span class="comment"># xxxx/ws/x1</span></span><br><span class="line">    path(<span class="string">&#x27;ws&#x27;</span>, consumers.ChatConsumer.as_asgi()),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äº”æ­¥ï¼šæ–°å»º-MyPorject-apps-consumers-py"><a href="#ç¬¬äº”æ­¥ï¼šæ–°å»º-MyPorject-apps-consumers-py" class="headerlink" title="ç¬¬äº”æ­¥ï¼šæ–°å»º MyPorject__apps__consumers.py"></a>ç¬¬äº”æ­¥ï¼šæ–°å»º <code>MyPorject__apps__consumers.py</code></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> channels.generic.websocket <span class="keyword">import</span> AsyncWebsocketConsumer</span><br><span class="line"><span class="keyword">from</span> channels.exceptions <span class="keyword">import</span> StopConsumer</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChatConsumer</span>(<span class="title class_ inherited__">AsyncWebsocketConsumer</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.clientData = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>.SendDataJsonKeys = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">self</span>.accept()</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">disconnect</span>(<span class="params">self, close_code=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">raise</span> StopConsumer()</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">receive</span>(<span class="params">self, text_data=<span class="literal">None</span>, bytes_data=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä¼ é€’å›æ¥çš„å‚æ•°çš„è½¬æ¢</span></span><br><span class="line">            <span class="variable language_">self</span>.clientData = json.loads(text_data)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;ä¼ é€’è¿‡æ¥å‚æ•°äº†&quot;</span>, <span class="variable language_">self</span>.clientData)</span><br><span class="line">            <span class="variable language_">self</span>.SendDataJsonKeys = <span class="variable language_">self</span>.clientData.keys()   <span class="comment"># è·å–ä¼ é€’ä¸Šæ¥çš„å‚æ•°</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">if</span> text_data == <span class="string">&quot;æ–­å¼€&quot;</span>:</span><br><span class="line">                <span class="keyword">await</span> <span class="variable language_">self</span>.send(<span class="string">f&quot;<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">await</span> <span class="variable language_">self</span>.send(<span class="string">&quot;ç½‘ç»œè¿æ¥æ–­å¼€ï¼&quot;</span>)</span><br><span class="line">                <span class="keyword">await</span> <span class="variable language_">self</span>.close()</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Djangoé…ç½®-channels-WSçš„ASGIæœåŠ¡å™¨&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Python" scheme="https://kanoc.gitee.io/categories/Python/"/>
    
    <category term="Django_channels" scheme="https://kanoc.gitee.io/categories/Python/Django-channels/"/>
    
    
    <category term="python" scheme="https://kanoc.gitee.io/tags/python/"/>
    
    <category term="django" scheme="https://kanoc.gitee.io/tags/django/"/>
    
    <category term="ASGIæœåŠ¡å™¨" scheme="https://kanoc.gitee.io/tags/ASGI%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="å¼‚æ­¥WEB" scheme="https://kanoc.gitee.io/tags/%E5%BC%82%E6%AD%A5WEB/"/>
    
  </entry>
  
  <entry>
    <title>pythonå®‰è£…æ–¹å¼é›†åˆ(ubuntu)</title>
    <link href="https://kanoc.gitee.io/2025/05/21/python%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F%E9%9B%86%E5%90%88(ubuntu)/"/>
    <id>https://kanoc.gitee.io/2025/05/21/python%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F%E9%9B%86%E5%90%88(ubuntu)/</id>
    <published>2025-05-21T10:19:17.000Z</published>
    <updated>2025-06-10T00:53:27.435Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>pythonå®‰è£…æ–¹å¼é›†åˆ(ubuntu)</strong></font></p><span id="more"></span><h2 id="æ–¹å¼ä¸€ï¼šaptåŒ…ç®¡ç†å™¨æ–¹å¼å®‰è£…ï¼š"><a href="#æ–¹å¼ä¸€ï¼šaptåŒ…ç®¡ç†å™¨æ–¹å¼å®‰è£…ï¼š" class="headerlink" title="æ–¹å¼ä¸€ï¼šaptåŒ…ç®¡ç†å™¨æ–¹å¼å®‰è£…ï¼š"></a>æ–¹å¼ä¸€ï¼šaptåŒ…ç®¡ç†å™¨æ–¹å¼å®‰è£…ï¼š</h2><h3 id="1ã€è§£é™¤ä»“åº“é™åˆ¶"><a href="#1ã€è§£é™¤ä»“åº“é™åˆ¶" class="headerlink" title="1ã€è§£é™¤ä»“åº“é™åˆ¶"></a>1ã€è§£é™¤<code>ä»“åº“é™åˆ¶</code></h3><ul><li>å®˜æ–¹ä»“åº“çš„ Python ç‰ˆæœ¬é€šå¸¸è¾ƒä¿å®ˆï¼ˆå¦‚ Ubuntu 22.04 é»˜è®¤ä»…æ”¯æŒåˆ° Python 3.10ï¼‰ã€‚</li><li>è‹¥éœ€æ›´æ–°ç‰ˆæœ¬ï¼ˆå¦‚ Python 3.11&#x2F;3.12ï¼‰ï¼Œéœ€æ·»åŠ ç¬¬ä¸‰æ–¹ PPA ä»“åº“ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ  deadsnakes PPAï¼ˆUbuntu é€‚ç”¨ï¼‰</span></span><br><span class="line"><span class="built_in">sudo</span> add-apt-repository ppa:deadsnakes/ppa</span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br></pre></td></tr></table></figure><h3 id="2ã€æŸ¥çœ‹å¯å®‰è£…pythonç‰ˆæœ¬"><a href="#2ã€æŸ¥çœ‹å¯å®‰è£…pythonç‰ˆæœ¬" class="headerlink" title="2ã€æŸ¥çœ‹å¯å®‰è£…pythonç‰ˆæœ¬"></a>2ã€æŸ¥çœ‹å¯å®‰è£…pythonç‰ˆæœ¬</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt list <span class="string">&#x27;python3.*&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="3ã€å®‰è£…python3-13"><a href="#3ã€å®‰è£…python3-13" class="headerlink" title="3ã€å®‰è£…python3.13"></a>3ã€å®‰è£…python3.13</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt install python3.13</span><br></pre></td></tr></table></figure><h3 id="4ã€è®¾ç½®ç¯å¢ƒ"><a href="#4ã€è®¾ç½®ç¯å¢ƒ" class="headerlink" title="4ã€è®¾ç½®ç¯å¢ƒ"></a>4ã€è®¾ç½®ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯å®‰è£…è·¯å¾„</span></span><br><span class="line"><span class="built_in">which</span> python3.13</span><br><span class="line"><span class="comment"># è¾“å‡ºç¤ºä¾‹ï¼š/usr/bin/python3.13</span></span><br><span class="line">python3.13 -c <span class="string">&quot;import sys; print(sys.executable)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å…¨å±€pythonç‰ˆæœ¬</span></span><br><span class="line"><span class="built_in">ln</span> -s /usr/bin/python3.13 /usr/bin/python3 </span><br></pre></td></tr></table></figure><h3 id="5ã€å®‰è£…pip"><a href="#5ã€å®‰è£…pip" class="headerlink" title="5ã€å®‰è£…pip"></a>5ã€å®‰è£…pip</h3><ul><li>æ–¹æ³• 1ï¼šä½¿ç”¨ <code>ensurepip</code>ï¼ˆæ¨èï¼‰â€”â€” Python å†…ç½®çš„ <code>ensurepip</code> æ¨¡å—å¯ç›´æ¥å®‰è£… <code>pip</code>ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸º Python 3.13 å®‰è£… pip</span></span><br><span class="line">python3.13 -m ensurepip --upgrade</span><br></pre></td></tr></table></figure><ul><li>æ–¹æ³• 2ï¼šé€šè¿‡ <code>get-pip.py</code> è„šæœ¬ â€”â€” è‹¥ <code>ensurepip</code> ä¸å¯ç”¨ï¼ˆå¦‚ç¼–è¯‘æ—¶è¢«ç¦ç”¨ï¼‰ï¼Œæ‰‹åŠ¨ä¸‹è½½å¹¶å®‰è£…ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ==================== python3.13 å®‰è£…</span></span><br><span class="line">curl -O https://bootstrap.pypa.io/get-pip.py <span class="comment"># ä¸‹è½½å®‰è£…è„šæœ¬</span></span><br><span class="line">python3.13 get-pip.py    <span class="comment"># ä¸º Python 3.13 å®‰è£… pip</span></span><br><span class="line"><span class="built_in">rm</span> get-pip.py    <span class="comment"># åˆ é™¤è„šæœ¬ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==================== python3.8 å®‰è£…</span></span><br><span class="line"><span class="built_in">sudo</span> apt install python3.8-distutils python3.8-venv</span><br><span class="line">curl -O https://bootstrap.pypa.io/pip/3.8/get-pip.py   <span class="comment"># ç‰ˆæœ¬å¤ªå° éœ€è¦ä½¿ç”¨ä¸“ç”¨çš„pipå®‰è£…</span></span><br><span class="line">python3.13 get-pip.py    <span class="comment"># ä¸º Python 3.8 å®‰è£… pip</span></span><br><span class="line"><span class="built_in">rm</span> get-pip.py    <span class="comment"># åˆ é™¤è„šæœ¬ï¼ˆå¯é€‰ï¼‰</span></span><br></pre></td></tr></table></figure><ul><li>æ–¹æ³• 3ï¼šé€šè¿‡ APT å®‰è£…ï¼ˆéœ€ä»“åº“æ”¯æŒï¼‰â€”â€” è‹¥ Python 3.13 æ¥è‡ªç¬¬ä¸‰æ–¹ä»“åº“ï¼ˆå¦‚ <code>deadsnakes</code>ï¼‰ï¼Œå°è¯•å®‰è£…å¯¹åº” <code>pip</code>ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install python3.13-pip  <span class="comment"># å®é™…åŒ…åå¯èƒ½ä¸åŒï¼ˆå¦‚ python3-pipï¼‰</span></span><br></pre></td></tr></table></figure><p>pip  pip3  pip3.13</p><ul><li>ä¿®å¤è·¯å¾„ä¸æƒé™ â€”â€” å®‰è£…åï¼Œ<code>pip</code> çš„å¯æ‰§è¡Œæ–‡ä»¶åº”ä½äºï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/local/bin/pip3.13    <span class="comment"># æ‰‹åŠ¨æˆ– get-pip.py å®‰è£…çš„è·¯å¾„</span></span><br><span class="line">/usr/bin/pip3.13          <span class="comment"># APT å®‰è£…çš„è·¯å¾„</span></span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®å…¨å±€å˜é‡</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /usr/local/bin/pip3.13 /usr/bin/pip3</span><br></pre></td></tr></table></figure><h2 id="æ–¹å¼äºŒï¼šPyenvå¤šç‰ˆæœ¬ç®¡ç†æ–¹å¼ï¼š"><a href="#æ–¹å¼äºŒï¼šPyenvå¤šç‰ˆæœ¬ç®¡ç†æ–¹å¼ï¼š" class="headerlink" title="æ–¹å¼äºŒï¼šPyenvå¤šç‰ˆæœ¬ç®¡ç†æ–¹å¼ï¼š"></a>æ–¹å¼äºŒï¼šPyenvå¤šç‰ˆæœ¬ç®¡ç†æ–¹å¼ï¼š</h2><p>Pyenvç‰ˆæœ¬ä¼˜å…ˆçº§ï¼šShell &gt; Local &gt; Global</p><h3 id="1ã€æ›´æ–°ç³»ç»Ÿ"><a href="#1ã€æ›´æ–°ç³»ç»Ÿ" class="headerlink" title="1ã€æ›´æ–°ç³»ç»Ÿ"></a>1ã€æ›´æ–°ç³»ç»Ÿ</h3><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿ä½ çš„ Ubuntu ç³»ç»Ÿæ˜¯æœ€æ–°çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt upgrade</span><br></pre></td></tr></table></figure><h3 id="2ã€å®‰è£…pyenv-å‰ç½®ä¾èµ–"><a href="#2ã€å®‰è£…pyenv-å‰ç½®ä¾èµ–" class="headerlink" title="2ã€å®‰è£…pyenv å‰ç½®ä¾èµ–"></a>2ã€å®‰è£…pyenv å‰ç½®ä¾èµ–</h3><p>PyENV éœ€è¦ä¸€äº›ä¾èµ–é¡¹æ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…å®ƒä»¬ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install build-essential libbz2-dev libncurses5-dev libncursesw5-dev libffi-dev libreadline-dev libssl-dev libsqlite3-dev liblzma-dev zlib1g-dev wget curl llvm libncurses-dev xz-utils git</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3ã€å®‰è£…-PyENV"><a href="#3ã€å®‰è£…-PyENV" class="headerlink" title="3ã€å®‰è£… PyENV"></a>3ã€å®‰è£… PyENV</h3><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… PyENV</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl https://pyenv.run | bash</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/05/21/ihVmX4TtpKM7Jdg.png" alt="Installing PyENV on Ubuntu"></p><h3 id="4ã€æ›´æ–°Shellé…ç½®"><a href="#4ã€æ›´æ–°Shellé…ç½®" class="headerlink" title="4ã€æ›´æ–°Shellé…ç½®"></a>4ã€æ›´æ–°Shellé…ç½®</h3><ul><li><code>4.1ï¼šï¼ˆérootç”¨æˆ·ï¼‰</code></li></ul><p>â€‹å®‰è£… PyENV åï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ° shell é…ç½®ä¸­ï¼Œç¼–è¾‘ <strong>~&#x2F;.bashrc</strong> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œï¼Œä»¥ä¾¿æ¯æ¬¡æ‰“å¼€ç»ˆç«¯æ—¶å®ƒéƒ½ä¼šåŠ è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;<span class="variable">$HOME</span>/.pyenv/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv init --path)</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv init -)</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv virtualenv-init -)</span>&quot;</span></span><br></pre></td></tr></table></figure><p>â€‹ä½¿ç”¨ source å‘½ä»¤ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><ul><li><code>4.2ã€rootç”¨æˆ·å®‰è£…æ–¹å¼</code></li></ul><p>â€‹å®‰è£… PyENV åï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ° shell é…ç½®ä¸­ï¼Œç¼–è¾‘ <strong>~&#x2F;.bashrc</strong> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œï¼Œä»¥ä¾¿æ¯æ¬¡æ‰“å¼€ç»ˆç«¯æ—¶å®ƒéƒ½ä¼šåŠ è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘å…¨å±€ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆå½±å“æ‰€æœ‰ç”¨æˆ·ï¼‰</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PYENV_ROOT=&quot;/root/.pyenv&quot;&#x27;</span> &gt;&gt; /etc/profile.d/pyenv.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&#x27;</span> &gt;&gt; /etc/profile.d/pyenv.sh</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&#x27;if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\n eval &quot;$(pyenv init -)&quot;\nfi&#x27;</span> &gt;&gt; /etc/profile.d/pyenv.sh</span><br></pre></td></tr></table></figure><p>â€‹ä½¿ç”¨ source å‘½ä»¤ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile.d/pyenv.sh</span><br></pre></td></tr></table></figure><h3 id="5ã€å®‰è£…ä¸åŒçš„pythonç‰ˆæœ¬"><a href="#5ã€å®‰è£…ä¸åŒçš„pythonç‰ˆæœ¬" class="headerlink" title="5ã€å®‰è£…ä¸åŒçš„pythonç‰ˆæœ¬"></a>5ã€å®‰è£…ä¸åŒçš„pythonç‰ˆæœ¬</h3><p>ç°åœ¨æ‚¨å¯ä»¥å®‰è£…æ‰€éœ€çš„ä»»ä½•ç‰ˆæœ¬çš„ Pythonã€‚ä¾‹å¦‚ï¼Œè¦å®‰è£… Python 3.12</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv install 3.12</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ‚¨å¯èƒ½éœ€è¦å®‰è£… Python 2.7 ç­‰æ—§ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv install 2.7</span><br></pre></td></tr></table></figure><p>åˆ—å‡ºç³»ç»Ÿä¸Šå®‰è£…çš„æ‰€æœ‰ Python ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv install --list</span><br></pre></td></tr></table></figure><h3 id="6ã€è®¾ç½®å…¨å±€pythonç‰ˆæœ¬"><a href="#6ã€è®¾ç½®å…¨å±€pythonç‰ˆæœ¬" class="headerlink" title="6ã€è®¾ç½®å…¨å±€pythonç‰ˆæœ¬"></a>6ã€è®¾ç½®å…¨å±€pythonç‰ˆæœ¬</h3><p>æ‚¨å¯ä»¥è®¾ç½®é»˜è®¤ä½¿ç”¨çš„å…¨å±€ Python ç‰ˆæœ¬ï¼Œæ¯”å¦‚å°† Python 3.12 è®¾ç½®ä¸ºå…¨å±€ç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv global 3.12</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰å…¨å±€ Python ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv version</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/05/21/9xWJdsCVoDtKe2h.png" alt="PyENV Set Default Python Version"></p><h3 id="7ã€è®¾ç½®å…¶ä»–ç‰ˆæœ¬"><a href="#7ã€è®¾ç½®å…¶ä»–ç‰ˆæœ¬" class="headerlink" title="7ã€è®¾ç½®å…¶ä»–ç‰ˆæœ¬"></a>7ã€è®¾ç½®å…¶ä»–ç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥ä½ çš„é¡¹ç›®ç›®å½•</span></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®è¯¥ç›®å½•çš„ Python ç‰ˆæœ¬ä¸º 3.8</span></span><br><span class="line">pyenv local 3.8.12   # å‡è®¾å·²å®‰è£… 3.8.12</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™ä¼šç”Ÿæˆä¸€ä¸ªéšè—æ–‡ä»¶ `.python-version`ï¼Œè®°å½•ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># éªŒè¯</span></span></span><br><span class="line">pyenv shell 3.8.12   # ä¸´æ—¶è®¾ç½®</span><br><span class="line">python --version      # åº”æ˜¾ç¤º 3.8.12</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€€å‡ºä¸´æ—¶æ¨¡å¼ï¼ˆæ¢å¤å…¨å±€æˆ–æœ¬åœ°è®¾ç½®ï¼‰</span></span><br><span class="line">pyenv shell --unset</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¢å¤å…¨å±€ç‰ˆæœ¬</span></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line">rm .python-version   # åˆ é™¤ç‰ˆæœ¬æ ‡è®°æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰"><a href="#ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰" class="headerlink" title="ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰"></a>ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆåŸºäº Python 3.8ï¼‰</span></span><br><span class="line">pyenv virtualenv 3.8.12 my-legacy-env</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥é¡¹ç›®ç›®å½•å¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line">pyenv local my-legacy-env  # è‡ªåŠ¨æ¿€æ´»</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éªŒè¯</span></span><br><span class="line">python --version  # æ˜¾ç¤º 3.8.12ï¼Œä¸”ç¯å¢ƒç‹¬ç«‹</span><br><span class="line">pip list          # æ˜¾ç¤ºè¯¥ç¯å¢ƒç‹¬ç«‹çš„åŒ…</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">pyenv deactivate</span><br></pre></td></tr></table></figure><h3 id="Step-9-éªŒè¯ç‰ˆæœ¬åˆ‡æ¢"><a href="#Step-9-éªŒè¯ç‰ˆæœ¬åˆ‡æ¢" class="headerlink" title="Step 9: éªŒè¯ç‰ˆæœ¬åˆ‡æ¢"></a>Step 9: éªŒè¯ç‰ˆæœ¬åˆ‡æ¢</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~  # é€€å‡ºé¡¹ç›®ç›®å½•</span><br><span class="line">python --version  # åº”æ˜¾ç¤ºå…¨å±€ç‰ˆæœ¬ 3.13.0</span><br><span class="line"></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line">python --version  # åº”æ˜¾ç¤ºæœ¬åœ°ç‰ˆæœ¬ 3.8.12 æˆ–è™šæ‹Ÿç¯å¢ƒ</span><br></pre></td></tr></table></figure><h3 id="11ã€åˆ é™¤pyenvç¯å¢ƒ"><a href="#11ã€åˆ é™¤pyenvç¯å¢ƒ" class="headerlink" title="11ã€åˆ é™¤pyenvç¯å¢ƒ"></a>11ã€åˆ é™¤pyenvç¯å¢ƒ</h3><ul><li>1ã€<strong>åˆ é™¤ <code>pyenv</code> æœ¬ä½“åŠæ‰€æœ‰ Python ç‰ˆæœ¬</strong></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤ pyenv æ ¹ç›®å½•ï¼ˆé»˜è®¤è·¯å¾„ï¼‰</span></span><br><span class="line"><span class="built_in">rm</span> -rf ~/.pyenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè‡ªå®šä¹‰è¿‡å®‰è£…è·¯å¾„ï¼ˆé€šè¿‡ PYENV_ROOT å˜é‡ï¼‰ï¼Œåˆ é™¤å¯¹åº”ç›®å½•</span></span><br><span class="line"><span class="comment"># rm -rf /path/to/your/custom/pyenv</span></span><br></pre></td></tr></table></figure><ul><li><p>2ã€æ¸…ç† Shell ç¯å¢ƒé…ç½® â€“ ç¼–è¾‘ä½ çš„ Shell é…ç½®æ–‡ä»¶ï¼ˆæ ¹æ®å®é™…ä½¿ç”¨çš„ Shellï¼‰ï¼š</p><ul><li><strong>Bash</strong>ï¼š<code>~/.bashrc</code>, <code>~/.bash_profile</code></li><li><strong>Zsh</strong>ï¼š<code>~/.zshrc</code></li><li><strong>Fish</strong>ï¼š<code>~/.config/fish/config.fish</code></li></ul><p><strong>åˆ é™¤ä»¥ä¸‹å†…å®¹</strong>ï¼š</p></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾å¹¶åˆ é™¤ä¸ pyenv ç›¸å…³çš„ä»£ç å—ï¼Œä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="built_in">export</span> PYENV_ROOT=<span class="string">&quot;<span class="variable">$HOME</span>/.pyenv&quot;</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;<span class="variable">$PYENV_ROOT</span>/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv init -)</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv virtualenv-init -)</span>&quot;</span>  <span class="comment"># å¦‚æœé…ç½®äº†è™šæ‹Ÿç¯å¢ƒæ’ä»¶</span></span><br></pre></td></tr></table></figure><ul><li>**3ã€ ç§»é™¤å·²å®‰è£…çš„ Python ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰â€“ å¦‚æœä¹‹å‰é€šè¿‡ <code>pyenv</code> å®‰è£…äº†å¤šä¸ª Python ç‰ˆæœ¬ï¼Œå¯æ‰‹åŠ¨åˆ é™¤ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æ‰€æœ‰ç‰ˆæœ¬ï¼ˆé»˜è®¤å®‰è£…è·¯å¾„ï¼‰</span></span><br><span class="line"><span class="built_in">rm</span> -rf ~/.pyenv/versions/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè‡ªå®šä¹‰è¿‡ç‰ˆæœ¬è·¯å¾„ï¼Œåˆ é™¤å¯¹åº”ç›®å½•</span></span><br><span class="line"><span class="comment"># rm -rf /path/to/your/python/versions</span></span><br></pre></td></tr></table></figure><ul><li>4ã€æ¸…é™¤ç¼“å­˜å’Œä¸´æ—¶æ–‡ä»¶</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf ~/.pyenv/cache     <span class="comment"># å®‰è£…æ—¶çš„æºç ç¼“å­˜</span></span><br><span class="line"><span class="built_in">rm</span> -f ~/.pyenv/version    <span class="comment"># å½“å‰ä½¿ç”¨çš„ Python ç‰ˆæœ¬è®°å½•</span></span><br></pre></td></tr></table></figure><ul><li>5ã€éªŒè¯å¸è½½ â€“ é‡æ–°å¯åŠ¨ç»ˆç«¯æˆ–æ‰§è¡Œï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span> <span class="variable">$SHELL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## ç„¶åæ£€æŸ¥å‘½ä»¤æ˜¯å¦å¤±æ•ˆï¼š</span></span><br><span class="line">pyenv --version      <span class="comment"># åº”æç¤º &quot;command not found&quot;</span></span><br><span class="line"><span class="built_in">which</span> python         <span class="comment"># åº”æŒ‡å‘ç³»ç»Ÿé»˜è®¤ Pythonï¼Œè€Œé pyenv è·¯å¾„</span></span><br></pre></td></tr></table></figure><ul><li>6ã€æ®‹ç•™ç¯å¢ƒå˜é‡</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¤šç”¨æˆ·ç¯å¢ƒï¼š</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /usr/local/pyenv</span><br><span class="line"><span class="comment"># æ’ä»¶æ¸…ç†ï¼š</span></span><br><span class="line"><span class="built_in">rm</span> -rf ~/.pyenv/plugins</span><br></pre></td></tr></table></figure><h2 id="æ–¹å¼ä¸‰ï¼šUVæ–¹å¼ï¼š"><a href="#æ–¹å¼ä¸‰ï¼šUVæ–¹å¼ï¼š" class="headerlink" title="æ–¹å¼ä¸‰ï¼šUVæ–¹å¼ï¼š"></a>æ–¹å¼ä¸‰ï¼šUVæ–¹å¼ï¼š</h2><p>æœ¬æ–‡å‚è€ƒè‡ªï¼š1ã€<a href="https://blog.csdn.net/muxuen/article/details/147544307">ã€Pythonã€‘ä½¿ç”¨uvç®¡ç†pythonè™šæ‹Ÿç¯å¢ƒ_uvç¯å¢ƒpython-CSDNåšå®¢</a></p><p>æœ¬æ–‡å‚è€ƒè‡ªï¼š2ã€<a href="https://blog.csdn.net/qq_41472205/article/details/145686414">uv ç®€æ˜“å®‰è£…ä¸æ›´æ¢å›½å†…é•œåƒæº_uv å›½å†…æº-CSDNåšå®¢</a></p><h3 id="1ã€å®‰è£…uvç®¡ç†å™¨"><a href="#1ã€å®‰è£…uvç®¡ç†å™¨" class="headerlink" title="1ã€å®‰è£…uvç®¡ç†å™¨"></a>1ã€å®‰è£…uvç®¡ç†å™¨</h3><ul><li>Mac || Linuxå®‰è£…ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -LsSf https://astral.sh/uv/install.sh | sh</span><br></pre></td></tr></table></figure><ul><li>Windowså®‰è£…ï¼š</li></ul><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1: åœ¨ Windows ä¸Šï¼šä½¿ç”¨ Astral.sh æä¾›çš„å®‰è£…è„šæœ¬</span></span><br><span class="line">powershell <span class="literal">-ExecutionPolicy</span> ByPass <span class="literal">-c</span> <span class="string">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2: åœ¨ Windows ä¸Šï¼šä½¿ç”¨ scoop å®‰è£… uv</span></span><br><span class="line">scoop install uv</span><br></pre></td></tr></table></figure><ul><li>pipå®‰è£…æ–¹å¼ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install uv</span><br></pre></td></tr></table></figure><ul><li>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">uv --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹uvç‰ˆæœ¬</span></span><br><span class="line">uv --version</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/05/21/K5D4J9ovWYuiejn.jpg" alt="img"></p><h3 id="2ã€å¸è½½uvï¼š"><a href="#2ã€å¸è½½uvï¼š" class="headerlink" title="2ã€å¸è½½uvï¼š"></a>2ã€å¸è½½uvï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv cache clean</span><br><span class="line"><span class="built_in">rm</span> -r <span class="string">&quot;<span class="subst">$(uv python dir)</span>&quot;</span></span><br><span class="line"><span class="built_in">rm</span> -r <span class="string">&quot;<span class="subst">$(uv tool dir)</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mac/linux</span></span><br><span class="line"><span class="built_in">rm</span> ~/.local/bin/uv ~/.local/bin/uvx</span><br><span class="line"><span class="comment"># windows</span></span><br><span class="line"><span class="built_in">rm</span> <span class="variable">$HOME</span>.<span class="built_in">local</span>\bin\uv.exe</span><br><span class="line"><span class="built_in">rm</span> <span class="variable">$HOME</span>.<span class="built_in">local</span>\bin\uvx.exe</span><br></pre></td></tr></table></figure><h3 id="3ã€pythonç®¡ç†ï¼š"><a href="#3ã€pythonç®¡ç†ï¼š" class="headerlink" title="3ã€pythonç®¡ç†ï¼š"></a>3ã€pythonç®¡ç†ï¼š</h3><ul><li>æŸ¥çœ‹pythonå¯ç”¨ç‰ˆæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python list</span><br></pre></td></tr></table></figure><ul><li>å®‰è£…python3.13</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ‡å‡†å®‰è£…æ–¹å¼</span></span><br><span class="line">uv python install 3.13</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–å®‰è£…Pythonçš„æ–¹å¼å®ç°ï¼Œæ¯”å¦‚PyPyå®ç°çš„python</span></span><br><span class="line">uv python install pypy@3.13</span><br></pre></td></tr></table></figure><ul><li>æŸ¥æ‰¾æŸä¸ªpythonç‰ˆæœ¬çš„è·¯å¾„</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python find 3.10</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># /Library/Frameworks/Python.framework/Versions/3.10/bin/python3.10</span></span><br></pre></td></tr></table></figure><ul><li>é€‰ç”¨pythonç‰ˆæœ¬ï¼ˆåœ¨å…·ä½“çš„æŸä¸ªé¡¹ç›®ä¸­ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŒ‡å®šé€‰ç”¨çš„pythonç‰ˆæœ¬ï¼‰</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python pin ç‰ˆæœ¬å·</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªå‘½ä»¤ä¼šåœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `.python-version` æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</span></span><br><span class="line"></span><br><span class="line">uv python pin 3.10</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># Pinned `.python-version` to `3.10`</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> .python-version</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># 3.10</span></span><br></pre></td></tr></table></figure><h3 id="4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰"><a href="#4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰" class="headerlink" title="4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰"></a>4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰</h3><ul><li>æ–¹å¼1ï¼šåˆ›å»ºé¡¹ç›®æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ–¹å¼ï¼Œå…ˆåˆ›å»ºå¥½é¡¹ç›®ç›®å½•ï¼Œç„¶åè®¾ç½®pythonç‰ˆæœ¬å¹¶åˆå§‹åŒ–uvè™šæ‹Ÿç¯å¢ƒ</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python pin 3.10</span><br><span class="line">uv init <span class="comment"># åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œäº†uv initä¹‹åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºå‡ ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œgit initåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„gitä»“åº“æ¥</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~/data/code/python/test_code                                                                                                      </span><br><span class="line">â¯ uv python pin 3.13</span><br><span class="line">Pinned `.python-version` to `3.13`</span><br><span class="line"></span><br><span class="line">~/data/code/python/test_code                                                                                                      </span><br><span class="line">â¯ uv init           </span><br><span class="line">Initialized project `test-code`</span><br><span class="line"></span><br><span class="line">~/data/code/python/test_code main ?6                                                                                              </span><br><span class="line">â¯ <span class="built_in">ls</span></span><br><span class="line">README.md      main.py        pyproject.toml</span><br></pre></td></tr></table></figure><ul><li>æ–¹å¼2ï¼šå¦å¤–ä¸€ä¸ªæ–¹å¼æ˜¯åœ¨initä¹‹åæ·»åŠ ä¸€ä¸ªé¡¹ç›®åï¼Œä¼šè‡ªåŠ¨åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uv init é¡¹ç›®å</span><br></pre></td></tr></table></figure><h3 id="5ã€æ·»åŠ ä¾èµ–"><a href="#5ã€æ·»åŠ ä¾èµ–" class="headerlink" title="5ã€æ·»åŠ ä¾èµ–"></a>5ã€æ·»åŠ ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv add ä¾èµ–é¡¹</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯”å¦‚æ·»åŠ requestsåº“</span></span><br><span class="line">uv add requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥æŒ‡å®šå…·ä½“ç‰ˆæœ¬</span></span><br><span class="line">uv add requests==ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œäº†è¿™ä¸ªå‘½ä»¤åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º.venvè™šæ‹Ÿç¯å¢ƒç›®å½•ï¼ˆåœ¨vscodeé‡Œé¢å¯ä»¥é€‰æ‹©è¿™ä¸ªç›®å½•ä½œä¸ºè™šæ‹Ÿç¯å¢ƒï¼Œå¦åˆ™ä»£ç è§£æä¼šæœ‰é—®é¢˜ï¼‰ï¼Œå¹¶æ·»åŠ æˆ‘ä»¬è¦çš„ä¾èµ–é¡¹ï¼ŒåŒæ—¶ä¼šæ–°å¢ä¸€ä¸ªuv.lockæ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ä¾èµ–é¡¹ç‰ˆæœ¬ç›¸å…³çš„ä¿¡æ¯ã€‚pyproject.tomlæ–‡ä»¶ä¸­çš„dependencieså­—æ®µä¹Ÿä¼šåŒ…å«éœ€è¦çš„ä¾èµ–é¡¹ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~/data/code/python/test_code main ?6                                                                                              </span><br><span class="line">â¯ uv add requests</span><br><span class="line">Using CPython 3.13.1 interpreter at: /opt/homebrew/opt/python@3.13/bin/python3.13</span><br><span class="line">Creating virtual environment at: .venv</span><br><span class="line">Resolved 6 packages <span class="keyword">in</span> 13.85s</span><br><span class="line">Prepared 5 packages <span class="keyword">in</span> 5.55s</span><br><span class="line">Installed 5 packages <span class="keyword">in</span> 13ms</span><br><span class="line"> + certifi==2025.1.31</span><br><span class="line"> + charset-normalizer==3.4.1</span><br><span class="line"> + idna==3.10</span><br><span class="line"> + requests==2.32.3</span><br><span class="line"> + urllib3==2.4.0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è€Œä¸”ï¼Œä»è¿™ä¸ªè¾“å‡ºä¸­ä¹Ÿèƒ½çœ‹åˆ°ï¼Œå®ƒè‡ªåŠ¨ä½¿ç”¨äº†<code>.python-version</code>æŒ‡å®šçš„3.13ç‰ˆæœ¬çš„pythonï¼Œå’Œå½“å‰æˆ‘ä»¬å…¨å±€ç›®å½•ä¸‹çš„python3æŒ‡å‘ä»€ä¹ˆç‰ˆæœ¬æ²¡æœ‰å…³ç³»ï¼ˆæˆ‘çš„å…¨å±€python3æŒ‡å‘çš„æ˜¯3.10ç‰ˆæœ¬ï¼‰</p><h3 id="6ã€è¿è¡Œç¨‹åº"><a href="#6ã€è¿è¡Œç¨‹åº" class="headerlink" title="6ã€è¿è¡Œç¨‹åº"></a>6ã€è¿è¡Œç¨‹åº</h3><p>ä¾èµ–æ·»åŠ å¥½åï¼Œå°±å¯ä»¥ä½¿ç”¨uvæ¥è¿è¡Œpythonç¨‹åºäº†</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv run ç¨‹åºæ–‡ä»¶å [å‘½ä»¤è¡Œå‚æ•°]</span><br></pre></td></tr></table></figure><p>uvä¼šè‡ªåŠ¨æŒ‰ç…§æˆ‘ä»¬çš„é…ç½®æ¥è¿è¡Œç¨‹åºï¼Œæ— åºæˆ‘ä»¬æ‰‹åŠ¨ç»´æŠ¤ä¾èµ–é¡¹ï¼Œä¹Ÿä¸éœ€è¦æ‰‹åŠ¨å»sourceå„å¼å„æ ·çš„è™šæ‹Ÿç¯å¢ƒäº†ã€‚</p><h3 id="7ã€uvxå‘½ä»¤"><a href="#7ã€uvxå‘½ä»¤" class="headerlink" title="7ã€uvxå‘½ä»¤"></a>7ã€uvxå‘½ä»¤</h3><p>éšç€uvä¸‹è½½çš„è¿˜æœ‰ä¸€ä¸ªuvxå‘½ä»¤ï¼Œuvxå‘½ä»¤æœ¬è´¨ä¸Šæ˜¯uv tool runå‘½ä»¤çš„åˆ«å</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uvx python main.py</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">uv run main.py</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">uv tool run main.py</span><br></pre></td></tr></table></figure><p>å®é™…ä¾‹å­ï¼Œå¦‚ä¸‹è¿™ä¸¤ä¸ªå‘½ä»¤æ˜¯ç­‰ä»·çš„</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">â¯ uvx --directory ~/data/code/python/test_code python main.py</span><br><span class="line">Hello from test-code!</span><br><span class="line">    </span><br><span class="line">â¯ uv tool run --directory ~/data/code/python/test_code python main.py</span><br><span class="line">Hello from test-code!</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº"><a href="#8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº" class="headerlink" title="8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº"></a>8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº</h3><p>uvä¸‹è½½ç¬¬ä¸‰æ–¹åº“æœ¬è´¨ä¸Šä¹Ÿæ˜¯é€šè¿‡pypiæºä¸‹è½½çš„ï¼Œæ‰€ä»¥åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸­é»˜è®¤é“¾æ¥é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼Œå¯ä»¥åœ¨é¡¹ç›®ç›®å½•çš„<code>pyproject.toml</code>ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹æ¥ä½¿ç”¨æ¸…åæº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[[tool.uv.index]]</span><br><span class="line">url = <span class="string">&quot;https://pypi.tuna.tsinghua.edu.cn/simple&quot;</span></span><br><span class="line">default = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œuv addå‘½ä»¤çš„æ—¶å€™ä¹Ÿå¯ä»¥æŒ‡å®šé•œåƒæº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv add --default-index https://pypi.tuna.tsinghua.edu.cn/simple requests</span><br></pre></td></tr></table></figure><p>uvä¹Ÿæä¾›äº†å…¨å±€çš„é…ç½®é¡¹ï¼Œå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡<code>UV_DEFAULT_INDEX</code>é…ç½®é•œåƒæº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> UV_DEFAULT_INDEX=https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><p>å…¨å±€çš„é…ç½®é¡¹ä¼˜å…ˆçº§ä½äº<code>pyproject.toml</code>ä¸­é…ç½®çš„é•œåƒæºã€‚å¦‚æœ<code>pyproject.toml</code>é‡Œé¢é…ç½®äº†é•œåƒæºï¼Œåˆ™ä¼šä½¿ç”¨<code>pyproject.toml</code>çš„é…ç½®ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;pythonå®‰è£…æ–¹å¼é›†åˆ(ubuntu)&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="Python" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/Python/"/>
    
    
    <category term="pythonç®¡ç†å™¨" scheme="https://kanoc.gitee.io/tags/python%E7%AE%A1%E7%90%86%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu22å®‰è£…uvç®¡ç†python</title>
    <link href="https://kanoc.gitee.io/2025/05/21/ubuntu22%E5%AE%89%E8%A3%85uv%E7%AE%A1%E7%90%86python/"/>
    <id>https://kanoc.gitee.io/2025/05/21/ubuntu22%E5%AE%89%E8%A3%85uv%E7%AE%A1%E7%90%86python/</id>
    <published>2025-05-20T16:13:25.000Z</published>
    <updated>2025-06-10T01:07:15.388Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>ubuntu22å®‰è£…uvç®¡ç†å™¨</strong></font></p><span id="more"></span><p>æœ¬æ–‡å‚è€ƒè‡ªï¼š1ã€<a href="https://blog.csdn.net/muxuen/article/details/147544307">ã€Pythonã€‘ä½¿ç”¨uvç®¡ç†pythonè™šæ‹Ÿç¯å¢ƒ_uvç¯å¢ƒpython-CSDNåšå®¢</a></p><p>æœ¬æ–‡å‚è€ƒè‡ªï¼š2ã€<a href="https://blog.csdn.net/qq_41472205/article/details/145686414">uv ç®€æ˜“å®‰è£…ä¸æ›´æ¢å›½å†…é•œåƒæº_uv å›½å†…æº-CSDNåšå®¢</a></p><h3 id="1ã€å®‰è£…uvç®¡ç†å™¨"><a href="#1ã€å®‰è£…uvç®¡ç†å™¨" class="headerlink" title="1ã€å®‰è£…uvç®¡ç†å™¨"></a>1ã€å®‰è£…uvç®¡ç†å™¨</h3><ul><li>Mac || Linuxå®‰è£…ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -LsSf https://astral.sh/uv/install.sh | sh</span><br></pre></td></tr></table></figure><ul><li>Windowså®‰è£…ï¼š</li></ul><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1: åœ¨ Windows ä¸Šï¼šä½¿ç”¨ Astral.sh æä¾›çš„å®‰è£…è„šæœ¬</span></span><br><span class="line">powershell <span class="literal">-ExecutionPolicy</span> ByPass <span class="literal">-c</span> <span class="string">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2: åœ¨ Windows ä¸Šï¼šä½¿ç”¨ scoop å®‰è£… uv</span></span><br><span class="line">scoop install uv</span><br></pre></td></tr></table></figure><ul><li>pipå®‰è£…æ–¹å¼ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install uv</span><br></pre></td></tr></table></figure><ul><li>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">uv --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹uvç‰ˆæœ¬</span></span><br><span class="line">uv --version</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/05/21/iSowqNnKdsv9CbB.jpg" alt="img"></p><h3 id="2ã€å¸è½½uvï¼š"><a href="#2ã€å¸è½½uvï¼š" class="headerlink" title="2ã€å¸è½½uvï¼š"></a>2ã€å¸è½½uvï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv cache clean</span><br><span class="line"><span class="built_in">rm</span> -r <span class="string">&quot;<span class="subst">$(uv python dir)</span>&quot;</span></span><br><span class="line"><span class="built_in">rm</span> -r <span class="string">&quot;<span class="subst">$(uv tool dir)</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mac/linux</span></span><br><span class="line"><span class="built_in">rm</span> ~/.local/bin/uv ~/.local/bin/uvx</span><br><span class="line"><span class="comment"># windows</span></span><br><span class="line"><span class="built_in">rm</span> <span class="variable">$HOME</span>.<span class="built_in">local</span>\bin\uv.exe</span><br><span class="line"><span class="built_in">rm</span> <span class="variable">$HOME</span>.<span class="built_in">local</span>\bin\uvx.exe</span><br></pre></td></tr></table></figure><h3 id="3ã€pythonç®¡ç†ï¼š"><a href="#3ã€pythonç®¡ç†ï¼š" class="headerlink" title="3ã€pythonç®¡ç†ï¼š"></a>3ã€pythonç®¡ç†ï¼š</h3><ul><li>æŸ¥çœ‹pythonå¯ç”¨ç‰ˆæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python list</span><br></pre></td></tr></table></figure><ul><li>å®‰è£…python3.13</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ‡å‡†å®‰è£…æ–¹å¼</span></span><br><span class="line">uv python install 3.13</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–å®‰è£…Pythonçš„æ–¹å¼å®ç°ï¼Œæ¯”å¦‚PyPyå®ç°çš„python</span></span><br><span class="line">uv python install pypy@3.13</span><br></pre></td></tr></table></figure><ul><li>æŸ¥æ‰¾æŸä¸ªpythonç‰ˆæœ¬çš„è·¯å¾„</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python find 3.10</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># /Library/Frameworks/Python.framework/Versions/3.10/bin/python3.10</span></span><br></pre></td></tr></table></figure><ul><li>é€‰ç”¨pythonç‰ˆæœ¬ï¼ˆåœ¨å…·ä½“çš„æŸä¸ªé¡¹ç›®ä¸­ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŒ‡å®šé€‰ç”¨çš„pythonç‰ˆæœ¬ï¼‰</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python pin ç‰ˆæœ¬å·</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªå‘½ä»¤ä¼šåœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `.python-version` æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</span></span><br><span class="line"></span><br><span class="line">uv python pin 3.10</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># Pinned `.python-version` to `3.10`</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> .python-version</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># 3.10</span></span><br></pre></td></tr></table></figure><h3 id="4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰"><a href="#4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰" class="headerlink" title="4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰"></a>4ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¡¹ç›®ï¼‰</h3><ul><li>æ–¹å¼1ï¼šåˆ›å»ºé¡¹ç›®æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ–¹å¼ï¼Œå…ˆåˆ›å»ºå¥½é¡¹ç›®ç›®å½•ï¼Œç„¶åè®¾ç½®pythonç‰ˆæœ¬å¹¶åˆå§‹åŒ–uvè™šæ‹Ÿç¯å¢ƒ</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv python pin 3.10</span><br><span class="line">uv init <span class="comment"># åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œäº†uv initä¹‹åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºå‡ ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œgit initåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„gitä»“åº“æ¥</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~/data/code/python/test_code                                                                                                      </span><br><span class="line">â¯ uv python pin 3.13</span><br><span class="line">Pinned `.python-version` to `3.13`</span><br><span class="line"></span><br><span class="line">~/data/code/python/test_code                                                                                                      </span><br><span class="line">â¯ uv init           </span><br><span class="line">Initialized project `test-code`</span><br><span class="line"></span><br><span class="line">~/data/code/python/test_code main ?6                                                                                              </span><br><span class="line">â¯ <span class="built_in">ls</span></span><br><span class="line">README.md      main.py        pyproject.toml</span><br></pre></td></tr></table></figure><ul><li>æ–¹å¼2ï¼šå¦å¤–ä¸€ä¸ªæ–¹å¼æ˜¯åœ¨initä¹‹åæ·»åŠ ä¸€ä¸ªé¡¹ç›®åï¼Œä¼šè‡ªåŠ¨åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uv init é¡¹ç›®å</span><br></pre></td></tr></table></figure><h3 id="5ã€æ·»åŠ ä¾èµ–"><a href="#5ã€æ·»åŠ ä¾èµ–" class="headerlink" title="5ã€æ·»åŠ ä¾èµ–"></a>5ã€æ·»åŠ ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv add ä¾èµ–é¡¹</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯”å¦‚æ·»åŠ requestsåº“</span></span><br><span class="line">uv add requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥æŒ‡å®šå…·ä½“ç‰ˆæœ¬</span></span><br><span class="line">uv add requests==ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œäº†è¿™ä¸ªå‘½ä»¤åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»º.venvè™šæ‹Ÿç¯å¢ƒç›®å½•ï¼ˆåœ¨vscodeé‡Œé¢å¯ä»¥é€‰æ‹©è¿™ä¸ªç›®å½•ä½œä¸ºè™šæ‹Ÿç¯å¢ƒï¼Œå¦åˆ™ä»£ç è§£æä¼šæœ‰é—®é¢˜ï¼‰ï¼Œå¹¶æ·»åŠ æˆ‘ä»¬è¦çš„ä¾èµ–é¡¹ï¼ŒåŒæ—¶ä¼šæ–°å¢ä¸€ä¸ªuv.lockæ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ä¾èµ–é¡¹ç‰ˆæœ¬ç›¸å…³çš„ä¿¡æ¯ã€‚pyproject.tomlæ–‡ä»¶ä¸­çš„dependencieså­—æ®µä¹Ÿä¼šåŒ…å«éœ€è¦çš„ä¾èµ–é¡¹ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~/data/code/python/test_code main ?6                                                                                              </span><br><span class="line">â¯ uv add requests</span><br><span class="line">Using CPython 3.13.1 interpreter at: /opt/homebrew/opt/python@3.13/bin/python3.13</span><br><span class="line">Creating virtual environment at: .venv</span><br><span class="line">Resolved 6 packages <span class="keyword">in</span> 13.85s</span><br><span class="line">Prepared 5 packages <span class="keyword">in</span> 5.55s</span><br><span class="line">Installed 5 packages <span class="keyword">in</span> 13ms</span><br><span class="line"> + certifi==2025.1.31</span><br><span class="line"> + charset-normalizer==3.4.1</span><br><span class="line"> + idna==3.10</span><br><span class="line"> + requests==2.32.3</span><br><span class="line"> + urllib3==2.4.0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è€Œä¸”ï¼Œä»è¿™ä¸ªè¾“å‡ºä¸­ä¹Ÿèƒ½çœ‹åˆ°ï¼Œå®ƒè‡ªåŠ¨ä½¿ç”¨äº†<code>.python-version</code>æŒ‡å®šçš„3.13ç‰ˆæœ¬çš„pythonï¼Œå’Œå½“å‰æˆ‘ä»¬å…¨å±€ç›®å½•ä¸‹çš„python3æŒ‡å‘ä»€ä¹ˆç‰ˆæœ¬æ²¡æœ‰å…³ç³»ï¼ˆæˆ‘çš„å…¨å±€python3æŒ‡å‘çš„æ˜¯3.10ç‰ˆæœ¬ï¼‰</p><h3 id="6ã€è¿è¡Œç¨‹åº"><a href="#6ã€è¿è¡Œç¨‹åº" class="headerlink" title="6ã€è¿è¡Œç¨‹åº"></a>6ã€è¿è¡Œç¨‹åº</h3><p>ä¾èµ–æ·»åŠ å¥½åï¼Œå°±å¯ä»¥ä½¿ç”¨uvæ¥è¿è¡Œpythonç¨‹åºäº†</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv run ç¨‹åºæ–‡ä»¶å [å‘½ä»¤è¡Œå‚æ•°]</span><br></pre></td></tr></table></figure><p>uvä¼šè‡ªåŠ¨æŒ‰ç…§æˆ‘ä»¬çš„é…ç½®æ¥è¿è¡Œç¨‹åºï¼Œæ— åºæˆ‘ä»¬æ‰‹åŠ¨ç»´æŠ¤ä¾èµ–é¡¹ï¼Œä¹Ÿä¸éœ€è¦æ‰‹åŠ¨å»sourceå„å¼å„æ ·çš„è™šæ‹Ÿç¯å¢ƒäº†ã€‚</p><h3 id="7ã€uvxå‘½ä»¤"><a href="#7ã€uvxå‘½ä»¤" class="headerlink" title="7ã€uvxå‘½ä»¤"></a>7ã€uvxå‘½ä»¤</h3><p>éšç€uvä¸‹è½½çš„è¿˜æœ‰ä¸€ä¸ªuvxå‘½ä»¤ï¼Œuvxå‘½ä»¤æœ¬è´¨ä¸Šæ˜¯uv tool runå‘½ä»¤çš„åˆ«å</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uvx python main.py</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">uv run main.py</span><br><span class="line"><span class="comment"># ç­‰ä»·äº</span></span><br><span class="line">uv tool run main.py</span><br></pre></td></tr></table></figure><p>å®é™…ä¾‹å­ï¼Œå¦‚ä¸‹è¿™ä¸¤ä¸ªå‘½ä»¤æ˜¯ç­‰ä»·çš„</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">â¯ uvx --directory ~/data/code/python/test_code python main.py</span><br><span class="line">Hello from test-code!</span><br><span class="line">    </span><br><span class="line">â¯ uv tool run --directory ~/data/code/python/test_code python main.py</span><br><span class="line">Hello from test-code!</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº"><a href="#8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº" class="headerlink" title="8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº"></a>8ã€è®¾ç½®ä¸‹è½½åŒ…çš„é•œåƒæº</h3><p>uvä¸‹è½½ç¬¬ä¸‰æ–¹åº“æœ¬è´¨ä¸Šä¹Ÿæ˜¯é€šè¿‡pypiæºä¸‹è½½çš„ï¼Œæ‰€ä»¥åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸­é»˜è®¤é“¾æ¥é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼Œå¯ä»¥åœ¨é¡¹ç›®ç›®å½•çš„<code>pyproject.toml</code>ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹æ¥ä½¿ç”¨æ¸…åæº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[[tool.uv.index]]</span><br><span class="line">url = <span class="string">&quot;https://pypi.tuna.tsinghua.edu.cn/simple&quot;</span></span><br><span class="line">default = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œuv addå‘½ä»¤çš„æ—¶å€™ä¹Ÿå¯ä»¥æŒ‡å®šé•œåƒæº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uv add --default-index https://pypi.tuna.tsinghua.edu.cn/simple requests</span><br></pre></td></tr></table></figure><p>uvä¹Ÿæä¾›äº†å…¨å±€çš„é…ç½®é¡¹ï¼Œå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡<code>UV_DEFAULT_INDEX</code>é…ç½®é•œåƒæº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> UV_DEFAULT_INDEX=https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><p>å…¨å±€çš„é…ç½®é¡¹ä¼˜å…ˆçº§ä½äº<code>pyproject.toml</code>ä¸­é…ç½®çš„é•œåƒæºã€‚å¦‚æœ<code>pyproject.toml</code>é‡Œé¢é…ç½®äº†é•œåƒæºï¼Œåˆ™ä¼šä½¿ç”¨<code>pyproject.toml</code>çš„é…ç½®ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;ubuntu22å®‰è£…uvç®¡ç†å™¨&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="ubuntu" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/ubuntu/"/>
    
    
    <category term="pyenv" scheme="https://kanoc.gitee.io/tags/pyenv/"/>
    
  </entry>
  
  <entry>
    <title>DrissionPageè¯´æ˜æ–‡æ¡£</title>
    <link href="https://kanoc.gitee.io/2025/05/06/DrissionPage%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/"/>
    <id>https://kanoc.gitee.io/2025/05/06/DrissionPage%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/</id>
    <published>2025-05-05T18:50:20.000Z</published>
    <updated>2025-05-05T18:51:18.054Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>DrissionPageè¯´æ˜æ–‡æ¡£</strong></font></p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">browser.new_tab()    # åˆ›å»ºæ–°çš„æ ‡ç­¾é¡µ</span><br><span class="line">browser.tab_ids      # è·å–tabs çš„idå€¼</span><br><span class="line">p = browser.get_tab(&quot;338350AA707BE2F467619372FD14CF03&quot;)    # èµ‹äºˆp ä¸ºå½“å‰tabidçš„æ ‡ç­¾</span><br><span class="line">browser.new_tab(tab_id=&quot;E0D226A87D3&quot;)</span><br><span class="line">_ChromeClient.set.cookies.clear()   # è¯¥æ–¹æ³•ä¸èƒ½ç”¨äºæ ‡ç­¾é¡µ</span><br><span class="line">p.close()   # å…³é—­æ ‡ç­¾é¡µ</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;DrissionPageè¯´æ˜æ–‡æ¡£&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="DrissionPage" scheme="https://kanoc.gitee.io/categories/DrissionPage/"/>
    
    <category term="æ–‡æ¡£" scheme="https://kanoc.gitee.io/categories/DrissionPage/%E6%96%87%E6%A1%A3/"/>
    
    
    <category term="æµè§ˆå™¨" scheme="https://kanoc.gitee.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    <category term="è¯´æ˜" scheme="https://kanoc.gitee.io/tags/%E8%AF%B4%E6%98%8E/"/>
    
    <category term="æ–‡æ¡£" scheme="https://kanoc.gitee.io/tags/%E6%96%87%E6%A1%A3/"/>
    
  </entry>
  
  <entry>
    <title>windowså®‰è£…é…ç½®pyenv</title>
    <link href="https://kanoc.gitee.io/2025/05/03/windows%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEpyenv/"/>
    <id>https://kanoc.gitee.io/2025/05/03/windows%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEpyenv/</id>
    <published>2025-05-03T05:44:09.000Z</published>
    <updated>2025-06-10T01:09:30.152Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>windowså®‰è£…é…ç½®pyenv</strong></font></p><span id="more"></span><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£çš„å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Invoke-WebRequest -UseBasicParsing -Uri &quot;https://raw.githubusercontent.com/pyenv-win/pyenv-win/master/pyenv-win/install-pyenv-win.ps1&quot; -OutFile &quot;./install-pyenv-win.ps1&quot;; &amp;&quot;./install-pyenv-win.ps1&quot;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ‰§è¡Œè¯¥å‘½ä»¤å¯èƒ½ä¼šå‡ºç°é”™è¯¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š</p><ul><li>è¿›å…¥<a href="https://raw.githubusercontent.com/pyenv-win/pyenv-win/master/pyenv-win/install-pyenv-win.ps1">pyenv-winé…ç½®æ–‡ä»¶</a>çš„ä¸‹è½½åœ°å€ ï¼Œå°†è¯¥åä¸º<code>install-pyenv-win.ps1</code>çš„é…ç½®æ–‡ä»¶ä¸‹è½½è‡³ç”µè„‘æŸç›®å½•(å¦‚<code>D:\pyenv</code>)</li><li>å°†è„šæœ¬æ–‡ä»¶ä¸‹è½½å®Œæˆåï¼Œåœ¨ç»ˆç«¯(<code>PowerShell</code>) ä¸­ï¼Œä½¿ç”¨cdå‘½ä»¤åˆ‡æ¢åˆ°ä¿å­˜è¯¥è„šæœ¬æ–‡ä»¶çš„ç›®å½•ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ‰§è¡Œè„šæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./install-pyenv-win.ps1</span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œå®Œæˆåï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ç¡®è®¤æ˜¯å¦å®‰è£…æˆåŠŸï¼š</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyenv --version</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºä»¥ä¸‹ç”»é¢ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼š</p><p><img src="https://s2.loli.net/2025/05/03/kTM8bmwgpzqLl9Q.webp" alt="img"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;windowså®‰è£…é…ç½®pyenv&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="windows" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/windows/"/>
    
    
    <category term="docker" scheme="https://kanoc.gitee.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>NVMã€Pyenvå®‰è£…çš„ç¨‹åºï¼Œåœ¨å®å¡”é¢æ¿ä¸­æ— æ³•è¯†åˆ«è§£å†³æ–¹æ¡ˆ</title>
    <link href="https://kanoc.gitee.io/2025/05/02/NVM%E3%80%81Pyenv%E5%AE%89%E8%A3%85%E7%9A%84%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%9C%A8%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E4%B8%AD%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%AB%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>https://kanoc.gitee.io/2025/05/02/NVM%E3%80%81Pyenv%E5%AE%89%E8%A3%85%E7%9A%84%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%9C%A8%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E4%B8%AD%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%AB%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</id>
    <published>2025-05-02T15:28:06.000Z</published>
    <updated>2025-06-09T13:06:42.160Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>NVMã€Pyenvå®‰è£…çš„ç¨‹åºï¼Œåœ¨å®å¡”é¢æ¿ä¸­æ— æ³•è¯†åˆ«è§£å†³æ–¹æ¡ˆ</strong></font></p><span id="more"></span><p>å°† <code>nvm</code> å®‰è£…çš„ Node.js è½¯é“¾æ¥åˆ°ç³»ç»Ÿå…¨å±€è·¯å¾„ <code>/usr/bin</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ln -s ~/.nvm/versions/node/v18.14.2/bin/node /usr/bin/node</span><br><span class="line">sudo ln -s ~/.nvm/versions/node/v18.14.2/bin/npm /usr/bin/npm</span><br><span class="line">sudo ln -s ~/.nvm/versions/node/v18.14.2/bin/npx /usr/bin/npx</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">which node  # åº”è¾“å‡º /usr/bin/node</span><br></pre></td></tr></table></figure><h3 id="Pyenvçš„å¤„ç†ä¸NVMçš„å¤„ç†ç±»ä¼¼"><a href="#Pyenvçš„å¤„ç†ä¸NVMçš„å¤„ç†ç±»ä¼¼" class="headerlink" title="Pyenvçš„å¤„ç†ä¸NVMçš„å¤„ç†ç±»ä¼¼"></a>Pyenvçš„å¤„ç†ä¸NVMçš„å¤„ç†ç±»ä¼¼</h3>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;NVMã€Pyenvå®‰è£…çš„ç¨‹åºï¼Œåœ¨å®å¡”é¢æ¿ä¸­æ— æ³•è¯†åˆ«è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="Node" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/Node/"/>
    
    
    <category term="Pyenv" scheme="https://kanoc.gitee.io/tags/Pyenv/"/>
    
    <category term="NVM" scheme="https://kanoc.gitee.io/tags/NVM/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu-éƒ¨ç½²Pyenv-å¹¶ä½¿ç”¨ä¸åŒç¯å¢ƒ</title>
    <link href="https://kanoc.gitee.io/2025/04/28/ubuntu-%E9%83%A8%E7%BD%B2Pyenv-%E5%B9%B6%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%8E%AF%E5%A2%83/"/>
    <id>https://kanoc.gitee.io/2025/04/28/ubuntu-%E9%83%A8%E7%BD%B2Pyenv-%E5%B9%B6%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%8E%AF%E5%A2%83/</id>
    <published>2025-04-28T13:07:42.000Z</published>
    <updated>2025-06-10T01:05:50.370Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>ubuntu éƒ¨ç½²Pyenv å¹¶ä½¿ç”¨ä¸åŒç¯å¢ƒ</strong></font></p><span id="more"></span><h1 id="Pyenvç‰ˆæœ¬ä¼˜å…ˆçº§ï¼šShell-Local-Global"><a href="#Pyenvç‰ˆæœ¬ä¼˜å…ˆçº§ï¼šShell-Local-Global" class="headerlink" title="Pyenvç‰ˆæœ¬ä¼˜å…ˆçº§ï¼šShell &gt; Local &gt; Global"></a>Pyenvç‰ˆæœ¬ä¼˜å…ˆçº§ï¼šShell &gt; Local &gt; Global</h1><h3 id="Step-1-Update-Your-System"><a href="#Step-1-Update-Your-System" class="headerlink" title="Step 1: Update Your System"></a>Step 1: Update Your System</h3><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿ä½ çš„ Ubuntu ç³»ç»Ÿæ˜¯æœ€æ–°çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt upgrade</span><br></pre></td></tr></table></figure><h3 id="Step-2-Install-Prerequisites"><a href="#Step-2-Install-Prerequisites" class="headerlink" title="Step 2: Install Prerequisites"></a>Step 2: Install Prerequisites</h3><p>PyENV éœ€è¦ä¸€äº›ä¾èµ–é¡¹æ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…å®ƒä»¬ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install build-essential libbz2-dev libncurses5-dev libncursesw5-dev libffi-dev libreadline-dev libssl-dev libsqlite3-dev liblzma-dev zlib1g-dev wget curl llvm libncurses-dev xz-utils git</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Step-3-Install-PyENV"><a href="#Step-3-Install-PyENV" class="headerlink" title="Step 3: Install PyENV"></a>Step 3: Install PyENV</h3><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… PyENV</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl https://pyenv.run | bash</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/04/28/A6ftuGO3xJBviVI.png" alt="Installing PyENV on Ubuntu"></p><h3 id="Step-4-Update-Your-Shell-Configuration"><a href="#Step-4-Update-Your-Shell-Configuration" class="headerlink" title="Step 4: Update Your Shell Configuration"></a>Step 4: Update Your Shell Configuration</h3><p>å®‰è£… PyENV åï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ° shell é…ç½®ä¸­ï¼Œç¼–è¾‘ <strong>~&#x2F;.bashrc</strong> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œï¼Œä»¥ä¾¿æ¯æ¬¡æ‰“å¼€ç»ˆç«¯æ—¶å®ƒéƒ½ä¼šåŠ è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;<span class="variable">$HOME</span>/.pyenv/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv init --path)</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv init -)</span>&quot;</span></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv virtualenv-init -)</span>&quot;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ source å‘½ä»¤ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><h3 id="Step-4-Update-Your-Shell-Configuration-rootç”¨æˆ·å®‰è£…æ–¹å¼"><a href="#Step-4-Update-Your-Shell-Configuration-rootç”¨æˆ·å®‰è£…æ–¹å¼" class="headerlink" title="Step 4: Update Your Shell Configuration(rootç”¨æˆ·å®‰è£…æ–¹å¼)"></a>Step 4: Update Your Shell Configuration(rootç”¨æˆ·å®‰è£…æ–¹å¼)</h3><p>å®‰è£… PyENV åï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ° shell é…ç½®ä¸­ï¼Œç¼–è¾‘ <strong>~&#x2F;.bashrc</strong> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œï¼Œä»¥ä¾¿æ¯æ¬¡æ‰“å¼€ç»ˆç«¯æ—¶å®ƒéƒ½ä¼šåŠ è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘å…¨å±€ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆå½±å“æ‰€æœ‰ç”¨æˆ·ï¼‰</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PYENV_ROOT=&quot;/root/.pyenv&quot;&#x27;</span> &gt;&gt; /etc/profile.d/pyenv.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&#x27;</span> &gt;&gt; /etc/profile.d/pyenv.sh</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&#x27;if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\n eval &quot;$(pyenv init -)&quot;\nfi&#x27;</span> &gt;&gt; /etc/profile.d/pyenv.sh</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ source å‘½ä»¤ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile.d/pyenv.sh</span><br></pre></td></tr></table></figure><h3 id="Step-5-Install-Python-Versions"><a href="#Step-5-Install-Python-Versions" class="headerlink" title="Step 5: Install Python Versions"></a>Step 5: Install Python Versions</h3><p>ç°åœ¨æ‚¨å¯ä»¥å®‰è£…æ‰€éœ€çš„ä»»ä½•ç‰ˆæœ¬çš„ Pythonã€‚ä¾‹å¦‚ï¼Œè¦å®‰è£… Python 3.12</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv install 3.12</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ‚¨å¯èƒ½éœ€è¦å®‰è£… Python 2.7 ç­‰æ—§ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv install 2.7</span><br></pre></td></tr></table></figure><p>åˆ—å‡ºç³»ç»Ÿä¸Šå®‰è£…çš„æ‰€æœ‰ Python ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv install --list</span><br></pre></td></tr></table></figure><h3 id="Step-6-Set-a-Global-Python-Version"><a href="#Step-6-Set-a-Global-Python-Version" class="headerlink" title="Step 6: Set a Global Python Version"></a>Step 6: Set a Global Python Version</h3><p>æ‚¨å¯ä»¥è®¾ç½®é»˜è®¤ä½¿ç”¨çš„å…¨å±€ Python ç‰ˆæœ¬ï¼Œæ¯”å¦‚å°† Python 3.12 è®¾ç½®ä¸ºå…¨å±€ç‰ˆæœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv global 3.12</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰å…¨å±€ Python ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pyenv version</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/04/28/aWyE9BJAwHVMdmT.png" alt="PyENV Set Default Python Version"></p><h3 id="Step-7-è®¾ç½®å…¶ä»–ç‰ˆæœ¬"><a href="#Step-7-è®¾ç½®å…¶ä»–ç‰ˆæœ¬" class="headerlink" title="Step 7: è®¾ç½®å…¶ä»–ç‰ˆæœ¬"></a>Step 7: è®¾ç½®å…¶ä»–ç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥ä½ çš„é¡¹ç›®ç›®å½•</span></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®è¯¥ç›®å½•çš„ Python ç‰ˆæœ¬ä¸º 3.8</span></span><br><span class="line">pyenv local 3.8.12   # å‡è®¾å·²å®‰è£… 3.8.12</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™ä¼šç”Ÿæˆä¸€ä¸ªéšè—æ–‡ä»¶ `.python-version`ï¼Œè®°å½•ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># éªŒè¯</span></span></span><br><span class="line">pyenv shell 3.8.12   # ä¸´æ—¶è®¾ç½®</span><br><span class="line">python --version      # åº”æ˜¾ç¤º 3.8.12</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€€å‡ºä¸´æ—¶æ¨¡å¼ï¼ˆæ¢å¤å…¨å±€æˆ–æœ¬åœ°è®¾ç½®ï¼‰</span></span><br><span class="line">pyenv shell --unset</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¢å¤å…¨å±€ç‰ˆæœ¬</span></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line">rm .python-version   # åˆ é™¤ç‰ˆæœ¬æ ‡è®°æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="Step-8-ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰"><a href="#Step-8-ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰" class="headerlink" title="Step 8: ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰"></a>Step 8: ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ï¼ˆæ¨èï¼‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆåŸºäº Python 3.8ï¼‰</span></span><br><span class="line">pyenv virtualenv 3.8.12 my-legacy-env</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥é¡¹ç›®ç›®å½•å¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line">pyenv local my-legacy-env  # è‡ªåŠ¨æ¿€æ´»</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éªŒè¯</span></span><br><span class="line">python --version  # æ˜¾ç¤º 3.8.12ï¼Œä¸”ç¯å¢ƒç‹¬ç«‹</span><br><span class="line">pip list          # æ˜¾ç¤ºè¯¥ç¯å¢ƒç‹¬ç«‹çš„åŒ…</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€€å‡ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">pyenv deactivate</span><br></pre></td></tr></table></figure><h3 id="Step-9-éªŒè¯ç‰ˆæœ¬åˆ‡æ¢"><a href="#Step-9-éªŒè¯ç‰ˆæœ¬åˆ‡æ¢" class="headerlink" title="Step 9: éªŒè¯ç‰ˆæœ¬åˆ‡æ¢"></a>Step 9: éªŒè¯ç‰ˆæœ¬åˆ‡æ¢</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~  # é€€å‡ºé¡¹ç›®ç›®å½•</span><br><span class="line">python --version  # åº”æ˜¾ç¤ºå…¨å±€ç‰ˆæœ¬ 3.13.0</span><br><span class="line"></span><br><span class="line">cd ~/projects/legacy-project</span><br><span class="line">python --version  # åº”æ˜¾ç¤ºæœ¬åœ°ç‰ˆæœ¬ 3.8.12 æˆ–è™šæ‹Ÿç¯å¢ƒ</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;ubuntu éƒ¨ç½²Pyenv å¹¶ä½¿ç”¨ä¸åŒç¯å¢ƒ&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A5-å®‰è£…æ•™ç¨‹" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    
    <category term="ubuntu" scheme="https://kanoc.gitee.io/categories/A5-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/ubuntu/"/>
    
    
    <category term="pyenv" scheme="https://kanoc.gitee.io/tags/pyenv/"/>
    
  </entry>
  
  <entry>
    <title>ESXi-8.0-VMFSLæ— æ³•ä½¿ç”¨å­˜å‚¨çš„é—®é¢˜</title>
    <link href="https://kanoc.gitee.io/2025/03/19/ESXi-8-0-VMFSL%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://kanoc.gitee.io/2025/03/19/ESXi-8-0-VMFSL%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E7%9A%84%E9%97%AE%E9%A2%98/</id>
    <published>2025-03-19T13:40:32.000Z</published>
    <updated>2025-06-09T08:56:03.403Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>ESXi-8.0-VMFSLæ— æ³•ä½¿ç”¨å­˜å‚¨çš„é—®é¢˜</strong></font></p><span id="more"></span><p>ä»Šå¤©é€™ä¸€ç¯‡ç®—æ˜¯ç•ªå¤–ç¯‡ï¼Œè—‰ç”±<code>VMFSL</code>ä¾†èªªæ˜<code>Shift+O</code>èƒ½åšä»€éº¼è¨­å®šã€‚<br>æˆ‘æƒ³èªªé€™å€‹å•é¡Œåœ¨<code>ESXi 7.0</code>ç‰ˆæœ¬ä¹‹å¾Œéƒ½æœƒé‡åˆ°ï¼Œä¾†åˆ†äº«ä¸€ä¸‹æˆ‘å¦‚ä½•è§£æ±ºé€™å€‹å•é¡Œã€‚<br>é¦–å…ˆæä¸€ä¸‹ç‚ºä»€éº¼è¦æ<code>VMFSL</code>ï¼Œå› ç‚ºåœ¨å®‰è£å®Œ<code>ESXi</code>ç³»çµ±ä¹‹å¾Œï¼Œå‰©ä¸‹çš„ç¡¬ç¢Ÿç©ºé–“æœƒè¢«åšæˆä¸€å€‹å„²å­˜ç©ºé–“ ( <code>Datastore</code> )ï¼Œä½ å¯ä»¥æƒ³åƒé€™æ˜¯ä¸€å€‹è³‡æºæ± ï¼Œåœ¨æ²’æœ‰å¤–æ¥ä»»ä½•ç¶²è·¯å„²å­˜è£ç½®(<code>NAS</code>)ï¼Œè™›æ“¬æ©Ÿæ‰€éœ€çš„è™›æ“¬ç¡¬ç¢Ÿç©ºé–“éƒ½éœ€è¦å¾é€™å€‹<code>Datastore</code>åˆ†äº«ã€‚æ‰€ä»¥<code>Datastore</code>çš„ç©ºé–“å¤§å°å°±å¾ˆé‡è¦äº†ã€‚å®ƒé—œä¿‚åˆ°ä½ èƒ½é–‹å¤šå°‘è™›æ“¬æ©ŸåŠå¤šå¤§ç¡¬ç¢Ÿè¦æ ¼çš„è™›æ“¬æ©Ÿã€‚<br>è¬›äº†é‚£éº¼å¤šï¼Œå»é‚„æ˜¯æ²’æœ‰æåˆ°<code>VMFSL</code>ï¼Œä»€éº¼æ˜¯<code>VMFSL</code>?ï¼Œåœ¨<code>ESXi 7.0</code>ç‰ˆä¹‹å¾Œ<code>VMFSL</code>æ˜¯ç‚ºäº†<code>vSAN</code>ç‰¹åˆ¥ç•™ä¸‹çš„ç©ºé–“ç”¨æ–¼æå‡<code>vSAN</code>çš„è¡¨ç¾ï¼Œé‚£ä»€éº¼æ˜¯<code>vSAN</code>å¾Œé¢æœƒè§£é‡‹ã€‚ç¸½ä¹‹å› ç‚ºé€™å€‹ç‚ºäº†<code>vSAN</code>è€Œç‰¹åˆ¥ç•™ä¸‹çš„ç©ºé–“ï¼Œæœƒå½±éŸ¿åˆ°æˆ‘å€‘å‰©ä¸‹çš„å„²å­˜ç©ºé–“ã€‚ä¸å›‰å—¦ä¸Šåœ–è§£é‡‹<br>åœ–ä¸€:<br><img src="https://s2.loli.net/2025/03/19/HlN9E7kPD2QVgo8.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414dYC2eFodK4.png"></p><p>åœ–äºŒ:<br><img src="https://s2.loli.net/2025/03/19/nufALHI1z28obRT.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414LX8uKPckUb.png"><br>ä¸çŸ¥é“ä½ æœ‰æ²’æœ‰æ³¨æ„åˆ°æˆ‘åœ¨å®‰è£<code>ESXi</code>çš„æ™‚å€™æˆ‘æ‰€é¸æ“‡å®‰è£ä½œæ¥­ç³»çµ±çš„ç¡¬ç¢Ÿå¤§å°æ˜¯<code>142G</code>ã€‚è€Œåœ–äºŒå°±æ˜¯å®‰è£å®Œçš„çµæœã€‚ä½ å¯ä»¥çœ‹åˆ°<code>VMFSL</code>çš„é è¨­å¤§å°æ˜¯<code>120G</code><br>ã€‚è€Œ<code>Datastore</code>çš„ç©ºé–“å°±æ˜¯åœ–ä¸­é‚£å¯æ†çš„<code>VMFS 14G</code>çš„é‚£å€‹ç©ºé–“ã€‚<br><img src="https://s2.loli.net/2025/03/19/joqm2kUnuTf5ChK.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414Bkx3RazIk0.png"><br>é‚£æˆ‘æ²’æœ‰è¦ç©<code>vSAN</code>ï¼Œ<code>VMFSL</code>å¯ä¸å¯ä»¥ç¸®å°?ç•¶ç„¶å¯ä»¥!æ¨™é¡Œçš„<code>Shift+O</code>å¯ä¸æ˜¯å»¢è©±<br>åŸºæœ¬ä¸Šåœ¨å®‰è£<code>ESXi</code>ä¸Šå°±è¦èª¿æ•´äº†å“¦ï¼Œæ‰€ä»¥ä½ å·²ç¶“å®‰è£å¥½äº†å°±é‡çŒä¸€æ¬¡å§!<br><img src="https://s2.loli.net/2025/03/19/jdNGlEvPz8CiJWQ.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414aVlkRoDXOz.png"><br>è¨˜å¾—åœ¨é€™å€‹ç•«é¢è¶•å¿«æŒ‰<code>Shift+O</code>ï¼Œä¸ç„¶ç³»çµ±å°±æœƒè‡ªå‹•é€²å®‰è£ç•«é¢äº†å“¦<br><img src="https://s2.loli.net/2025/03/19/cCzjDOx15BfH69N.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414qcLPr1TnUD.png"><br>è¼¸å…¥å¦‚åœ–ä¸­çš„æŒ‡ä»¤<br><strong><code>cdromBoot runweasel autoPartitionOSDataSize=8192</code></strong><br>æ¥è‘—æŒ‰ä¸‹<code>Enter</code>æ¥è‘—å®‰è£çš„æµç¨‹ï¼Œä¿®æ”¹å®Œå®‰è£çš„çµæœå¦‚ä¸‹<br><img src="https://s2.loli.net/2025/03/19/5BU6wzWMIbiOdaL.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414QhK9a5nMZg.png"><br><code>VMFSL</code>å°±åªå‰©æˆ‘å€‘æ‰€è¨­å®šçš„<code>8192(8G)</code>ï¼Œè€Œå‰©é¤˜çš„ç©ºé–“å°±æ˜¯<code>Datastore(VMFS)</code>ã€‚<br>è‡³æ–¼å¯ä¸å¯ä»¥å®Œå…¨ä¸è¦é€™å€‹<code>VMFSL</code>ï¼Œåˆæˆ–è€…å¤§å°è¦å¤šå°‘ï¼Œé€™ä¸€é»æˆ‘ä¸æ˜¯å¾ˆèƒ½ç¢ºå®šã€‚å¸Œæœ›èƒ½æœ‰é«˜æ‰‹è£œå……!!<br>å†è£œå……ä¸€é»ï¼Œåœ¨ä¸ç‰¹åˆ¥è¨­å®š<code>VMFSL</code>å¤§å°çš„æƒ…æ³ä¸‹ï¼Œè€Œä½ çš„ç©ºé–“åˆå°æ–¼<code>120G</code>çš„æƒ…æ³ä¸‹<br><img src="https://s2.loli.net/2025/03/19/hEqoJgkeHxuFB9m.png" alt="https:&#x2F;&#x2F;ithelp.ithome.com.tw&#x2F;upload&#x2F;images&#x2F;20220916&#x2F;20152414k54lumvXWp.png"><br>ä½ æœƒç™¼ç¾<code>VMFSL</code>æŠŠå‰©ä¸‹çš„æ‰€æœ‰ç©ºé–“ä½¿ç”¨å®Œäº†ã€‚<br>å‰é¢æœ‰æåˆ°å®‰è£å®Œç³»çµ±åŠé è¨­<code>VMFSL</code>çš„ç©ºé–“ï¼Œå‰©ä¸‹çš„ç©ºé–“æœƒè‡ªå‹•åšæˆ<code>Datastore</code><br>åœ¨å¤§éƒ¨åˆ†çš„æƒ…æ³ä¸‹æ˜¯é€™æ¨£æ²’éŒ¯ï¼Œä¸éå¦‚æœä½ å°‡ç³»çµ±å®‰è£åœ¨<code>USB</code>å…§ï¼Œå°±ä¸æ˜¯å¦‚æ­¤äº†ï¼Œå› ç‚º<code>VMware</code>é è¨­ä¸å…è¨±ä½¿ç”¨<code>USB</code>ç•¶<code>Datastore</code>ã€‚æ‰€ä»¥ä¸‹ä¸€ç¯‡åˆæ˜¯ç•ªå¤–ç¯‡<br>æˆ‘å°‡æ•™ä½ å¦‚ä½•å°‡<code>USB</code>è¨­å®šæˆ<code>Datastore</code>ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;ESXi-8.0-VMFSLæ— æ³•ä½¿ç”¨å­˜å‚¨çš„é—®é¢˜&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="_A9-é”™è¯¯è§£å†³" scheme="https://kanoc.gitee.io/categories/A9-%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3/"/>
    
    <category term="esxi" scheme="https://kanoc.gitee.io/categories/A9-%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3/esxi/"/>
    
    
    <category term="å·¥å…·" scheme="https://kanoc.gitee.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://kanoc.gitee.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Docker-Volume-æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ</title>
    <link href="https://kanoc.gitee.io/2025/03/14/Docker-Volume-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%B9%E6%A1%88/"/>
    <id>https://kanoc.gitee.io/2025/03/14/Docker-Volume-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%B9%E6%A1%88/</id>
    <published>2025-03-14T07:19:50.000Z</published>
    <updated>2025-06-09T08:45:51.994Z</updated>
    
    <content type="html"><![CDATA[<p><font color=#00b2c2 size=5 face=å®‹ä½“><strong>Docker Volume æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆï¼š</strong></font></p><span id="more"></span><h3 id="ä½¿ç”¨-Docker-Volume-ä»£æ›¿ç›´æ¥æŒ‚è½½"><a href="#ä½¿ç”¨-Docker-Volume-ä»£æ›¿ç›´æ¥æŒ‚è½½" class="headerlink" title="ä½¿ç”¨ Docker Volume ä»£æ›¿ç›´æ¥æŒ‚è½½"></a>ä½¿ç”¨ Docker Volume ä»£æ›¿ç›´æ¥æŒ‚è½½</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º volume</span></span><br><span class="line">docker volume create mongo_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å·</span></span><br><span class="line">docker volume <span class="built_in">rm</span> mongo_data</span><br><span class="line"><span class="comment"># è¿è¡Œå®¹å™¨</span></span><br><span class="line">docker run -d --restart=always -p 27017:27017 --name mymongo -v volume:/data/db -e MONGO_LOG_MAX_SIZE=5242880 mongo:latest --wiredTigerCacheSizeGB 1 --auth</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹-Volume-ç‰©ç†è·¯å¾„ï¼ˆMacOSï¼‰"><a href="#æŸ¥çœ‹-Volume-ç‰©ç†è·¯å¾„ï¼ˆMacOSï¼‰" class="headerlink" title="æŸ¥çœ‹ Volume ç‰©ç†è·¯å¾„ï¼ˆMacOSï¼‰"></a>æŸ¥çœ‹ Volume ç‰©ç†è·¯å¾„ï¼ˆMacOSï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker volume inspect mongo_data</span><br></pre></td></tr></table></figure><h4 id="è¾“å‡ºç¤ºä¾‹ï¼š"><a href="#è¾“å‡ºç¤ºä¾‹ï¼š" class="headerlink" title="è¾“å‡ºç¤ºä¾‹ï¼š"></a>è¾“å‡ºç¤ºä¾‹ï¼š</h4><p>å®é™…æ•°æ®å­˜å‚¨åœ¨ Docker è™šæ‹Ÿæœºä¸­ï¼Œé¿å…ç›´æ¥æ“ä½œå®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿã€‚</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;<span class="number">2025</span>-<span class="number">03</span>-<span class="number">14</span>T05:XX:XXZ&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/mongo_data/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;mongo_data&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="è¿›å…¥mongoå®¹å™¨"><a href="#è¿›å…¥mongoå®¹å™¨" class="headerlink" title="è¿›å…¥mongoå®¹å™¨"></a>è¿›å…¥<code>mongo</code>å®¹å™¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mymongo /bin/bash</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/03/14/DZOC8ImKc2T59G3.png" alt="image"></p><p>æ³¨æ„ï¼šè¿™é‡Œçš„mymongoæ˜¯å®¹å™¨çš„åå­—ï¼Œä¸æ˜¯é•œåƒçš„åå­—ã€‚ï¼ˆå¿˜è®°å®¹å™¨åå­—ï¼Œå¯ä½¿ç”¨docker ps -a æŸ¥çœ‹å®¹å™¨åï¼‰<br><img src="https://s2.loli.net/2025/03/14/V7NiL5AWElx16va.png" alt="image"><br>2.3.2.è¿›å…¥<code>mongosh</code>ä¸­</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥mongo shell</span></span><br><span class="line">mongosh</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<code>mongosh 6.0</code>ç‰ˆæœ¬ä¹‹åä½¿ç”¨ï¼Œ<code>mongo 6.0</code>ç‰ˆæœ¬ä¹‹å‰ä½¿ç”¨ï¼Œåšä¸»å°±æ˜¯åœ¨è¿™é‡Œå‡ºé—®é¢˜çš„ï¼Œåšä¸»å®‰è£…æœ€æ–°<code>mongodb</code>ç‰ˆæœ¬ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ˜¯ <code>mongo</code> æ‰€ä»¥ä¸€ç›´å‡ºç°é—®é¢˜ï¼š<code>bash: mongo: command not found</code><br><img src="https://s2.loli.net/2025/03/14/9VQ3fFU5I4BJXe8.png" alt="image"></p><p><img src="https://s2.loli.net/2025/03/14/FPByZHwLNp7dRUv.png" alt="image"><br>2.3.3.è¿›å…¥<code>admin</code>æ•°æ®åº“</p><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> admin</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/03/14/McbuCipRfOx1e3o.png" alt="image"><br>2.3.4 åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œ<code>mongodb</code>é»˜è®¤æ²¡æœ‰ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.è¿™é‡Œåˆ›å»ºç”¨æˆ·åä¸ºrootï¼Œå¯†ç ä¸ºmongo2023ï¼Œè§’è‰²ï¼ˆè¯¥ç”¨æˆ·çš„æƒé™ï¼‰ä¸ºrootï¼Œæ•°æ®åº“ä¸ºadminï¼ˆä½ ä»¬æŒ‰ç…§ä½ ä»¬è‡ªå·±çš„è®¾ç½®ï¼‰</span></span><br><span class="line"><span class="comment"># ç”¨æˆ·åï¼šrootï¼Œå¯†ç ï¼šmongo2023ï¼Œè§’è‰²ï¼šrootï¼Œæ•°æ®åº“ï¼šadmin</span></span><br><span class="line"></span><br><span class="line">db.createUser(&#123;user:<span class="string">&#x27;root&#x27;</span>,<span class="built_in">pwd</span>:<span class="string">&#x27;mongo2023&#x27;</span>,roles:[&#123;role:<span class="string">&#x27;root&#x27;</span>,db:<span class="string">&#x27;admin&#x27;</span>&#125;]&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.è®¤è¯ç™»å½•db.auth(&#x27;ç”¨æˆ·å&#x27;,&#x27;å¯†ç &#x27;)ï¼Œæ‰“å°1åˆ™ä»£è¡¨è®¤è¯é€šè¿‡</span></span><br><span class="line">db.auth(<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;mongo2023&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/03/14/KWStwbdhveoZOYU.png" alt="image"><br>åˆ°è¿™é‡Œå°±å®Œæˆäº†åˆ›å»ºç”¨æˆ·å’Œè®¾ç½®å¯†ç ï¼Œå¦‚æœè¦é€€å‡º Ctrl+D æˆ–è€… exit é€€å‡ºmongodb</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=#00b2c2 size=5 face=å®‹ä½“&gt;&lt;strong&gt;Docker Volume æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆï¼š&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Docker" scheme="https://kanoc.gitee.io/categories/Docker/"/>
    
    <category term="æŒä¹…åŒ–" scheme="https://kanoc.gitee.io/categories/Docker/%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://kanoc.gitee.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="æŒä¹…åŒ–" scheme="https://kanoc.gitee.io/tags/%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    
  </entry>
  
</feed>
